<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RSA | SpiderAPI - 虫术 - 爬虫逆向常用 API</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="https://static.wukongsec.com/spiderdoc/images/favicon.ico">
    <script src="//sdk.51.la/js-sdk-pro.min.js" type="text/javascript" id="LA_COLLECT" charset="UTF-8"></script>
    <script src="https://lib.baomitu.com/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
    <script src="/js/spiderapi.js" type="text/javascript"></script>
    <script src="https://static.geetest.com/static/js/geetest.0.0.0.js" type="text/javascript"></script>
    <meta name="description" content="SpiderAPI - 虫术 - 汇总各种爬虫逆向常用 API，涉及各种网络请求库，自动化框架，爬虫框架，HOOK 脚本，ADB 命令等。">
    <meta name="keywords" content="spiderapi,jsvmp,frida,spider,api,hook,adb">
    <meta name="theme-color" content="#11a8cd">
    <meta name="baidu-site-verification" content="codeva-L7Nb1StNAA">
    
    <link rel="preload" href="/assets/css/0.styles.aae0c261.css" as="style"><link rel="preload" href="/assets/js/app.d9cfca56.js" as="script"><link rel="preload" href="/assets/js/2.b726511c.js" as="script"><link rel="preload" href="/assets/js/3.28e29ac1.js" as="script"><link rel="preload" href="/assets/js/80.0f45fe78.js" as="script"><link rel="preload" href="/assets/js/15.1edde6f8.js" as="script"><link rel="prefetch" href="/assets/js/10.c79eaffd.js"><link rel="prefetch" href="/assets/js/100.d614e045.js"><link rel="prefetch" href="/assets/js/101.67471d21.js"><link rel="prefetch" href="/assets/js/102.8b996e8c.js"><link rel="prefetch" href="/assets/js/103.9ef0f466.js"><link rel="prefetch" href="/assets/js/104.f05111cb.js"><link rel="prefetch" href="/assets/js/105.9fe5b447.js"><link rel="prefetch" href="/assets/js/106.23659d37.js"><link rel="prefetch" href="/assets/js/107.58dd703b.js"><link rel="prefetch" href="/assets/js/108.33fad4a3.js"><link rel="prefetch" href="/assets/js/109.3cff1e1e.js"><link rel="prefetch" href="/assets/js/11.a42be934.js"><link rel="prefetch" href="/assets/js/110.dabf0d13.js"><link rel="prefetch" href="/assets/js/111.a881ad38.js"><link rel="prefetch" href="/assets/js/112.be0c6487.js"><link rel="prefetch" href="/assets/js/113.34175445.js"><link rel="prefetch" href="/assets/js/114.47d74118.js"><link rel="prefetch" href="/assets/js/115.f14f06d9.js"><link rel="prefetch" href="/assets/js/116.2b83ee05.js"><link rel="prefetch" href="/assets/js/117.9de050a6.js"><link rel="prefetch" href="/assets/js/118.0e3d851c.js"><link rel="prefetch" href="/assets/js/119.a6d77b60.js"><link rel="prefetch" href="/assets/js/12.5767ef8f.js"><link rel="prefetch" href="/assets/js/120.b0a105ef.js"><link rel="prefetch" href="/assets/js/121.5c41d6c4.js"><link rel="prefetch" href="/assets/js/122.743a0a9e.js"><link rel="prefetch" href="/assets/js/123.bf9a5094.js"><link rel="prefetch" href="/assets/js/124.f73054b3.js"><link rel="prefetch" href="/assets/js/125.37f7042f.js"><link rel="prefetch" href="/assets/js/126.2ef6efec.js"><link rel="prefetch" href="/assets/js/127.59264f01.js"><link rel="prefetch" href="/assets/js/128.bb640dcf.js"><link rel="prefetch" href="/assets/js/129.3d84a0c5.js"><link rel="prefetch" href="/assets/js/13.d5890d2c.js"><link rel="prefetch" href="/assets/js/130.b9e34663.js"><link rel="prefetch" href="/assets/js/131.9c6bbda7.js"><link rel="prefetch" href="/assets/js/132.54d6b5ac.js"><link rel="prefetch" href="/assets/js/133.8faf85e2.js"><link rel="prefetch" href="/assets/js/134.eee80c07.js"><link rel="prefetch" href="/assets/js/135.a565cb1f.js"><link rel="prefetch" href="/assets/js/136.b9fe925b.js"><link rel="prefetch" href="/assets/js/137.b93ce376.js"><link rel="prefetch" href="/assets/js/138.c41b0a0c.js"><link rel="prefetch" href="/assets/js/139.99f5816d.js"><link rel="prefetch" href="/assets/js/14.87406737.js"><link rel="prefetch" href="/assets/js/140.aef8a0ca.js"><link rel="prefetch" href="/assets/js/141.d916cd82.js"><link rel="prefetch" href="/assets/js/16.523a18e6.js"><link rel="prefetch" href="/assets/js/17.8462c83b.js"><link rel="prefetch" href="/assets/js/18.6f048ffb.js"><link rel="prefetch" href="/assets/js/19.1e3c0999.js"><link rel="prefetch" href="/assets/js/20.61121f78.js"><link rel="prefetch" href="/assets/js/21.caec11d1.js"><link rel="prefetch" href="/assets/js/22.7e2b3c3c.js"><link rel="prefetch" href="/assets/js/23.a6ddc679.js"><link rel="prefetch" href="/assets/js/24.ec6819e7.js"><link rel="prefetch" href="/assets/js/25.cd11caea.js"><link rel="prefetch" href="/assets/js/26.f40c39f9.js"><link rel="prefetch" href="/assets/js/27.1dd169bb.js"><link rel="prefetch" href="/assets/js/28.e31bcdf6.js"><link rel="prefetch" href="/assets/js/29.4336a700.js"><link rel="prefetch" href="/assets/js/30.36998f83.js"><link rel="prefetch" href="/assets/js/31.bb91dd06.js"><link rel="prefetch" href="/assets/js/32.6641cb47.js"><link rel="prefetch" href="/assets/js/33.0d0a21f0.js"><link rel="prefetch" href="/assets/js/34.a3822537.js"><link rel="prefetch" href="/assets/js/35.71cca2ad.js"><link rel="prefetch" href="/assets/js/36.7182af90.js"><link rel="prefetch" href="/assets/js/37.034fde45.js"><link rel="prefetch" href="/assets/js/38.86a94edf.js"><link rel="prefetch" href="/assets/js/39.f6847182.js"><link rel="prefetch" href="/assets/js/4.b6deef6d.js"><link rel="prefetch" href="/assets/js/40.c71fce60.js"><link rel="prefetch" href="/assets/js/41.f92d8f44.js"><link rel="prefetch" href="/assets/js/42.5d3d9e7c.js"><link rel="prefetch" href="/assets/js/43.524e4303.js"><link rel="prefetch" href="/assets/js/44.91488ec6.js"><link rel="prefetch" href="/assets/js/45.c982b677.js"><link rel="prefetch" href="/assets/js/46.a0cf87dc.js"><link rel="prefetch" href="/assets/js/47.34cf90d5.js"><link rel="prefetch" href="/assets/js/48.90e32172.js"><link rel="prefetch" href="/assets/js/49.6a0529f9.js"><link rel="prefetch" href="/assets/js/5.afdb9407.js"><link rel="prefetch" href="/assets/js/50.6779761f.js"><link rel="prefetch" href="/assets/js/51.33f8f720.js"><link rel="prefetch" href="/assets/js/52.92707257.js"><link rel="prefetch" href="/assets/js/53.750f6155.js"><link rel="prefetch" href="/assets/js/54.6b6dcede.js"><link rel="prefetch" href="/assets/js/55.418560a2.js"><link rel="prefetch" href="/assets/js/56.899f178e.js"><link rel="prefetch" href="/assets/js/57.2ffe0a8c.js"><link rel="prefetch" href="/assets/js/58.7cc155b8.js"><link rel="prefetch" href="/assets/js/59.2c4cfa70.js"><link rel="prefetch" href="/assets/js/6.012776eb.js"><link rel="prefetch" href="/assets/js/60.372aa1d5.js"><link rel="prefetch" href="/assets/js/61.829671fc.js"><link rel="prefetch" href="/assets/js/62.81ce3ea9.js"><link rel="prefetch" href="/assets/js/63.3b779776.js"><link rel="prefetch" href="/assets/js/64.d370e9f1.js"><link rel="prefetch" href="/assets/js/65.3eff9cca.js"><link rel="prefetch" href="/assets/js/66.796002ce.js"><link rel="prefetch" href="/assets/js/67.4af2bce2.js"><link rel="prefetch" href="/assets/js/68.4fefe1b3.js"><link rel="prefetch" href="/assets/js/69.b0f04bad.js"><link rel="prefetch" href="/assets/js/7.6720de6c.js"><link rel="prefetch" href="/assets/js/70.dbeb2dd5.js"><link rel="prefetch" href="/assets/js/71.7523bc95.js"><link rel="prefetch" href="/assets/js/72.b784b6cc.js"><link rel="prefetch" href="/assets/js/73.9b0010b2.js"><link rel="prefetch" href="/assets/js/74.04baa894.js"><link rel="prefetch" href="/assets/js/75.8775d0c5.js"><link rel="prefetch" href="/assets/js/76.8ef532a8.js"><link rel="prefetch" href="/assets/js/77.a7876a30.js"><link rel="prefetch" href="/assets/js/78.ea831db6.js"><link rel="prefetch" href="/assets/js/79.2013280f.js"><link rel="prefetch" href="/assets/js/8.712d0a43.js"><link rel="prefetch" href="/assets/js/81.99f67d9f.js"><link rel="prefetch" href="/assets/js/82.ab8bb2e4.js"><link rel="prefetch" href="/assets/js/83.ffd99010.js"><link rel="prefetch" href="/assets/js/84.be885e66.js"><link rel="prefetch" href="/assets/js/85.44c86c6f.js"><link rel="prefetch" href="/assets/js/86.9332cd6f.js"><link rel="prefetch" href="/assets/js/87.3cc7d4ea.js"><link rel="prefetch" href="/assets/js/88.70eebb05.js"><link rel="prefetch" href="/assets/js/89.aff58ce7.js"><link rel="prefetch" href="/assets/js/9.b9506cc5.js"><link rel="prefetch" href="/assets/js/90.420211cc.js"><link rel="prefetch" href="/assets/js/91.96e9fd6c.js"><link rel="prefetch" href="/assets/js/92.b40d6f40.js"><link rel="prefetch" href="/assets/js/93.f0a93a99.js"><link rel="prefetch" href="/assets/js/94.0448b4c4.js"><link rel="prefetch" href="/assets/js/95.57359863.js"><link rel="prefetch" href="/assets/js/96.0898d166.js"><link rel="prefetch" href="/assets/js/97.b40c36d1.js"><link rel="prefetch" href="/assets/js/98.f3fd22b3.js"><link rel="prefetch" href="/assets/js/99.c7d5212f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.aae0c261.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://static.wukongsec.com/spiderdoc/images/logo.png" alt="虫术" class="logo"> <span class="site-name can-hide">
      虫术
      </span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/toc/" class="nav-link">目录</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="验证码" class="dropdown-title"><a href="/captcha/" class="link-title">验证码</a> <span class="title" style="display:none;">验证码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>国内验证码</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/captcha/dingxiang/" class="nav-link">顶象 DING XIANG</a></li><li class="dropdown-subitem"><a href="/captcha/shumei/" class="nav-link">数美 NEXTDATA</a></li><li class="dropdown-subitem"><a href="/captcha/yidun/" class="nav-link">易盾 NETEASE YIDUN</a></li><li class="dropdown-subitem"><a href="/captcha/geetest-v2/" class="nav-link">极验 GEETEST</a></li><li class="dropdown-subitem"><a href="/captcha/aliyun-v1/" class="nav-link">阿里云云盾验证码</a></li><li class="dropdown-subitem"><a href="/captcha/tencent/" class="nav-link">腾讯天御 T-Sec</a></li><li class="dropdown-subitem"><a href="/captcha/redcaptcha/" class="nav-link">小红书 redCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/xiaodun/" class="nav-link">小盾 XIAODUN</a></li><li class="dropdown-subitem"><a href="/captcha/yunpian/" class="nav-link">云片 YUNPIAN</a></li><li class="dropdown-subitem"><a href="/captcha/360/" class="nav-link">三六零天御</a></li><li class="dropdown-subitem"><a href="/captcha/luosimao/" class="nav-link">螺丝帽 Luosimao</a></li><li class="dropdown-subitem"><a href="/captcha/vaptcha/" class="nav-link">Vaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/verify5/" class="nav-link">V5 验证</a></li><li class="dropdown-subitem"><a href="/captcha/kgcaptcha/" class="nav-link">凯格 KYGER</a></li><li class="dropdown-subitem"><a href="/captcha/fastyotest/" class="nav-link">友验 FastYotest</a></li></ul></li><li class="dropdown-item"><h4>国外验证码</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/captcha/turnstile-managed/" class="nav-link">Cloudflare Turnstile</a></li><li class="dropdown-subitem"><a href="/captcha/recaptcha-v2-checkbox/" class="nav-link">Google reCAPTCHA</a></li><li class="dropdown-subitem"><a href="/captcha/hcaptcha-easy/" class="nav-link">hCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/funcaptcha/" class="nav-link">Arkose Labs FunCAPTCHA</a></li><li class="dropdown-subitem"><a href="/captcha/datadome/" class="nav-link">DataDome CAPTCHA</a></li><li class="dropdown-subitem"><a href="/captcha/perimeterx/" class="nav-link">PerimeterX丨HUMAN Challenge</a></li><li class="dropdown-subitem"><a href="/captcha/aws/" class="nav-link">AWS (Amazon) WAF Captcha</a></li><li class="dropdown-subitem"><a href="/captcha/mtcaptcha/" class="nav-link">MTCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/lemin/" class="nav-link">Lemin CAPTCHA丨Capy Puzzle</a></li><li class="dropdown-subitem"><a href="/captcha/yandex/" class="nav-link">Yandex SmartCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/mcaptcha/" class="nav-link">mCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/keycaptcha/" class="nav-link">KeyCAPTCHA</a></li><li class="dropdown-subitem"><a href="/captcha/cybersiara/" class="nav-link">CyberSiARA</a></li><li class="dropdown-subitem"><a href="/captcha/friendly-captcha/" class="nav-link">Friendly Captcha</a></li><li class="dropdown-subitem"><a href="/captcha/arcaptcha/" class="nav-link">ARCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/captchafox/" class="nav-link">CaptchaFox</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="辅助查询" class="dropdown-title"><a href="/pages/js-hook/" class="link-title">辅助查询</a> <span class="title" style="display:none;">辅助查询</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>辅助脚本</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/js-hook/" class="nav-link">JS Hook</a></li><li class="dropdown-subitem"><a href="/pages/frida-api/" class="nav-link">Frida API</a></li><li class="dropdown-subitem"><a href="/pages/babel/" class="nav-link">babel</a></li></ul></li><li class="dropdown-item"><h4>命令查询</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/linux/" class="nav-link">Linux 命令</a></li><li class="dropdown-subitem"><a href="/pages/adb/" class="nav-link">ADB 命令</a></li><li class="dropdown-subitem"><a href="/pages/arm/" class="nav-link">ARM 指令集</a></li><li class="dropdown-subitem"><a href="/pages/dalvik/" class="nav-link">Dalvik 指令集</a></li></ul></li><li class="dropdown-item"><h4>指纹信息</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/creepjs/" class="nav-link">CreepJS</a></li><li class="dropdown-subitem"><a href="/pages/fingerprint2/" class="nav-link">Fingerprint2</a></li><li class="dropdown-subitem"><a href="/pages/AHBD/" class="nav-link">自动化工具检测</a></li></ul></li><li class="dropdown-item"><h4>加密算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/url/" class="nav-link">URL</a></li><li class="dropdown-subitem"><a href="/pages/unicode/" class="nav-link">Unicode</a></li><li class="dropdown-subitem"><a href="/pages/base64/" class="nav-link">Base64</a></li><li class="dropdown-subitem"><a href="/pages/md5/" class="nav-link">MD5</a></li><li class="dropdown-subitem"><a href="/pages/hmac/" class="nav-link">HMAC</a></li><li class="dropdown-subitem"><a href="/pages/sha/" class="nav-link">SHA</a></li><li class="dropdown-subitem"><a href="/pages/rsa/" aria-current="page" class="nav-link router-link-exact-active router-link-active">RSA</a></li><li class="dropdown-subitem"><a href="/pages/aes/" class="nav-link">AES</a></li><li class="dropdown-subitem"><a href="/pages/des/" class="nav-link">DES</a></li><li class="dropdown-subitem"><a href="/pages/3des/" class="nav-link">3DES</a></li><li class="dropdown-subitem"><a href="/pages/rc4/" class="nav-link">RC4</a></li><li class="dropdown-subitem"><a href="/pages/sm/" class="nav-link">SM</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络请求" class="dropdown-title"><a href="/net/requests/" class="link-title">网络请求</a> <span class="title" style="display:none;">网络请求</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基本请求</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/net/requests/" class="nav-link">Python</a></li></ul></li><li class="dropdown-item"><h4>异步协程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/asyncio/" class="nav-link">asyncio</a></li><li class="dropdown-subitem"><a href="/pages/gevent/" class="nav-link">gevent</a></li></ul></li><li class="dropdown-item"><h4>多线程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/threading/" class="nav-link">threading</a></li><li class="dropdown-subitem"><a href="/pages/vthread/" class="nav-link">vthread</a></li></ul></li><li class="dropdown-item"><h4>多进程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/multiprocessing/" class="nav-link">multiprocessing</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架接口" class="dropdown-title"><a href="/pages/selenium/" class="link-title">框架接口</a> <span class="title" style="display:none;">框架接口</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>自动化框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/selenium/" class="nav-link">selenium</a></li><li class="dropdown-subitem"><a href="/pages/pyppeteer/" class="nav-link">pyppeteer</a></li><li class="dropdown-subitem"><a href="/pages/playwright/" class="nav-link">playwright</a></li><li class="dropdown-subitem"><a href="/pages/splash/" class="nav-link">splash</a></li><li class="dropdown-subitem"><a href="/pages/DrissionPage/" class="nav-link">DrissionPage</a></li><li class="dropdown-subitem"><a href="/pages/appium/" class="nav-link">appium</a></li><li class="dropdown-subitem"><a href="/pages/airtest/" class="nav-link">airtest</a></li></ul></li><li class="dropdown-item"><h4>接口编写</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/FastAPI/" class="nav-link">FastAPI</a></li><li class="dropdown-subitem"><a href="/pages/flask/" class="nav-link">flask</a></li><li class="dropdown-subitem"><a href="/pages/express/" class="nav-link">express</a></li></ul></li><li class="dropdown-item"><h4>爬虫框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/scrapy/" class="nav-link">scrapy</a></li><li class="dropdown-subitem"><a href="/pages/feapder/" class="nav-link">feapder</a></li><li class="dropdown-subitem"><a href="/pages/pyspider/" class="nav-link">pyspider</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据处理" class="dropdown-title"><a href="/pages/re/" class="link-title">数据处理</a> <span class="title" style="display:none;">数据处理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据提取</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/re/" class="nav-link">re</a></li><li class="dropdown-subitem"><a href="/pages/lxml/" class="nav-link">lxml</a></li><li class="dropdown-subitem"><a href="/pages/BeautifulSoup/" class="nav-link">BeautifulSoup</a></li><li class="dropdown-subitem"><a href="/pages/pyquery/" class="nav-link">pyquery</a></li><li class="dropdown-subitem"><a href="/pages/selectolax/" class="nav-link">selectolax</a></li></ul></li><li class="dropdown-item"><h4>数据分析</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/wordcloud/" class="nav-link">wordcloud</a></li><li class="dropdown-subitem"><a href="/pages/jieba/" class="nav-link">jieba</a></li><li class="dropdown-subitem"><a href="/pages/pandas/" class="nav-link">pandas</a></li><li class="dropdown-subitem"><a href="/pages/NumPy/" class="nav-link">NumPy</a></li><li class="dropdown-subitem"><a href="/pages/SciPy/" class="nav-link">SciPy</a></li></ul></li><li class="dropdown-item"><h4>制表绘图</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/matplotlib/" class="nav-link">matplotlib</a></li><li class="dropdown-subitem"><a href="/pages/pyecharts/" class="nav-link">pyecharts</a></li><li class="dropdown-subitem"><a href="/pages/plotly/" class="nav-link">plotly</a></li><li class="dropdown-subitem"><a href="/pages/seaborn/" class="nav-link">seaborn</a></li></ul></li><li class="dropdown-item"><h4>数据存储</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/file-storage/" class="nav-link">文件存储</a></li><li class="dropdown-subitem"><a href="/pages/MySQL/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/pages/MongoDB/" class="nav-link">MongoDB</a></li><li class="dropdown-subitem"><a href="/pages/Redis/" class="nav-link">Redis</a></li><li class="dropdown-subitem"><a href="/pages/SQLite/" class="nav-link">SQLite</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/goku/" class="nav-link">悟空风控</a></div><div class="nav-item"><a href="/pages/sponsor/" class="nav-link">赞助</a></div> <a href="https://github.com/WuKongSecurity/SpiderAPI" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/pages/toc/" class="nav-link">目录</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="验证码" class="dropdown-title"><a href="/captcha/" class="link-title">验证码</a> <span class="title" style="display:none;">验证码</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>国内验证码</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/captcha/dingxiang/" class="nav-link">顶象 DING XIANG</a></li><li class="dropdown-subitem"><a href="/captcha/shumei/" class="nav-link">数美 NEXTDATA</a></li><li class="dropdown-subitem"><a href="/captcha/yidun/" class="nav-link">易盾 NETEASE YIDUN</a></li><li class="dropdown-subitem"><a href="/captcha/geetest-v2/" class="nav-link">极验 GEETEST</a></li><li class="dropdown-subitem"><a href="/captcha/aliyun-v1/" class="nav-link">阿里云云盾验证码</a></li><li class="dropdown-subitem"><a href="/captcha/tencent/" class="nav-link">腾讯天御 T-Sec</a></li><li class="dropdown-subitem"><a href="/captcha/redcaptcha/" class="nav-link">小红书 redCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/xiaodun/" class="nav-link">小盾 XIAODUN</a></li><li class="dropdown-subitem"><a href="/captcha/yunpian/" class="nav-link">云片 YUNPIAN</a></li><li class="dropdown-subitem"><a href="/captcha/360/" class="nav-link">三六零天御</a></li><li class="dropdown-subitem"><a href="/captcha/luosimao/" class="nav-link">螺丝帽 Luosimao</a></li><li class="dropdown-subitem"><a href="/captcha/vaptcha/" class="nav-link">Vaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/verify5/" class="nav-link">V5 验证</a></li><li class="dropdown-subitem"><a href="/captcha/kgcaptcha/" class="nav-link">凯格 KYGER</a></li><li class="dropdown-subitem"><a href="/captcha/fastyotest/" class="nav-link">友验 FastYotest</a></li></ul></li><li class="dropdown-item"><h4>国外验证码</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/captcha/turnstile-managed/" class="nav-link">Cloudflare Turnstile</a></li><li class="dropdown-subitem"><a href="/captcha/recaptcha-v2-checkbox/" class="nav-link">Google reCAPTCHA</a></li><li class="dropdown-subitem"><a href="/captcha/hcaptcha-easy/" class="nav-link">hCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/funcaptcha/" class="nav-link">Arkose Labs FunCAPTCHA</a></li><li class="dropdown-subitem"><a href="/captcha/datadome/" class="nav-link">DataDome CAPTCHA</a></li><li class="dropdown-subitem"><a href="/captcha/perimeterx/" class="nav-link">PerimeterX丨HUMAN Challenge</a></li><li class="dropdown-subitem"><a href="/captcha/aws/" class="nav-link">AWS (Amazon) WAF Captcha</a></li><li class="dropdown-subitem"><a href="/captcha/mtcaptcha/" class="nav-link">MTCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/lemin/" class="nav-link">Lemin CAPTCHA丨Capy Puzzle</a></li><li class="dropdown-subitem"><a href="/captcha/yandex/" class="nav-link">Yandex SmartCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/mcaptcha/" class="nav-link">mCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/keycaptcha/" class="nav-link">KeyCAPTCHA</a></li><li class="dropdown-subitem"><a href="/captcha/cybersiara/" class="nav-link">CyberSiARA</a></li><li class="dropdown-subitem"><a href="/captcha/friendly-captcha/" class="nav-link">Friendly Captcha</a></li><li class="dropdown-subitem"><a href="/captcha/arcaptcha/" class="nav-link">ARCaptcha</a></li><li class="dropdown-subitem"><a href="/captcha/captchafox/" class="nav-link">CaptchaFox</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="辅助查询" class="dropdown-title"><a href="/pages/js-hook/" class="link-title">辅助查询</a> <span class="title" style="display:none;">辅助查询</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>辅助脚本</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/js-hook/" class="nav-link">JS Hook</a></li><li class="dropdown-subitem"><a href="/pages/frida-api/" class="nav-link">Frida API</a></li><li class="dropdown-subitem"><a href="/pages/babel/" class="nav-link">babel</a></li></ul></li><li class="dropdown-item"><h4>命令查询</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/linux/" class="nav-link">Linux 命令</a></li><li class="dropdown-subitem"><a href="/pages/adb/" class="nav-link">ADB 命令</a></li><li class="dropdown-subitem"><a href="/pages/arm/" class="nav-link">ARM 指令集</a></li><li class="dropdown-subitem"><a href="/pages/dalvik/" class="nav-link">Dalvik 指令集</a></li></ul></li><li class="dropdown-item"><h4>指纹信息</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/creepjs/" class="nav-link">CreepJS</a></li><li class="dropdown-subitem"><a href="/pages/fingerprint2/" class="nav-link">Fingerprint2</a></li><li class="dropdown-subitem"><a href="/pages/AHBD/" class="nav-link">自动化工具检测</a></li></ul></li><li class="dropdown-item"><h4>加密算法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/url/" class="nav-link">URL</a></li><li class="dropdown-subitem"><a href="/pages/unicode/" class="nav-link">Unicode</a></li><li class="dropdown-subitem"><a href="/pages/base64/" class="nav-link">Base64</a></li><li class="dropdown-subitem"><a href="/pages/md5/" class="nav-link">MD5</a></li><li class="dropdown-subitem"><a href="/pages/hmac/" class="nav-link">HMAC</a></li><li class="dropdown-subitem"><a href="/pages/sha/" class="nav-link">SHA</a></li><li class="dropdown-subitem"><a href="/pages/rsa/" aria-current="page" class="nav-link router-link-exact-active router-link-active">RSA</a></li><li class="dropdown-subitem"><a href="/pages/aes/" class="nav-link">AES</a></li><li class="dropdown-subitem"><a href="/pages/des/" class="nav-link">DES</a></li><li class="dropdown-subitem"><a href="/pages/3des/" class="nav-link">3DES</a></li><li class="dropdown-subitem"><a href="/pages/rc4/" class="nav-link">RC4</a></li><li class="dropdown-subitem"><a href="/pages/sm/" class="nav-link">SM</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="网络请求" class="dropdown-title"><a href="/net/requests/" class="link-title">网络请求</a> <span class="title" style="display:none;">网络请求</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基本请求</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/net/requests/" class="nav-link">Python</a></li></ul></li><li class="dropdown-item"><h4>异步协程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/asyncio/" class="nav-link">asyncio</a></li><li class="dropdown-subitem"><a href="/pages/gevent/" class="nav-link">gevent</a></li></ul></li><li class="dropdown-item"><h4>多线程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/threading/" class="nav-link">threading</a></li><li class="dropdown-subitem"><a href="/pages/vthread/" class="nav-link">vthread</a></li></ul></li><li class="dropdown-item"><h4>多进程</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/multiprocessing/" class="nav-link">multiprocessing</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架接口" class="dropdown-title"><a href="/pages/selenium/" class="link-title">框架接口</a> <span class="title" style="display:none;">框架接口</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>自动化框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/selenium/" class="nav-link">selenium</a></li><li class="dropdown-subitem"><a href="/pages/pyppeteer/" class="nav-link">pyppeteer</a></li><li class="dropdown-subitem"><a href="/pages/playwright/" class="nav-link">playwright</a></li><li class="dropdown-subitem"><a href="/pages/splash/" class="nav-link">splash</a></li><li class="dropdown-subitem"><a href="/pages/DrissionPage/" class="nav-link">DrissionPage</a></li><li class="dropdown-subitem"><a href="/pages/appium/" class="nav-link">appium</a></li><li class="dropdown-subitem"><a href="/pages/airtest/" class="nav-link">airtest</a></li></ul></li><li class="dropdown-item"><h4>接口编写</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/FastAPI/" class="nav-link">FastAPI</a></li><li class="dropdown-subitem"><a href="/pages/flask/" class="nav-link">flask</a></li><li class="dropdown-subitem"><a href="/pages/express/" class="nav-link">express</a></li></ul></li><li class="dropdown-item"><h4>爬虫框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/scrapy/" class="nav-link">scrapy</a></li><li class="dropdown-subitem"><a href="/pages/feapder/" class="nav-link">feapder</a></li><li class="dropdown-subitem"><a href="/pages/pyspider/" class="nav-link">pyspider</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据处理" class="dropdown-title"><a href="/pages/re/" class="link-title">数据处理</a> <span class="title" style="display:none;">数据处理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据提取</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/re/" class="nav-link">re</a></li><li class="dropdown-subitem"><a href="/pages/lxml/" class="nav-link">lxml</a></li><li class="dropdown-subitem"><a href="/pages/BeautifulSoup/" class="nav-link">BeautifulSoup</a></li><li class="dropdown-subitem"><a href="/pages/pyquery/" class="nav-link">pyquery</a></li><li class="dropdown-subitem"><a href="/pages/selectolax/" class="nav-link">selectolax</a></li></ul></li><li class="dropdown-item"><h4>数据分析</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/wordcloud/" class="nav-link">wordcloud</a></li><li class="dropdown-subitem"><a href="/pages/jieba/" class="nav-link">jieba</a></li><li class="dropdown-subitem"><a href="/pages/pandas/" class="nav-link">pandas</a></li><li class="dropdown-subitem"><a href="/pages/NumPy/" class="nav-link">NumPy</a></li><li class="dropdown-subitem"><a href="/pages/SciPy/" class="nav-link">SciPy</a></li></ul></li><li class="dropdown-item"><h4>制表绘图</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/matplotlib/" class="nav-link">matplotlib</a></li><li class="dropdown-subitem"><a href="/pages/pyecharts/" class="nav-link">pyecharts</a></li><li class="dropdown-subitem"><a href="/pages/plotly/" class="nav-link">plotly</a></li><li class="dropdown-subitem"><a href="/pages/seaborn/" class="nav-link">seaborn</a></li></ul></li><li class="dropdown-item"><h4>数据存储</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/pages/file-storage/" class="nav-link">文件存储</a></li><li class="dropdown-subitem"><a href="/pages/MySQL/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/pages/MongoDB/" class="nav-link">MongoDB</a></li><li class="dropdown-subitem"><a href="/pages/Redis/" class="nav-link">Redis</a></li><li class="dropdown-subitem"><a href="/pages/SQLite/" class="nav-link">SQLite</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/pages/goku/" class="nav-link">悟空风控</a></div><div class="nav-item"><a href="/pages/sponsor/" class="nav-link">赞助</a></div> <a href="https://github.com/WuKongSecurity/SpiderAPI" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <div class="sidebar-slot sidebar-slot-top">
    <a href="https://www.qg.net/product/proxyip.html?web=spiderapi-s" target="_blank">
        <img src="https://static.wukongsec.com/spiderbox/images/ads/qg2.jpg" alt="bright data" class="no-zoom" style="width: 100%;border-radius: 5px;">
    </a>
    <a href="https://get.brightdata.com/proxyb" target="_blank">
        <img src="https://static.wukongsec.com/spiderbox/images/ads/brightdata2.jpg" alt="bright data" class="no-zoom" style="width: 100%;border-radius: 5px;">
    </a>
    <p style="text-align: center;margin: 0;color: #999;font-size: 12px;">(进入注册为作者充电)</p>
    </div> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>辅助脚本</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/js-hook/" class="sidebar-link">JS Hook</a></li><li><a href="/pages/frida-api/" class="sidebar-link">Frida API</a></li><li><a href="/pages/babel/" class="sidebar-link">Babel</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>命令查询</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/linux/" class="sidebar-link">Linux 命令</a></li><li><a href="/pages/adb/" class="sidebar-link">ADB 命令</a></li><li><a href="/pages/arm/" class="sidebar-link">ARM 指令集</a></li><li><a href="/pages/dalvik/" class="sidebar-link">Dalvik 指令集</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>指纹信息</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/creepjs/" class="sidebar-link">CreepJS</a></li><li><a href="/pages/fingerprint2/" class="sidebar-link">Fingerprint2</a></li><li><a href="/pages/AHBD/" class="sidebar-link">自动化工具检测</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>加密算法</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/url/" class="sidebar-link">URL</a></li><li><a href="/pages/unicode/" class="sidebar-link">Unicode</a></li><li><a href="/pages/base64/" class="sidebar-link">Base64</a></li><li><a href="/pages/md5/" class="sidebar-link">MD5</a></li><li><a href="/pages/hmac/" class="sidebar-link">HMAC</a></li><li><a href="/pages/sha/" class="sidebar-link">SHA</a></li><li><a href="/pages/rsa/" aria-current="page" class="active sidebar-link">RSA</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/pages/rsa/#生成密钥" class="sidebar-link">生成密钥</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/rsa/#python" class="sidebar-link">Python</a></li><li class="sidebar-sub-header level3"><a href="/pages/rsa/#javascript" class="sidebar-link">JavaScript</a></li><li class="sidebar-sub-header level3"><a href="/pages/rsa/#golang" class="sidebar-link">Golang</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/rsa/#解析密钥" class="sidebar-link">解析密钥</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/rsa/#python-2" class="sidebar-link">Python</a></li><li class="sidebar-sub-header level3"><a href="/pages/rsa/#javascript-2" class="sidebar-link">JavaScript</a></li><li class="sidebar-sub-header level3"><a href="/pages/rsa/#golang-2" class="sidebar-link">Golang</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/rsa/#转换密钥" class="sidebar-link">转换密钥</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/rsa/#python-3" class="sidebar-link">Python</a></li><li class="sidebar-sub-header level3"><a href="/pages/rsa/#javascript-3" class="sidebar-link">JavaScript</a></li><li class="sidebar-sub-header level3"><a href="/pages/rsa/#golang-3" class="sidebar-link">Golang</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/rsa/#加密解密" class="sidebar-link">加密解密</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/rsa/#python-4" class="sidebar-link">Python</a></li><li class="sidebar-sub-header level3"><a href="/pages/rsa/#javascript-4" class="sidebar-link">JavaScript</a></li><li class="sidebar-sub-header level3"><a href="/pages/rsa/#golang-4" class="sidebar-link">Golang</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/pages/rsa/#在线工具" class="sidebar-link">在线工具</a></li></ul></li><li><a href="/pages/aes/" class="sidebar-link">AES</a></li><li><a href="/pages/des/" class="sidebar-link">DES</a></li><li><a href="/pages/3des/" class="sidebar-link">3DES</a></li><li><a href="/pages/rc4/" class="sidebar-link">RC4</a></li><li><a href="/pages/sm/" class="sidebar-link">SM</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="placeholder"></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">RSA<!----></h1>  <div class="theme-vdoing-content content__default"><details class="custom-block details"><summary>关于 RSA 非对称加密算法</summary> <p>RSA 加密算法是一种非对称加密算法，是由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）在 1977 年一起提出的，RSA 就是他们三人姓氏开头字母拼在一起组成的。RSA 公开密钥密码体制的原理是：根据数论，寻求两个大素数比较简单，而将它们的乘积进行因式分解却极其困难，因此可以将乘积公开作为加密密钥。</p> <div class="custom-block right"><p>RSA <a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank" rel="noopener noreferrer">维基百科<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></details> <div class="custom-block danger"><p class="custom-block-title">注意</p> <p>RSA 加解密涉及到密钥位数、密钥格式、密钥语法标准、填充方式等概念，请务必理解后再进行使用，否则可能在使用代码时发生各种报错，认真阅读文档，可解决 99% 的问题！！！</p></div> <h2 id="生成密钥"><a href="#生成密钥" class="header-anchor">#</a> 生成密钥</h2> <details class="custom-block details"><summary>关于密钥各个术语的解释</summary> <p><mark>什么是密钥的位数：</mark> <br></p> <p>该位数既不是指公钥的长度，也不是私钥的长度，实际上是指生成的 RSA 密钥对中公钥和私钥所包含的模数（modulus）的位数，给定一个公钥或者私钥，均可从中解析出模数，由于 RSA 密钥对是基于一个大素数乘积生成的，因此长度也决定了其安全性和加密强度，在实际使用中，密钥位数常见的有 512 位、1024 位、2048 位、3072 位和 4096 位。但实际应用中不推荐 512 位，需要注意的是，密钥长度越长，加密的强度也就越强，但同时也会增加程序计算的时间。例如，秘钥长度增加 1 倍，密钥对生成的时间就增加 16 倍，公钥加密操作时长增加 4 倍，私钥解密操作时长增加 8 倍。因此，选择密钥长度时需要综合考虑安全性和效率。</p> <hr> <p><mark>什么是模数（modulus）：</mark> <br></p> <p>RSA 密钥的模数是公钥和私钥中的一个重要参数，通常用大素数的乘积表示，在 RSA 加密算法中，模数（modulus）是两个大素数的乘积，通常用 N 表示，在密钥生成过程中，选择两个大素数 p 和 q，然后计算它们的乘积 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="N"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo space="3" class="mjx-n"><mjx-c c="D7"></mjx-c></mjx-mo><mjx-mi space="3" class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-math></mjx-container>，这个 N 就是 RSA 密钥的模数，模数 N 用于 RSA 算法中的加密、解密、签名和验证过程，公钥由模数 N 和公钥指数 e 组成，私钥由模数 N 和私钥指数 d 组成。模数 N 的长度通常决定了 RSA 密钥的安全性。</p> <hr> <p><mark>什么是公钥 / 私钥指数：</mark> <br></p> <p>在 RSA 加密算法中，公钥和私钥都包含一个指数，这些指数是用来进行加密和解密操作的，公钥指数通常用 e 表示，私钥指数通常用 d 表示，这两个指数的选择是相互关联的，确保了 RSA 算法的正确性，通常情况下，公钥指数 e 和私钥指数 d 满足以下条件：<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi><mjx-mo space="3" class="mjx-n"><mjx-c c="D7"></mjx-c></mjx-mo><mjx-mi space="3" class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="2261"></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="3D5"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="N"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>，其中 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="3D5"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="N"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container> 是欧拉函数，用于计算与模数 N 互素的正整数个数。这个条件保证了 RSA 加密和解密过程是可逆的，公钥指数 e 通常为 65537（0x10001，5bits），该值是除了 1、3、5、17、257 之外的最小素数，私钥指数 d 可以通过公钥指数 e 和模数 N 计算得到，一种常用的方法是使用扩展的欧几里得算法或模反演算法，这两种方法都可以有效地计算私钥指数 d，根据前面提到的两个指数关系的公式，可以得到：<mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="3D5"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="N"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mo space="4" class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn space="3" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn space="3" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>，所以私钥指数 d 应当是一个大整数，并且满足 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo space="4" class="mjx-n"><mjx-c c="&lt;"></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="&lt;"></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="3D5"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="N"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-math></mjx-container>。一般在各个 RSA 加解密代码里，都不用单独设置这公钥指数，基本上都是默认的 65537（0x10001，5bits）。</p> <hr> <p><mark>私钥签名（加密）：</mark> <br></p> <p>私钥签名，也称为私钥加密，私钥通常用于对敏感数据进行解密，如果私钥未经授权的访问者获得，可能会导致数据泄露或伪造签名等安全问题，通过加密私钥，即使未经授权的人获得了密钥文件，也需要正确的解密密码才能访问私钥，从而保护私钥的安全。在生成密钥对时，可以指定加密私钥的算法和密码，在使用私钥时，需要提供正确的解密密码才能解密私钥。</p> <hr> <p><mark>密钥输出的格式：</mark></p> <ul><li><code>der</code>：二进制数据，序列化 <a href="https://en.wikipedia.org/wiki/ASN.1#Example_encoded_in_DER" target="_blank" rel="noopener noreferrer">ASN.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 结构；</li> <li><code>pem</code>：最常见的类型，将 der 数据进行 base64 编码，然后加上以 <code>-----</code> 包裹的标头，用于标识密钥类型；</li> <li><code>jwk</code>：JSON Web 密钥，关键数据存储在 JSON 对象中，是 JavaScript 对象签名和加密 (JOSE) 规范的一部分；</li> <li><code>openssh</code>：OpenSSH 密钥格式，常用于在 OpenSSH 客户端和服务器之间传输密钥，密钥以 <code>ssh-rsa</code> 开头。</li></ul> <hr> <p><mark>密钥的语法标准：</mark></p> <ul><li>公钥语法标准：<code>pkcs1</code> 或 <code>spki</code></li> <li>私钥语法标准：<code>pkcs1</code> 或 <code>pkcs8</code></li></ul> <p>有的库里面（如：JS 的 <code>node-rsa</code> 库），公钥语法标准支持 <code>pkcs1</code> 或 <code>pkcs8</code>，没有 <code>spki</code>，事实上这是不太规范的说法，参见 <a href="https://github.com/rzcoder/node-rsa/issues/208" target="_blank" rel="noopener noreferrer">issues<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <p>当密钥输出格式为 <code>pem</code> 时：</p> <ul><li>公钥使用 <code>pkcs1</code> 标准，得到的公钥以 <code>-----BEGIN RSA PUBLIC KEY-----</code> 开头；</li> <li>公钥使用 <code>spki</code> 标准，得到的公钥以 <code>-----BEGIN PUBLIC KEY-----</code> 开头；</li> <li>私钥使用 <code>pkcs1</code> 标准，得到的私钥以 <code>-----BEGIN RSA PRIVATE KEY-----</code> 开头；</li> <li>私钥使用 <code>pkcs8</code> 标准，得到的私钥以 <code>-----BEGIN PRIVATE KEY-----</code> 开头。</li> <li>私钥使用 <code>pkcs1</code> 标准，如果对私钥进行了加密，则得到的私钥以 <code>-----BEGIN RSA PRIVATE KEY-----</code> 开头，但内容里包含 <code>Proc-Type</code>、<code>DEK-Info</code> 字段；</li> <li>私钥使用 <code>pkcs8</code> 标准，如果对私钥进行了加密，则得到的私钥以 <code>-----BEGIN ENCRYPTED PRIVATE KEY-----</code> 开头。</li></ul> <hr> <p><mark>pkcs 标准科普：</mark></p> <p><a href="https://en.wikipedia.org/wiki/PKCS" target="_blank" rel="noopener noreferrer">公钥加密标准（Public Key Cryptography Standards, PKCS）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，是由美国 RSA 数据安全公司及其合作伙伴制定的一组公钥密码学标准，其中包括证书申请、证书更新、证书作废表发布、扩展证书内容以及数字签名、数字信封的格式等方面的一系列相关协议。PKCS#1 至 PKCS#15 是不同类型的标准，用于不同的场景，在 RSA 算法中主要会用到 PKCS#1 和 PKCS#8 两种标准：</p> <ul><li>PKCS#1：专门针对 RSA 算法的一个标准，用于 RSA <font color="red"><strong>公钥和私钥</strong></font>的具体实现以及加密、签名算法的规定；</li> <li>PKCS#8：通用<font color="red"><strong>私钥</strong></font>语法标准，定义了私钥的存储格式，可以用于不同密码学算法的私钥存储。</li></ul> <hr> <p><mark>spki 标准科普：</mark></p> <ul><li><a href="https://en.wikipedia.org/wiki/Public_key_infrastructure" target="_blank" rel="noopener noreferrer">公开密钥基础设施（Public Key Infrastructure, PKI）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，又称公开密钥基础架构、公钥基础建设、公钥基础设施、公开密码匙基础建设或公钥基础架构，是一组由硬件、软件、参与者、管理政策与流程组成的基础架构，其目的在于创造、管理、分配、使用、存储以及撤销数字证书；</li> <li><a href="https://en.wikipedia.org/wiki/Simple_public-key_infrastructure" target="_blank" rel="noopener noreferrer">简单公钥基础设施（Simple public-key infrastructure, SPKI）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，是克服传统 X.509 PKI 复杂性的一种尝试，SPKI 规范定义了授权证书格式，提供了特权、权利或其他此类属性（称为授权）的描述，并将它们绑定到公钥。</li></ul> <hr> <div class="custom-block right"><p>【实用参考资料】</p> <p>公钥证书编码解读：<a href="https://zhuanlan.zhihu.com/p/77329250" target="_blank" rel="noopener noreferrer">https://zhuanlan.zhihu.com/p/77329250<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
RSA密钥长度、明文长度和密文长度：<a href="https://cloud.tencent.com/developer/article/1199963" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/1199963<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
安全：深入理解数字证书中的 PKCS#1 与 PKCS#8 标准 ：<a href="https://cloud.tencent.com/developer/article/2390956" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/2390956<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
PKCS#1、PKCS#5、PKCS#7、PKCS#8 到底是什么？：<a href="https://blog.csdn.net/weixin_45264425/article/details/127096145" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_45264425/article/details/127096145<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></details> <h3 id="python"><a href="#python" class="header-anchor">#</a> Python <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>3.0+</span></h3> <br> <div class="theme-code-group" data-v-392329f0><div class="theme-code-group__nav" data-v-392329f0><ul class="theme-code-group__ul" data-v-392329f0></ul></div> <div class="theme-code-block theme-code-block__active" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install pycryptodome，官方文档：https://pycryptodome.readthedocs.io/</span>

<span class="token comment" data-v-5a3e6e86># ❌ 密钥输出格式不支持 jwk</span>
<span class="token comment" data-v-5a3e6e86># ❌ 公钥语法标准不支持 pkcs1，仅支持 spki</span>
<span class="token comment" data-v-5a3e6e86># ❌ 私钥加密：当私钥语法标准为 pkcs1 时，不支持指定算法，默认使用 DES-EDE3-CBC</span>
<span class="token comment" data-v-5a3e6e86>#             当私钥语法标准为 pkcs8 时，protection 可以指定算法，算法名称参考：https://pycryptodome.readthedocs.io/en/latest/src/io/pkcs8.html#encryption-parameters</span>

<span class="token keyword" data-v-5a3e6e86>from</span> Crypto<span class="token punctuation" data-v-5a3e6e86>.</span>PublicKey <span class="token keyword" data-v-5a3e6e86>import</span> RSA


key <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>generate<span class="token punctuation" data-v-5a3e6e86>(</span>
    bits<span class="token operator" data-v-5a3e6e86>=</span><span class="token number" data-v-5a3e6e86>2048</span><span class="token punctuation" data-v-5a3e6e86>,</span>                           <span class="token comment" data-v-5a3e6e86># 密钥位数，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位</span>
    e<span class="token operator" data-v-5a3e6e86>=</span><span class="token number" data-v-5a3e6e86>65537</span>                              <span class="token comment" data-v-5a3e6e86># 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数</span>
<span class="token punctuation" data-v-5a3e6e86>)</span>

private_key <span class="token operator" data-v-5a3e6e86>=</span> key<span class="token punctuation" data-v-5a3e6e86>.</span>export_key<span class="token punctuation" data-v-5a3e6e86>(</span>
    <span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span>                        <span class="token comment" data-v-5a3e6e86># 私钥输出格式，支持 pem、der、openssh</span>
    pkcs<span class="token operator" data-v-5a3e6e86>=</span><span class="token number" data-v-5a3e6e86>8</span><span class="token punctuation" data-v-5a3e6e86>,</span>                              <span class="token comment" data-v-5a3e6e86># 私钥语法标准，支持 pkcs1、pkcs8，该参数仅对私钥有效</span>
    <span class="token comment" data-v-5a3e6e86># passphrase=&quot;spiderapi&quot;,            # 可选参数，私钥加密的密码，如果私钥加密了，则使用时需要先解密，该参数仅对私钥有效</span>
    <span class="token comment" data-v-5a3e6e86># protection=&quot;scryptAndAES128-GCM&quot;,  # 可选参数，私钥加密的算法，该参数仅对私钥，且 pkcs=8 时有效</span>
<span class="token punctuation" data-v-5a3e6e86>)</span>
public_key <span class="token operator" data-v-5a3e6e86>=</span> key<span class="token punctuation" data-v-5a3e6e86>.</span>publickey<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>.</span>export_key<span class="token punctuation" data-v-5a3e6e86>(</span>
    <span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span>                        <span class="token comment" data-v-5a3e6e86># 公钥输出格式，支持 pem、der、openssh，公钥语法标准，仅支持且默认 spki</span>
<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 公钥（spki、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> public_key<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;utf-8&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 私钥（pkcs8、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;utf-8&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
RSA 公钥（spki、pem）：

-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4MIESlYLQMhXeh1AsIxi
XqdbyG6hMo7feRu2CsvH14iYdwaxMZ2gV3PBu+Z9gCD+zoreO4PYMqpn0koXGg2n
VRhTZVzJARVnLokmK3wVFYx2ooubABFv/duL30LzHi2qheXIz5etB0XjOPz1A9D3
OngaHH6YnyoCos0KtDbaiNOdYY2lh5tXG8JV4yaHGmPgHLYjp19EBOYaqiXj89Ut
GtTvc/bl6pO1uZbsR70zZY2yU79+B7UGhsMHTcFdZ7XokLk2uwUoKRYvsD1S/pEX
xIYwq1DJZ4/SMAidVe58jwPEg9Vonb/HZX24l35PSDDKC52oUaEynQcdvnHJoJM9
hwIDAQAB
-----END PUBLIC KEY-----

RSA 私钥（pkcs8、pem）：

-----BEGIN PRIVATE KEY-----
MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDgwgRKVgtAyFd6
HUCwjGJep1vIbqEyjt95G7YKy8fXiJh3BrExnaBXc8G75n2AIP7Oit47g9gyqmfS
ShcaDadVGFNlXMkBFWcuiSYrfBUVjHaii5sAEW/924vfQvMeLaqF5cjPl60HReM4
/PUD0Pc6eBocfpifKgKizQq0NtqI051hjaWHm1cbwlXjJocaY+ActiOnX0QE5hqq
JePz1S0a1O9z9uXqk7W5luxHvTNljbJTv34HtQaGwwdNwV1nteiQuTa7BSgpFi+w
PVL+kRfEhjCrUMlnj9IwCJ1V7nyPA8SD1Widv8dlfbiXfk9IMMoLnahRoTKdBx2+
ccmgkz2HAgMBAAECggEACSTA0Zi0MX5VAgycRp0XcrwClwyvyyOWgidMncjSMvmw
INt+rELk3y9AOO7fY9iJH970u91ubLU+WbGWRK2R2qY4MlNMLBqc+CmFNNdXRj6m
JDu4t7p94LPPT2sPrUZ0qFODpV+0HtZ1hX/TpJmaN+CN82MlE13n/eEzPRykLFUY
DVhXcVYlMamHCtNT9039ByEBF7kIeODhLPYgKAcwCOY8f4fQqEDZUfshbHdOlAt+
Bx9bOToSPqNYMIrzHk/SrUfjI2+x3mVZY5PSSxyBRObroKVd4V+De+bXUyLhdnpC
RmH8JWsFEcfSILMSlkrfA+xGag36oXTD8wtf19X9XQKBgQDqMQ+B3fiicVLirdLx
PB0OD4U2noitzkyjr+qZYx3VpIRu+eK1q9esJ9KYzBUEdfTCXaKHHVcjZ/IErOsZ
eFcBS2Fwwpa3GMeOJ4hTcNuzBIsp6D/g6PwSF4I/lGXTSCep7YEgoana3VItKlqx
FbweB1guMpzS0jpWKVAPFAG3KwKBgQD1sBAXTqZqXcaVLkgZaowdFA2maFDpNp0b
tiyGcyRAhYHdbb4TBFrgSDCYdnMpQMo0H4YmqRQFI38r5ROOsSQDcTNwMf6E9nUX
QlZu1DBri0vnGgbjRTuKIDUEadVrCepCHfYyX7yEMg1vkCqdoknqFICn38R48Gq9
Ab66m+IlFQKBgBv3M9TcPt6XDcDH5RKtjQKq08uL7uJiakB5t1gNv/hNJwthh7MO
DDkgoENiy3e25j13lPrxhABUX1AznfdyqWEcMUyX0AuZR+svyVW9el7MQhoFA+vF
pqQ6bnFNNUOfsCzYkbzl0TSzjSabkiznXYlwcxVBMfzy4ch8MnU6fGH1AoGAZg3/
cR8Lg412istRybT3hLCqxt/4FBfKhRNURXkYqvCKNEd8t/uMIDP8c6hoR8+Q7rvV
hsOe/E91aO9cA17TvdZM7qLlvad+le3JZ3oert2K5vFpwQgmJkcgnrezniXdOB+n
/97CuQrth9UTzqz2FRT1KEaMH0yGmgJajrtn4c0CgYA7N7XM7oI6oH5uG0c2bcNT
oF6CbMKKY6IRmpyrTeozRrNo/luA0v89o6ETdeC/hChzVh66oECz9KW/XVXFyttt
8sOTwXEsdWE4A7oNOM1vQhx7DtKJpqtvZFAxrVhgYyuaZSAEc2isWKhIPWq2mjKD
pByL7lrJPDv9Z7za63nMBQ==
-----END PRIVATE KEY-----
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>62</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>63</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>64</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>65</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>66</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>67</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>68</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>69</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>70</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>71</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>72</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install cryptography，要求 Python 3.7+，官方文档：https://cryptography.io/</span>

<span class="token comment" data-v-5a3e6e86># ❌ 密钥输出格式不支持 jwk</span>
<span class="token comment" data-v-5a3e6e86># ❌ 私钥语法标准不支持 pkcs1</span>

<span class="token keyword" data-v-5a3e6e86>from</span> cryptography<span class="token punctuation" data-v-5a3e6e86>.</span>hazmat<span class="token punctuation" data-v-5a3e6e86>.</span>primitives<span class="token punctuation" data-v-5a3e6e86>.</span>asymmetric <span class="token keyword" data-v-5a3e6e86>import</span> rsa
<span class="token keyword" data-v-5a3e6e86>from</span> cryptography<span class="token punctuation" data-v-5a3e6e86>.</span>hazmat<span class="token punctuation" data-v-5a3e6e86>.</span>primitives <span class="token keyword" data-v-5a3e6e86>import</span> serialization
<span class="token keyword" data-v-5a3e6e86>from</span> cryptography<span class="token punctuation" data-v-5a3e6e86>.</span>hazmat<span class="token punctuation" data-v-5a3e6e86>.</span>primitives<span class="token punctuation" data-v-5a3e6e86>.</span>ciphers <span class="token keyword" data-v-5a3e6e86>import</span> algorithms


private_key <span class="token operator" data-v-5a3e6e86>=</span> rsa<span class="token punctuation" data-v-5a3e6e86>.</span>generate_private_key<span class="token punctuation" data-v-5a3e6e86>(</span>
    public_exponent<span class="token operator" data-v-5a3e6e86>=</span><span class="token number" data-v-5a3e6e86>65537</span><span class="token punctuation" data-v-5a3e6e86>,</span>                                 <span class="token comment" data-v-5a3e6e86># 公钥指数，推荐 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数</span>
    key_size<span class="token operator" data-v-5a3e6e86>=</span><span class="token number" data-v-5a3e6e86>2048</span>                                          <span class="token comment" data-v-5a3e6e86># 密钥位数，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位</span>
<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token comment" data-v-5a3e6e86># 从私钥中提取公钥</span>
public_key <span class="token operator" data-v-5a3e6e86>=</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>public_key<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token comment" data-v-5a3e6e86># 序列化私钥和公钥</span>
public_key <span class="token operator" data-v-5a3e6e86>=</span> public_key<span class="token punctuation" data-v-5a3e6e86>.</span>public_bytes<span class="token punctuation" data-v-5a3e6e86>(</span>
    encoding<span class="token operator" data-v-5a3e6e86>=</span>serialization<span class="token punctuation" data-v-5a3e6e86>.</span>Encoding<span class="token punctuation" data-v-5a3e6e86>.</span>PEM<span class="token punctuation" data-v-5a3e6e86>,</span>                    <span class="token comment" data-v-5a3e6e86># 公钥输出格式，支持 pem、der、openssh</span>
    <span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span>serialization<span class="token punctuation" data-v-5a3e6e86>.</span>PublicFormat<span class="token punctuation" data-v-5a3e6e86>.</span>SubjectPublicKeyInfo  <span class="token comment" data-v-5a3e6e86># 公钥语法标准，支持 pkcs1、spki (SubjectPublicKeyInfo)</span>
<span class="token punctuation" data-v-5a3e6e86>)</span>


private_key <span class="token operator" data-v-5a3e6e86>=</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>private_bytes<span class="token punctuation" data-v-5a3e6e86>(</span>
    encoding<span class="token operator" data-v-5a3e6e86>=</span>serialization<span class="token punctuation" data-v-5a3e6e86>.</span>Encoding<span class="token punctuation" data-v-5a3e6e86>.</span>PEM<span class="token punctuation" data-v-5a3e6e86>,</span>                    <span class="token comment" data-v-5a3e6e86># 私钥输出格式，支持 pem、der、openssh</span>
    <span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span>serialization<span class="token punctuation" data-v-5a3e6e86>.</span>PrivateFormat<span class="token punctuation" data-v-5a3e6e86>.</span>PKCS8<span class="token punctuation" data-v-5a3e6e86>,</span>               <span class="token comment" data-v-5a3e6e86># 私钥语法标准，支持 pkcs8</span>
    encryption_algorithm<span class="token operator" data-v-5a3e6e86>=</span>serialization<span class="token punctuation" data-v-5a3e6e86>.</span>NoEncryption<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>       <span class="token comment" data-v-5a3e6e86># 私钥不加密</span>
    <span class="token comment" data-v-5a3e6e86># encryption_algorithm=serialization.BestAvailableEncryption(&quot;password&quot;.encode())  # 对私钥加密</span>
<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 公钥（spki、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> public_key<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;utf-8&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 私钥（pkcs8、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;utf-8&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>


<span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
RSA 公钥（spki、pem）：

-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAunWw+FBw3WGzKuU9tyoP
0UWn0FOD5N7vlfhjFn0FUkeMQlgPqj+4uxNnayMA4Qxj9UeMS/N9+dN8KfIWnvjg
R+UBsSgqZuy/ONx9E23ycq6l2RjGbdIKcRSsmmEKcAjCQub/EglWhzhacwLB4nr/
HQvQS2x/J5NwR9WD8VWoYPICIa+LUSNZAbbA29Fitj7njbJkJbhNX4aaHUSQpWFG
djoFyGmpXb1HhaswmaC1jtZo5xzQfuSIeCq21VNWS2wvKdqcHg7jNbhhst54H3W5
O7Qg7IYiGseYLO2m6f4NxLuhFDfdDHjSNDONzgGvm1fAI1Xs1r01BTx0n3DfSbqz
AQIDAQAB
-----END PUBLIC KEY-----

RSA 私钥（pkcs8、pem）：

-----BEGIN PRIVATE KEY-----
MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC6dbD4UHDdYbMq
5T23Kg/RRafQU4Pk3u+V+GMWfQVSR4xCWA+qP7i7E2drIwDhDGP1R4xL833503wp
8hae+OBH5QGxKCpm7L843H0TbfJyrqXZGMZt0gpxFKyaYQpwCMJC5v8SCVaHOFpz
AsHiev8dC9BLbH8nk3BH1YPxVahg8gIhr4tRI1kBtsDb0WK2PueNsmQluE1fhpod
RJClYUZ2OgXIaaldvUeFqzCZoLWO1mjnHNB+5Ih4KrbVU1ZLbC8p2pweDuM1uGGy
3ngfdbk7tCDshiIax5gs7abp/g3Eu6EUN90MeNI0M43OAa+bV8AjVezWvTUFPHSf
cN9JurMBAgMBAAECggEBAKydjcKjvYjFDLf2V0b88n27LVsIJb84v7Ynp5vHC6kb
QXadzYq/yQWvNfuSARtWfCczIGejuAkSxwyR6G0tW3xTPljCJVb5byF1xXi6PUv7
8N9lNzWt0CrVh+C3W5FSGn0TGimZaXhvLBTzBYjkcs5yBFf+zkxWCwkFWkuOD/4G
F9sCAzdrxbHkn1qpbPBCf4NIJ3ETApD3AMFuZol+GzAz1E6xaCupCqf1+yjWGjhE
VjPA6MPx/RqPxI/Xn2BsX9nNEfsyxHmffbG9Hnu487ByOZFOdw/5JWsgCuhnX/0I
cERAhuuXtjya9NuJkMrXGnoXofc7Om79oE0blcXSb60CgYEA5vhlGkaXeduFHJNa
2ATDXrYGO1vEYR3fmxUKE7VYjGWZBzaUAQBFc+KFlpj6/587Hyldi6xG+PUWrMzS
nMDSEgZY+3WdyE9DmUOjp2Mf8sPQYRob3T7osL7ttyaMB5Fv+Rap/HuRla/2FAR7
77nvFsaGmUW+w4YuVWxKjUcVWMsCgYEAzqp6qBdFugCXwZyIasucqI2DKOocnfbR
Rbk0lcpyz2Fl6CqPUc1eJUesoOxZuvShMGpeqWPwiD97lsI6BJ5P7ymalR3XaGBr
nNineop0a2sxj4cbEEcxOXJfl46+MDmDY9n0kOFzULwm0cP1m0VFjMmTLXGnsCRZ
SVQFGMATBeMCgYBhF/54Y0B+K3fzoUZJFQeEIwTPoy4UnVhIezm3Oz60FmmUDK9/
FDweERWTT1AEcU2LNfprIsrbETys+5V16+DjTuPNIY5ojFmgbjy3uwXNKd/JUg5w
nWd4FWsc2Ql4jP0DOzHOP6vdvxC1LYVkK0eEzYP7nsQosZl8s39LkJw6rQKBgFYh
8zDvUh4tdRI6XRi1d7tAD3QT7o1feuTmRaZQU/1eiIx0gHsFbsF219nR56vlnPCC
xKUwg+UlICs7E9cs6/+vhT+0yjw0Q2WBXnvSDKdga614D61/HmLk6jZORbHvpnUN
N8LSU69IW519YHWwL0Z4FKESB2OAIr5PCDjChKslAoGBAIe5+HFJyOZTt3Urzwzc
7h8q97z+DXRChzTiBv8KaM3hknmKYc9qoGpOK6FqM8GcotvI55ZGlixJtmy1GMRf
nk1qENc23oadYBEzAcQA5+0me/QDxk0q0BdkDkaNH2NA6lMY/4TriNde/fSY7Dil
bDVst9Y7yqL41PYRWM/rhWas
-----END PRIVATE KEY-----
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>62</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>63</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>64</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>65</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>66</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>67</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>68</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>69</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>70</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>71</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>72</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>73</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>74</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>75</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>76</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>77</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>78</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>79</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>80</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install rsa，官方文档：https://stuvel.eu/python-rsa-doc/</span>

<span class="token comment" data-v-5a3e6e86># ❌ 密钥输出格式不支持 jwk、openssh</span>
<span class="token comment" data-v-5a3e6e86># ❌ 公钥语法标准不支持 spki</span>
<span class="token comment" data-v-5a3e6e86># ❌ 私钥语法标准不支持 pkcs8</span>
<span class="token comment" data-v-5a3e6e86># ❌ 不支持对私钥进行签名、加密</span>

<span class="token keyword" data-v-5a3e6e86>import</span> rsa


<span class="token punctuation" data-v-5a3e6e86>(</span>public_key<span class="token punctuation" data-v-5a3e6e86>,</span> private_key<span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token operator" data-v-5a3e6e86>=</span> rsa<span class="token punctuation" data-v-5a3e6e86>.</span>newkeys<span class="token punctuation" data-v-5a3e6e86>(</span>
    nbits<span class="token operator" data-v-5a3e6e86>=</span><span class="token number" data-v-5a3e6e86>1024</span><span class="token punctuation" data-v-5a3e6e86>,</span>        <span class="token comment" data-v-5a3e6e86># 密钥位数，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位</span>
    exponent<span class="token operator" data-v-5a3e6e86>=</span><span class="token number" data-v-5a3e6e86>65537</span>     <span class="token comment" data-v-5a3e6e86># 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数</span>
<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token comment" data-v-5a3e6e86># 公钥和私钥输出各种都仅支持 pem 和 der，语法标准都只支持 pkcs1</span>
public_key <span class="token operator" data-v-5a3e6e86>=</span> public_key<span class="token punctuation" data-v-5a3e6e86>.</span>save_pkcs1<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>
private_key <span class="token operator" data-v-5a3e6e86>=</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>save_pkcs1<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 公钥（pkcs1、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> public_key<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;utf-8&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 私钥（pkcs1、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;utf-8&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
RSA 公钥（pkcs1、pem）：

-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----

RSA 私钥（pkcs1、pem）：

-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86></div></div></div> <pre class="pre-blank" data-v-392329f0>// Make sure to add code blocks to your code group</pre></div> <h3 id="javascript"><a href="#javascript" class="header-anchor">#</a> JavaScript <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>Node.js</span> <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>ECMAScript 5.1+</span></h3> <br> <div class="theme-code-group" data-v-392329f0><div class="theme-code-group__nav" data-v-392329f0><ul class="theme-code-group__ul" data-v-392329f0></ul></div> <div class="theme-code-block theme-code-block__active" data-v-5a3e6e86><div class="language-javascript line-numbers-mode" data-v-5a3e6e86><pre class="language-javascript" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86>// ✅ Node.js 内置 crypto 模块，无需单独安装</span>

<span class="token comment" data-v-5a3e6e86>// ❌ 密钥输出格式不支持 openssh</span>

<span class="token keyword" data-v-5a3e6e86>var</span> crypto <span class="token operator" data-v-5a3e6e86>=</span> <span class="token function" data-v-5a3e6e86>require</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;crypto&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>


<span class="token keyword" data-v-5a3e6e86>var</span> <span class="token punctuation" data-v-5a3e6e86>{</span> publicKey<span class="token punctuation" data-v-5a3e6e86>,</span> privateKey <span class="token punctuation" data-v-5a3e6e86>}</span> <span class="token operator" data-v-5a3e6e86>=</span> crypto<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>generateKeyPairSync</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;rsa&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token punctuation" data-v-5a3e6e86>{</span>
    <span class="token literal-property property" data-v-5a3e6e86>modulusLength</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token number" data-v-5a3e6e86>1024</span><span class="token punctuation" data-v-5a3e6e86>,</span>            <span class="token comment" data-v-5a3e6e86>// 密钥位数，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位</span>
    <span class="token literal-property property" data-v-5a3e6e86>publicExponent</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token number" data-v-5a3e6e86>65537</span><span class="token punctuation" data-v-5a3e6e86>,</span>          <span class="token comment" data-v-5a3e6e86>// 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数</span>
        <span class="token literal-property property" data-v-5a3e6e86>publicKeyEncoding</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token punctuation" data-v-5a3e6e86>{</span>
        <span class="token literal-property property" data-v-5a3e6e86>type</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token string" data-v-5a3e6e86>&quot;spki&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span>               <span class="token comment" data-v-5a3e6e86>// 公钥语法标准，支持 pkcs1、spki</span>
        <span class="token literal-property property" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token string" data-v-5a3e6e86>&quot;pem&quot;</span>               <span class="token comment" data-v-5a3e6e86>// 公钥输出格式，支持 pem、der、jwk</span>
    <span class="token punctuation" data-v-5a3e6e86>}</span><span class="token punctuation" data-v-5a3e6e86>,</span>
    <span class="token literal-property property" data-v-5a3e6e86>privateKeyEncoding</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token punctuation" data-v-5a3e6e86>{</span>
        <span class="token literal-property property" data-v-5a3e6e86>type</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token string" data-v-5a3e6e86>&quot;pkcs1&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span>              <span class="token comment" data-v-5a3e6e86>// 私钥语法标准，支持 pkcs1、pkcs8</span>
        <span class="token literal-property property" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token string" data-v-5a3e6e86>&quot;pem&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span>              <span class="token comment" data-v-5a3e6e86>// 私钥输出格式，支持 pem、der、jwk</span>
        <span class="token comment" data-v-5a3e6e86>// cipher: &quot;aes-256-cbc&quot;,   // 可选参数，私钥加密的算法，如 aes-256-cbc、des-ded3-cbc 等，如果私钥加密了，则使用时需要先解密</span>
        <span class="token comment" data-v-5a3e6e86>// passphrase: &quot;spiderapi&quot;  // 可选参数，私钥加密的密码</span>
    <span class="token punctuation" data-v-5a3e6e86>}</span>
<span class="token punctuation" data-v-5a3e6e86>}</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>

console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 公钥（spki、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> publicKey<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 私钥（pkcs1、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> privateKey<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>


<span class="token comment" data-v-5a3e6e86>/*
RSA 公钥（spki、pem）：

-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDki91MwofoyFW+TPdkDLjvww9q
GjKzgzbEhTUrl5qBwjWQo/yr1nhbTC4i9Qso8XJS8350cwz2ixbkE0QJgdPtL8d2
lLUIVDxTy8uAFITvYie7rHNanjPyB2ytnm8p85EyYKZnAlq5V3w9hNAM5XxGnffi
y4PiS7OlhAdVLZM32QIDAQAB
-----END PUBLIC KEY-----

RSA 私钥（pkcs1、pem）：

-----BEGIN RSA PRIVATE KEY-----
MIICXQIBAAKBgQDki91MwofoyFW+TPdkDLjvww9qGjKzgzbEhTUrl5qBwjWQo/yr
1nhbTC4i9Qso8XJS8350cwz2ixbkE0QJgdPtL8d2lLUIVDxTy8uAFITvYie7rHNa
njPyB2ytnm8p85EyYKZnAlq5V3w9hNAM5XxGnffiy4PiS7OlhAdVLZM32QIDAQAB
AoGBAJon0QxOhne4cUVcCt5cSn3Gl2Yc56f30IA7zYJqztfJVHIMeoi5sBL8zn3b
xTxHp7JV9Sy80biWVsleSV0USgoDCkTZqgJTq7pTeUg+LTRSplPb00sm1/gyS7fU
vwYtCDA8E/4NaG+gCdHAH4TDUOy2JPXF4L3VOBiDpaB+aB0BAkEA8f1qIOWQv7EY
QNPdbMx9+/2miR/DoPtyyus1Nb+FTNzcZE0/JP8NLJUh7cBhtvRRi0RzhsOYMwK6
ypCUDZ4Q+QJBAPHHMzOiFlqIedrgZxiGUTZiGovMhBd3OKVYJj8Zr7BbM7TBkf9o
U3v0LgMhFV7DEt/JXcwlexKmudYufyyo9eECQBwh7OukJJ7UdNBckRpr752TEIBS
jAi0EtVaYNY9zL5x0sFqZZPkfuCW+dnNCs8dOjmpnJCnPpN3lsWj50JqBOkCQQDq
rh0v6AvkkoYdAyZu8qlPrUfxHHG2yT1NmNN++jLDbrMwp5dMH3qxXWFwHiO9GIJw
f+ewqUzd3MGTeQxuUA5hAkBkkA65Jwhg5DrL7GFLj7m3phyPED+Uk2pP7GJ5vIFf
QgM7yYJFHvKg/enuc2w2aAni+V8Z4DfwWeDlhPjcPyhb
-----END RSA PRIVATE KEY-----
*/</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-javascript line-numbers-mode" data-v-5a3e6e86><pre class="language-javascript" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86>// ✅ 安装依赖：npm install node-rsa</span>

<span class="token comment" data-v-5a3e6e86>// ❌ 密钥输出格式不支持 jwk、openssh</span>
<span class="token comment" data-v-5a3e6e86>// ❌ 不支持对私钥进行签名、加密</span>
<span class="token comment" data-v-5a3e6e86>// ❓ 注意：截止 2024.03，该库中公钥语法标准支持 pkcs8，但实际上不存在这种说法，具有争议，正确应该是 spki，参见：https://github.com/rzcoder/node-rsa/issues/208</span>

<span class="token keyword" data-v-5a3e6e86>var</span> NodeRSA <span class="token operator" data-v-5a3e6e86>=</span> <span class="token function" data-v-5a3e6e86>require</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;node-rsa&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>


<span class="token keyword" data-v-5a3e6e86>var</span> key <span class="token operator" data-v-5a3e6e86>=</span> <span class="token keyword" data-v-5a3e6e86>new</span> <span class="token class-name" data-v-5a3e6e86>NodeRSA</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>{</span>
    <span class="token literal-property property" data-v-5a3e6e86>b</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token number" data-v-5a3e6e86>1024</span><span class="token punctuation" data-v-5a3e6e86>,</span>  <span class="token comment" data-v-5a3e6e86>// 密钥位数，默认 2048，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位</span>
    <span class="token literal-property property" data-v-5a3e6e86>e</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token number" data-v-5a3e6e86>65537</span>  <span class="token comment" data-v-5a3e6e86>// 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数</span>
<span class="token punctuation" data-v-5a3e6e86>}</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>

<span class="token comment" data-v-5a3e6e86>// 生成密钥，传入参数格式：语法标准-密钥类型-输出格式，即 scheme-[key_type]-[output_type]</span>
<span class="token keyword" data-v-5a3e6e86>var</span> publicKey <span class="token operator" data-v-5a3e6e86>=</span> key<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>exportKey</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;pkcs1-public-pem&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>    <span class="token comment" data-v-5a3e6e86>// 公钥语法标准支持 pkcs1、pkcs8，输出格式支持 pem、der</span>
<span class="token keyword" data-v-5a3e6e86>var</span> privateKey <span class="token operator" data-v-5a3e6e86>=</span> key<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>exportKey</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;pkcs8-private-pem&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>  <span class="token comment" data-v-5a3e6e86>// 私钥语法标准支持 pkcs1、pkcs8，输出格式支持 pem、der</span>

console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 公钥（pkcs1、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> publicKey<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 私钥（pkcs8、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> privateKey<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>


<span class="token comment" data-v-5a3e6e86>/*
RSA 公钥（pkcs1、pem）：

 -----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALBIxnoOWWhdvAzaicfo5UB2DbSEa2u9LPQl0DrZSnQduRPs/EHh0EqC
QlBBJndqa0QuWAp5In/Q4Sjc2lcF7oB8MEzz1P+D/2M2vy1EunXD8XbMBDbyNAvg
k6yldcT3jEP1yhZjH9JnvgC9JsBFSjC9pUsZbhFDZwY6XLvw9oF7AgMBAAE=
-----END RSA PUBLIC KEY-----

RSA 私钥（pkcs8、pem）：

 -----BEGIN PRIVATE KEY-----
MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBALBIxnoOWWhdvAza
icfo5UB2DbSEa2u9LPQl0DrZSnQduRPs/EHh0EqCQlBBJndqa0QuWAp5In/Q4Sjc
2lcF7oB8MEzz1P+D/2M2vy1EunXD8XbMBDbyNAvgk6yldcT3jEP1yhZjH9JnvgC9
JsBFSjC9pUsZbhFDZwY6XLvw9oF7AgMBAAECgYEAgfs3NZpM/HJZDVU6UIf+OfiS
BG+7UTas5dzX2/yKNHISHIoaOm3JipbfVJOlTFnQe/Z7/kTxVjNrQhkOeSorf6Ee
Zg64JAMOxCb3aEJ6jABZUCK5DnBkcBv3qoPI6FrwrZNcTDypUGE6zxFfxehetGlQ
hyJ4xgddFNXg9oxoTKECQQDnpUujoYCSFITC+UDnMXCcV5LXk0wyicySL1+YeP8o
ymz3LYUTyR0p1JoMeXdg2VpQ3BVX4QDNRGv9mS79dI+xAkEAwtFv2U3egkUacdNv
vkWgMSVZc7YtlPdiW91wyVmAqxqFNBOVDOBXcuHcZ1o8mzPMgJVwSkjldvi73Ko5
s5C66wJBAMVikEVqRMg1O7t38NoPwsk1xiZzmSYnTW3zeB3QXHxBoQAuhYsKgBM4
2dtvVU3tZ4wnPPiY/bnrZ6m8cdH/FMECQAuhx6TY4mUyzQ5oym446ASnLz0aboRL
dQL5KMfM4ULWFYfzd13Kc043sBo3qBC4OgifY5H74j+FQGo/e6x+ArsCQQCtogcc
uKx8DHSON+lPQQfgD9A8vCtJVC7pyzzthMoUbmiGnv+VzbPkfuPaiamdVZy6j6qM
vuQJ+AB8c5SoY5rb
-----END PRIVATE KEY-----
*/</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-javascript line-numbers-mode" data-v-5a3e6e86><pre class="language-javascript" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86>// ✅ 安装依赖：npm install jsencrypt</span>

<span class="token comment" data-v-5a3e6e86>// ❗ 如果在 Node 环境中使用，会遇到报错 window is not defined，处理方法：</span>
<span class="token comment" data-v-5a3e6e86>//    1.在当前 JS 文件顶部添加代码：window = global;</span>
<span class="token comment" data-v-5a3e6e86>//    2.在 \node_modules\jsencrypt\bin\jsencrypt.js 添加代码：window = global;</span>
<span class="token comment" data-v-5a3e6e86>// ❌ 不支持对私钥进行签名、加密</span>
<span class="token comment" data-v-5a3e6e86>// ❌ 密钥输出格式不支持 der、jwk、openssh，仅支持 pem</span>
<span class="token comment" data-v-5a3e6e86>// ❌ 公钥语法标准不支持 pkcs1，仅支持 spki</span>
<span class="token comment" data-v-5a3e6e86>// ❌ 私钥语法标准不支持 pkcs8，仅支持 pkcs1</span>

<span class="token keyword" data-v-5a3e6e86>var</span> JSEncrypt <span class="token operator" data-v-5a3e6e86>=</span> <span class="token function" data-v-5a3e6e86>require</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>'jsencrypt'</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>


<span class="token keyword" data-v-5a3e6e86>var</span> crypt <span class="token operator" data-v-5a3e6e86>=</span> <span class="token keyword" data-v-5a3e6e86>new</span> <span class="token class-name" data-v-5a3e6e86>JSEncrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>{</span>
    <span class="token literal-property property" data-v-5a3e6e86>default_key_size</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token string" data-v-5a3e6e86>&quot;1024&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span>          <span class="token comment" data-v-5a3e6e86>// 密钥位数，默认 1024，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位</span>
    <span class="token literal-property property" data-v-5a3e6e86>default_public_exponent</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token string" data-v-5a3e6e86>&quot;010001&quot;</span>  <span class="token comment" data-v-5a3e6e86>// 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数</span>
<span class="token punctuation" data-v-5a3e6e86>}</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>

<span class="token keyword" data-v-5a3e6e86>var</span> publicKey <span class="token operator" data-v-5a3e6e86>=</span> crypt<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>getPublicKey</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>    <span class="token comment" data-v-5a3e6e86>// 公钥语法标准默认 spki，输出格式默认 pem</span>
<span class="token keyword" data-v-5a3e6e86>var</span> privateKey <span class="token operator" data-v-5a3e6e86>=</span> crypt<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>getPrivateKey</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>  <span class="token comment" data-v-5a3e6e86>// 私钥语法标准默认 pkcs1，输出格式默认 pem</span>

console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 公钥（spki、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> publicKey<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA 私钥（pkcs1、pem）：\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> privateKey<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>


<span class="token comment" data-v-5a3e6e86>/*
RSA 公钥（spki、pem）：

-----BEGIN PUBLIC KEY-----
MIGeMA0GCSqGSIb3DQEBAQUAA4GMADCBiAKBgGq2tRBEpDRG26JrXmBxxThGbufn
C2yw0biiXUf3BPzPx65TQ5vgiOoOnGYWl3wIhzlACPVWW4gto+nk2elcwin9flDb
vxtJCiBvEVqAaGb3ceiMe56xFnYs88PnDImzecguMCFmwhpbRpkLuvpF8fW4I2+M
aa3zON2rB5A2yMAxAgMBAAE=
-----END PUBLIC KEY-----
RSA 私钥（pkcs1、pem）：

-----BEGIN RSA PRIVATE KEY-----
MIICWgIBAAKBgGq2tRBEpDRG26JrXmBxxThGbufnC2yw0biiXUf3BPzPx65TQ5vg
iOoOnGYWl3wIhzlACPVWW4gto+nk2elcwin9flDbvxtJCiBvEVqAaGb3ceiMe56x
FnYs88PnDImzecguMCFmwhpbRpkLuvpF8fW4I2+Maa3zON2rB5A2yMAxAgMBAAEC
gYBd5OTrq3nPhYk7H72qnnApU8/BvEkRGYNuMW5iI7b/utK3UAvs22Ocjb6PFNG1
EMvqU62OMK3Y5E+VPQd/jV5I8C8n2BymrJ2MexCFow9jKneZYX5OLdRitJw+FAxL
8OnlLHs4nRlKiWJbdZ2Y/OnlYpAmHpStmAs+2loI/AWsAQJBALNOLJYCgZcm8yOO
cjnt+Q2gbPUWUfRha+x4oZ9jKFVk/xtYQ9GrWysYyi2IBfFkP362OrAdJHdCpjT+
6DhA/30CQQCYW8p0mRb0WtNmqLF+W7c+8CbPQ4+YeCnADzldNZkRshg/BgOMM41P
zVMqYFmlhHepIrno0uA6pNqrDi6Sx8nFAkBoviX1i4lATxSBlNjNVmLCvxBnK568
b5yoCt//R+Fr4Q/VXX5goQUk69pPNsKh/LnKv5ERCDUhJeIJ2060bePRAkAUSv2P
RCi7iTFpFgT2GI8ysdfpeU0x+KdO7ngsgwwNQFRcaJemX+NtgqKWHVkzY45wl7B9
Y0D8bqK1b+EiKbwlAkBB1wPeHe97FJ1QaleMhjDIWLjZZiX1UZYrDbaUbmLwhzmM
1pXmXbW1K0VxC9jcKpN7htwYvOmXuYdOsGHdG1MW
-----END RSA PRIVATE KEY-----
*/</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86></div></div></div> <pre class="pre-blank" data-v-392329f0>// Make sure to add code blocks to your code group</pre></div> <h3 id="golang"><a href="#golang" class="header-anchor">#</a> Golang <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>1.0+</span></h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// ✅ 无需安装依赖，官方文档：https://pkg.go.dev/crypto</span>
<span class="token comment">// ❌ 公钥指数不支持自定义，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数</span>
<span class="token comment">// ❌ 密钥输出格式不支持 jwk、openssh</span>
<span class="token comment">// ❌ 对私钥进行签名、加密，只支持 pkcs1 标准的私钥，不支持 pkcs8 标准的私钥</span>

<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;crypto/rand&quot;</span>
    <span class="token string">&quot;crypto/rsa&quot;</span>
    <span class="token string">&quot;crypto/x509&quot;</span>
    <span class="token string">&quot;encoding/pem&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rsaKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> rsa<span class="token punctuation">.</span><span class="token function">GenerateKey</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span>Reader<span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Generate key failed:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 私钥输出格式 der，私钥语法标准支持 pkcs1 (MarshalPKCS1PrivateKey)、pkcs8 (MarshalPKCS8PrivateKey)</span>
    privateKeyDER <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">MarshalPKCS1PrivateKey</span><span class="token punctuation">(</span>rsaKey<span class="token punctuation">)</span>
  
    <span class="token comment">// 可选操作：使用密码加密私钥，注意，EncryptPEMBlock 方法正在被弃用，该方法只能加密 pkcs1 标准的私钥</span>
    <span class="token comment">// blockType 参数指定密钥的标头，与私钥语法标准对应：pkcs1 加密对应 &quot;RSA PRIVATE KEY&quot;</span>
    <span class="token comment">// alg 参数指定加密算法，参见：https://pkg.go.dev/crypto/x509#PEMCipher</span>
    password <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">&quot;spiderapi&quot;</span><span class="token punctuation">)</span>
    encryptedPrivateKeyPEMBlock<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">EncryptPEMBlock</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span>Reader<span class="token punctuation">,</span> <span class="token string">&quot;RSA PRIVATE KEY&quot;</span><span class="token punctuation">,</span> privateKeyDER<span class="token punctuation">,</span> password<span class="token punctuation">,</span> x509<span class="token punctuation">.</span>PEMCipherAES256<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Private key encrypt failed:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    encryptedPrivateKeyPEM <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">EncodeToMemory</span><span class="token punctuation">(</span>encryptedPrivateKeyPEMBlock<span class="token punctuation">)</span>
  
    <span class="token comment">// 将私钥转为 pem 格式</span>
    <span class="token comment">// Type 参数指定密钥的标头，与私钥语法标准对应：pkcs1 对应 &quot;RSA PRIVATE KEY&quot;，pkcs8 对应 &quot;PRIVATE KEY&quot;</span>
    privateKeyPEM <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">EncodeToMemory</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pem<span class="token punctuation">.</span>Block<span class="token punctuation">{</span>
        Type<span class="token punctuation">:</span>  <span class="token string">&quot;RSA PRIVATE KEY&quot;</span><span class="token punctuation">,</span>
        Bytes<span class="token punctuation">:</span> privateKeyDER<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
    <span class="token comment">// 公钥输出格式 der，公钥语法标准支持 pkcs1 (MarshalPKCS1PublicKey)、spki (MarshalPKIXPublicKey)</span>
    publicKeyPEM<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">MarshalPKIXPublicKey</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rsaKey<span class="token punctuation">.</span>PublicKey<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Public key encoding failed:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">// 将公钥转为 pem 格式</span>
    <span class="token comment">// Type 参数指定密钥的标头，与公钥语法标准对应：pkcs1 对应 &quot;RSA PUBLIC KEY&quot;，spki 对应 &quot;PUBLIC KEY&quot;</span>
    publicKey <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">EncodeToMemory</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>pem<span class="token punctuation">.</span>Block<span class="token punctuation">{</span>
        Type<span class="token punctuation">:</span>  <span class="token string">&quot;PUBLIC KEY&quot;</span><span class="token punctuation">,</span>
        Bytes<span class="token punctuation">:</span> publicKeyPEM<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;RSA 公钥（spki、pem）：\n\n&quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>publicKey<span class="token punctuation">)</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;RSA 私钥（pkcs1、pem）：\n\n&quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>privateKeyPEM<span class="token punctuation">)</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;RSA 加密后的私钥（pkcs1、pem、aes-256-cbc）：\n\n&quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>encryptedPrivateKeyPEM<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
RSA 公钥（spki、pem）：

-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1P94ik8uUca0kq613hw0
dy0i/dALloDg4I32lkk7eWV/obe2I/qEY2Nz7SmmY8VZeJUfiQuAVuOxFYI7rKPM
4LvSvkKC5xcWho1319eyZKC1AYlXKHjQPrUXNrDwmM1racGw9NopFg/GyikhaZiT
vsW7NM3O3HN26irQXFO0C7vypIaZtOIB9YVA9YFpBLNnINczRyekltoZqhL4j/Of
C+VuXZOxL0wfJOML7axF4Fwt7XSir8BPJMoEc2KVFYxMMd06tfJMRzvHOEckOaob
ZLrZjHM4YzDr32ClpgCazx7QWsBiMo3AqMuNO+LBV/VynsZPymgehIiDRGr7+S0F
ywIDAQAB
-----END PUBLIC KEY-----

RSA 私钥（pkcs1、pem）：

-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEA1P94ik8uUca0kq613hw0dy0i/dALloDg4I32lkk7eWV/obe2
I/qEY2Nz7SmmY8VZeJUfiQuAVuOxFYI7rKPM4LvSvkKC5xcWho1319eyZKC1AYlX
KHjQPrUXNrDwmM1racGw9NopFg/GyikhaZiTvsW7NM3O3HN26irQXFO0C7vypIaZ
tOIB9YVA9YFpBLNnINczRyekltoZqhL4j/OfC+VuXZOxL0wfJOML7axF4Fwt7XSi
r8BPJMoEc2KVFYxMMd06tfJMRzvHOEckOaobZLrZjHM4YzDr32ClpgCazx7QWsBi
Mo3AqMuNO+LBV/VynsZPymgehIiDRGr7+S0FywIDAQABAoIBAQDSQhYFwkAhLZvX
KGwTg5gvBPmDv7mQqkxSnxEKLeRt48noI+fDAGtriSNIvFKqLogxxlNI/3eDTmTi
rJqnw1Jdjkts0U9TO7FaxY/GHADX4OSNTbwiEZDQNgdiT6xRyoX78d3y9uCUDKLZ
sVxwVtOSALLaX0eSytBaPEVOvrn+0Y06x/jiKhHvw1LCNc+E0lp3myrwW+6f0LCJ
KD4dc5AWop64psKwDXP2t8bcyK5uhLjZYiSKjSi+7y8kCNmN0LimYjbjt8nvHo1J
s24BbfE/MwrXhuV2/1ODBezPoOLBm51rzt9syHHnQBh95LPdLPr5N5r5uPvkToDu
X5eM5ughAoGBAPxvHiyoKjWTc2cYw2exsabp2OOkKHH5BP8VBErEvTzmbzr9mKFR
PG0ZcxLnSPux9xaoExdNd+NPnVWl5sR3ZLezGLSaeZw5RagTlkQ/YOXZ6b7mWZcE
hpZNlvSyG3dIP63N4ONwTCpRrjyndv/sSGARrHsp4I1mv+23cQaQfvADAoGBANgB
vUh8Uekq6SuJ2MmvX63cq5kK6BejWfEk6xFlHOTE49yzorn8yJoy1dBoO5BN1VcZ
NUPSNt7PP0HR0BAgX5pKun/dAIs9+Y4HJPojeLkkhFgjx0FxQrQ2usIAaqAwZlpC
rzClr7/8ZO5jeZMdfxcqE43KNrWOWGleyYQnr9yZAoGAcMPCmvhUQrKnrrplMAE0
9vcnqClA2AkBrmFZFX1le7sEnTmD4SxE7gecXCltdOI/GqPiQ1qb37NE+Wmu+LzN
BTLAKo2HHb6H21lEmyAkzQjXXivQgaHH7YSjlpOpqVNg/uclOvSDUbRDPV0hz5lh
i2jZv/spEIGB41M67k/GJLkCgYAzRZZsUjYPJoRaNUoj9WC8oBiLJy+YDMoYly7E
3j9RffqoNGt3wizLjS17XoJk6lSta+pcwtULZh4ZvXepnEWVFg/WsdqjMn6926xH
Q4wwRh6z3So6umue4y7JRdgJVfO1kQaMgYeKBpreivYcmW/FS9OAYHND/Rm3SSyE
FfeEYQKBgAVICBeE9LrMzoPwaTiGcRwEbx13Mo2SgzrKiwSY960Ewlu5t17197e0
EEqJ1Y+ItIA+4j9XEMu6e1hV56Zy9rNEOyUZSB83tB1TQTzasbTDLfh0vJZmbudF
6VTo4nST7kLzJYJe4A1SF2gLKasrbBL0Ye22PK2AuwHIWca2e+OS
-----END RSA PRIVATE KEY-----

RSA 加密后的私钥（pkcs1、pem、aes-256-cbc）：

-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-256-CBC,3a42d48c94f2f06b0354a04de8247917

6rr+ZAQXJXS3zv9gZUbSp+Ft1ngcjshRrlKYcbeXaBPbWwfwE0iwG47aSJIpAvR1
ac2NhCTyq8ATqbjrhdf4dSHGYwpLJZzdQ7X+g3FmvJpLJMglaLhM2ls+IN+ofOS+
Bp9DwCSvdvTQEocHqTImXS98Bb6pr49FdJmQMma8pm2U73fIro8apVTDwQD/iHIB
nEQ6+ZvUIqp+spEifYle0d1q1ADU/ZavqMt21bDhz56Ccf++6unXk+BhYVGj1WX0
LYmZS8yRVHWDPk19i8yOCeMfZSS929JhCIsRVWYomxSVdwQP6h2iG4tU2+5mvDo1
Pbr4BrLKjFCO3ixhbjmW+ySNoNB/dNkkNd4eaBvmUoC1A/sNz3rJQR2Kl5r9kOCi
iVzh7hpPHTGmW9GY3PBYsIIE84HwrMpmcHHX/qWg/P5B/qAqOXQb4n8UozwuICdn
w/i8c/k6YwOndYkIUqJjUg4KmWTdAQkyaCceBi/i4p9XgWZvq7MKQSQw0K9SeBoz
Q7zUmJjFBtaLN/N3ckyuTeWQOZtGlVjK/rZKFy99RsMum//HX+S8XciUgs2p8A0f
HMrIpgFg3XQSW5el4ykNdS216hEmMtUWfrGhn5D4UEDIHMRF5j9abR2T2BhKbh8m
KcagOdBRRdKBH8JU8l3NT+tSYI+DpbMFH7X1QwfZNVlChAZblipOT9PpW4LbuZhv
nIDU7KjodaV1JrRSOs/+9ferPKxkCXsGj3n5W/9wfbwUnChhhuYXvBVbNd48Os9m
j5jQFVdcxQNe4UyYa7L3KaEzbp9GwX6MsUbiATH7jqEqfero50oTEznWKh4GQtrZ
UL5QhESMEb+3X+JC1nu3aFzbvm+Y0dRjj5bi/R4wk1CAMIOWyT/iYSz+Oe9CNsVA
gKQ5pjY4fwrLjwXVDsm52sQT99V6fVWbUXmg1iNrZ3hbLZ7sGZ0iK6ecz+x4zzMG
m7/7Lbdb0wwGD+K5RPtDmmR9PvwCbxdfQGy8sLyUnUIB1btLRyTnPTXseuIZyFLu
BKWTeLWhqya2h7B9iDYxQq1ySKAJaD8n6Rp+plUqJiyaO/RYcJRwun/U/GVuSfct
YT1BytgfGqM6GL0S+RzFuaG7EYgg8vRuKwHw9rjdaIIz//cL/Y8YCJhJIhmVd7GJ
NE5f+DXPvhhMf/12CF/rcGy6VVGnhlCHN+6dHWeodcbQVbuMJaznasqTk8NuWV75
fZ70FmdHlJHHzTmZ/bQe6qp/1IKLYxa5v8lZEG9ER2hQ2uSjOzLt0nRc8K/HX7xA
Fi+8mRxjsOok75QKfJHNyCXL33hxDclnGbqANUp8bE45h1F3RWnQ60QYc6/EVE9Y
FOKqqOMrTjcIebJN4zYNUDT1OClB6VdyaJLmPtzIYDE07qwWoHdGWVQmrofR/hzL
5+c3LY2AtxQvIyWJc7BmP6lp46KmoUcc9BLkydi5bp9XDM2OgZGjHN9pkdhqdyNH
3zkUzf5dimvaPLHHlKtz1MNF7LTkPRJX94ATq1PDhsgX9OX0lvI10lb+MCI483Mq
IOIIMVT9256lXj+b+q+AhxkhSg4vMLmv28/O8+QZehwcqM1CeA4qzafLGziA/6tl
-----END RSA PRIVATE KEY-----
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br></div></div><h2 id="解析密钥"><a href="#解析密钥" class="header-anchor">#</a> 解析密钥</h2> <details class="custom-block details"><summary>关于解析 RSA 密钥</summary> <p>PKCS1 RSA 公钥和私钥格式的 <a href="https://www.rfc-editor.org/rfc/rfc3447#appendix-C" target="_blank" rel="noopener noreferrer">ASN.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 规范如下：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>RSAPublicKey ::= SEQUENCE {
    modulus           INTEGER,  -- n
    publicExponent    INTEGER   -- e
}

RSAPrivateKey ::= SEQUENCE {
    version           Version,
    modulus           INTEGER,  -- n
    publicExponent    INTEGER,  -- e
    privateExponent   INTEGER,  -- d
    prime1            INTEGER,  -- p
    prime2            INTEGER,  -- q
    exponent1         INTEGER,  -- d mod (p-1)
    exponent2         INTEGER,  -- d mod (q-1)
    coefficient       INTEGER,  -- (inverse of q) mod p
    otherPrimeInfos   OtherPrimeInfos OPTIONAL
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>为了提高效率，许多流行的加密库都使用基于中国剩余定理（CRT）来优化加速解密和签名，所以 prime1、prime2 等值已预先计算并存储为私钥的一部分，如果给定一对 RSA 密钥，那么我们就可以从中解析出以下信息：</p> <ul><li><mark><strong>keySize</strong></mark>：密钥的位数，即模数（modulus）的位数</li> <li><mark><strong>modulus</strong></mark>：模数 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="N"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo space="3" class="mjx-n"><mjx-c c="D7"></mjx-c></mjx-mo><mjx-mi space="3" class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-math></mjx-container>，一个大素数的乘积，用于生成公钥和私钥，参见前面生成密钥中对模数的解释</li> <li><mark><strong>publicExponent</strong></mark>：公钥指数 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="e"></mjx-c></mjx-mi></mjx-math></mjx-container>，参见前面生成密钥中对公钥指数的解释</li> <li><mark><strong>privateExponent</strong></mark>：私钥指数 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi></mjx-math></mjx-container>，参见前面生成密钥中对私钥指数的解释</li> <li><mark><strong>prime1</strong></mark>：RSA 算法中的第一个质数 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi></mjx-math></mjx-container>，用于生成私钥</li> <li><mark><strong>prime2</strong></mark>：RSA 算法中的第二个质数 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi></mjx-math></mjx-container>，用于生成私钥</li> <li><mark><strong>exponent1</strong></mark>：私钥指数模 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn space="3" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-math></mjx-container> 的模反元素，即 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="m"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="d"></mjx-c></mjx-mo><mjx-TeXAtom space="4"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn space="3" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-math></mjx-container></li> <li><mark><strong>exponent2</strong></mark>：私钥指数模 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn space="3" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-math></mjx-container> 的模反元素，即 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="m"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="d"></mjx-c></mjx-mo><mjx-TeXAtom space="4"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn space="3" class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-TeXAtom></mjx-math></mjx-container></li> <li><mark><strong>coefficient</strong></mark>：模反元素之间的系数，即 <mjx-container jax="CHTML" class="MathJax"><mjx-math class="MJX-TEX"><mjx-msup><mjx-mi class="mjx-i"><mjx-c c="q"></mjx-c></mjx-mi><mjx-script style="vertical-align:0.363em;"><mjx-mo size="s" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo></mjx-script></mjx-msup><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn><mjx-mo space="4" class="mjx-n"><mjx-c c="m"></mjx-c><mjx-c c="o"></mjx-c><mjx-c c="d"></mjx-c></mjx-mo><mjx-mi space="4" class="mjx-i"><mjx-c c="p"></mjx-c></mjx-mi></mjx-math></mjx-container></li></ul> <hr> <div class="custom-block right"><p>【实用参考资料】</p> <p>公钥加密标准 PKCS#1 rfc3447：<a href="https://www.rfc-editor.org/rfc/rfc3447" target="_blank" rel="noopener noreferrer">https://www.rfc-editor.org/rfc/rfc3447<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
使用中国剩余定理（CRT）来加速 RSA 算法的计算：<a href="https://www.di-mgt.com.au/crt_rsa.html" target="_blank" rel="noopener noreferrer">https://www.di-mgt.com.au/crt_rsa.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
维基百科 Using the Chinese remainder algorithm：<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Padding_schemes" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Padding_schemes<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></details> <h3 id="python-2"><a href="#python-2" class="header-anchor">#</a> Python <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>3.0+</span></h3> <br> <div class="theme-code-group" data-v-392329f0><div class="theme-code-group__nav" data-v-392329f0><ul class="theme-code-group__ul" data-v-392329f0></ul></div> <div class="theme-code-block theme-code-block__active" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install pycryptodome，官方文档：https://pycryptodome.readthedocs.io/</span>

<span class="token keyword" data-v-5a3e6e86>from</span> Crypto<span class="token punctuation" data-v-5a3e6e86>.</span>PublicKey <span class="token keyword" data-v-5a3e6e86>import</span> RSA


<span class="token comment" data-v-5a3e6e86># 注意 &quot;&quot;&quot; 之后要紧跟着密钥标头，如果换行可能会因为无法解析导致报错：ValueError: RSA key format is not supported</span>
<span class="token comment" data-v-5a3e6e86># spki 标准 pem 格式的公钥</span>
public_key_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCl7HWuXcOH9I/Bud7dplYxHOEC
D82fJv1WJKADhmILCxDLJLVkueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5
jrHT8zw8InrNRwlDeCyx/Q+ETpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faN
w6cBVKhFn+fuItSGfQIDAQAB
-----END PUBLIC KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的私钥</span>
private_key_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----
MIICXgIBAAKBgQCl7HWuXcOH9I/Bud7dplYxHOECD82fJv1WJKADhmILCxDLJLVk
ueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5jrHT8zw8InrNRwlDeCyx/Q+E
TpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faNw6cBVKhFn+fuItSGfQIDAQAB
AoGBAKSmc1kmfoQJciZh1gDJsTpnV/l9ySQnwrma+pbE4cHnpzCPKtnbgfcfNNWh
CJljGupfyvzbs1SZkCUL/B1yBR3uAbWw5G0uzJo61wYciufnQA1/lu3JyEyLeSxb
eFOIkuI8Ce0SCPT01+6sR77EA0VtUA+0Ak7OI4EvElFPn0qBAkEA8SvKXG6suLFL
9TjUH2B1XDwMxQFw7JOOhAyLcbNJMLgqMhHuqvTW/T4oxTQh7LbDMP977ZDnkmdt
L8S7zAHHsQJBALAgOFkbNNH4FzBQtxyWEu6+D0ZhvhIAIoH0pDBdoIO9vKalRgWy
vV6YsI3NujjBjz1p7g3Zb/zliA3vH9ieqo0CQQCdlOVmvBIzo/Vjx7wivF4y5DHb
z/M/QbMPaTr8Eg+yu8MmcD0oi06mriTppgS8rTahH26UbehB6z6Wxc+Hn2ohAkEA
r2GmOrToyBzvmmEFtiWK/MmtlDxIdMxFkHr39GGHMSiC7r6tF4eBIu2RAePWiCXW
aSVOs+PNrFs0PAvd/mshEQJAYpxilxZI7hJT89Qne6CgPXqqZf0sFX0FeR9AJaj1
g2c+B9GgZ+Nou4ne4WXjOVUWZuuch7yqn3XoxeQT4/xaCw==
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># 解析公钥和私钥</span>
public_key <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>importKey<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pem<span class="token punctuation" data-v-5a3e6e86>)</span>
private_key <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>importKey<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pem<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token comment" data-v-5a3e6e86># 获取模数（modulus），使用 16 进制字符串表示，从公钥和私钥中均可获取，且值是一样的</span>
modulus <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>public_key<span class="token punctuation" data-v-5a3e6e86>.</span>n<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>  <span class="token comment" data-v-5a3e6e86># 或者 private_key.n</span>

<span class="token comment" data-v-5a3e6e86># 计算密钥的位数，即模数（modulus）的位数，16 进制转换为位数时每个字符代表 4 位</span>
key_length <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>len</span><span class="token punctuation" data-v-5a3e6e86>(</span>modulus<span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token operator" data-v-5a3e6e86>*</span> <span class="token number" data-v-5a3e6e86>4</span>

<span class="token comment" data-v-5a3e6e86># 获取公钥指数</span>
public_exponent <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>public_key<span class="token punctuation" data-v-5a3e6e86>.</span>e<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>

<span class="token comment" data-v-5a3e6e86># 获取私钥指数</span>
private_exponent <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>d<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>

<span class="token comment" data-v-5a3e6e86># 获取私钥其他参数</span>
private_prime1 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>p<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_prime2 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>q<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_exponent1 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>d <span class="token operator" data-v-5a3e6e86>%</span> <span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>p <span class="token operator" data-v-5a3e6e86>-</span> <span class="token number" data-v-5a3e6e86>1</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_exponent2 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>d <span class="token operator" data-v-5a3e6e86>%</span> <span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>q <span class="token operator" data-v-5a3e6e86>-</span> <span class="token number" data-v-5a3e6e86>1</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_coefficient <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token builtin" data-v-5a3e6e86>pow</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>q<span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token operator" data-v-5a3e6e86>-</span><span class="token number" data-v-5a3e6e86>1</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>p<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）模数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> modulus<span class="token punctuation" data-v-5a3e6e86>)</span>                          <span class="token comment" data-v-5a3e6e86># a5ec75ae5dc387f48fc1b9dedda656311ce1020fcd9f26fd5624a00386620b0b10cb24b564b9e0507f0508b4f10b17744b86cfb7f973587c68b3ecf3cf871575a5ecb98eb1d3f33c3c227acd470943782cb1fd0f844e94a94089af20b7f44411ed9ce815a5be35ba1285db8c061f8abbf9f68dc3a70154a8459fe7ee22d4867d</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）密钥 &amp; 模数位数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> key_length<span class="token punctuation" data-v-5a3e6e86>)</span>             <span class="token comment" data-v-5a3e6e86># 1024</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）公钥指数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> public_exponent<span class="token punctuation" data-v-5a3e6e86>)</span>               <span class="token comment" data-v-5a3e6e86># 0x10001 (65537)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥指数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_exponent<span class="token punctuation" data-v-5a3e6e86>)</span>              <span class="token comment" data-v-5a3e6e86># a4a67359267e8409722661d600c9b13a6757f97dc92427c2b99afa96c4e1c1e7a7308f2ad9db81f71f34d5a10899631aea5fcafcdbb3549990250bfc1d72051dee01b5b0e46d2ecc9a3ad7061c8ae7e7400d7f96edc9c84c8b792c5b78538892e23c09ed1208f4f4d7eeac47bec403456d500fb4024ece23812f12514f9f4a81</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 prime1: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_prime1<span class="token punctuation" data-v-5a3e6e86>)</span>            <span class="token comment" data-v-5a3e6e86># f12bca5c6eacb8b14bf538d41f60755c3c0cc50170ec938e840c8b71b34930b82a3211eeaaf4d6fd3e28c53421ecb6c330ff7bed90e792676d2fc4bbcc01c7b1</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 prime2: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_prime2<span class="token punctuation" data-v-5a3e6e86>)</span>            <span class="token comment" data-v-5a3e6e86># b02038591b34d1f8173050b71c9612eebe0f4661be12002281f4a4305da083bdbca6a54605b2bd5e98b08dcdba38c18f3d69ee0dd96ffce5880def1fd89eaa8d</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 exponent1: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_exponent1<span class="token punctuation" data-v-5a3e6e86>)</span>      <span class="token comment" data-v-5a3e6e86># 9d94e566bc1233a3f563c7bc22bc5e32e431dbcff33f41b30f693afc120fb2bbc326703d288b4ea6ae24e9a604bcad36a11f6e946de841eb3e96c5cf879f6a21</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 exponent2: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_exponent2<span class="token punctuation" data-v-5a3e6e86>)</span>      <span class="token comment" data-v-5a3e6e86># af61a63ab4e8c81cef9a6105b6258afcc9ad943c4874cc45907af7f46187312882eebead17878122ed9101e3d68825d669254eb3e3cdac5b343c0bddfe6b2111</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 coefficient: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_coefficient<span class="token punctuation" data-v-5a3e6e86>)</span>  <span class="token comment" data-v-5a3e6e86># 629c62971648ee1253f3d4277ba0a03d7aaa65fd2c157d05791f4025a8f583673e07d1a067e368bb89dee165e339551666eb9c87bcaa9f75e8c5e413e3fc5a0b</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>62</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>63</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>64</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>65</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install cryptography，要求 Python 3.7+，官方文档：https:#cryptography.io/</span>

<span class="token keyword" data-v-5a3e6e86>from</span> cryptography<span class="token punctuation" data-v-5a3e6e86>.</span>hazmat<span class="token punctuation" data-v-5a3e6e86>.</span>primitives <span class="token keyword" data-v-5a3e6e86>import</span> serialization


<span class="token comment" data-v-5a3e6e86># spki 标准 pem 格式的公钥</span>
public_key_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCl7HWuXcOH9I/Bud7dplYxHOEC
D82fJv1WJKADhmILCxDLJLVkueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5
jrHT8zw8InrNRwlDeCyx/Q+ETpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faN
w6cBVKhFn+fuItSGfQIDAQAB
-----END PUBLIC KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的私钥</span>
private_key_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
-----BEGIN RSA PRIVATE KEY-----
MIICXgIBAAKBgQCl7HWuXcOH9I/Bud7dplYxHOECD82fJv1WJKADhmILCxDLJLVk
ueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5jrHT8zw8InrNRwlDeCyx/Q+E
TpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faNw6cBVKhFn+fuItSGfQIDAQAB
AoGBAKSmc1kmfoQJciZh1gDJsTpnV/l9ySQnwrma+pbE4cHnpzCPKtnbgfcfNNWh
CJljGupfyvzbs1SZkCUL/B1yBR3uAbWw5G0uzJo61wYciufnQA1/lu3JyEyLeSxb
eFOIkuI8Ce0SCPT01+6sR77EA0VtUA+0Ak7OI4EvElFPn0qBAkEA8SvKXG6suLFL
9TjUH2B1XDwMxQFw7JOOhAyLcbNJMLgqMhHuqvTW/T4oxTQh7LbDMP977ZDnkmdt
L8S7zAHHsQJBALAgOFkbNNH4FzBQtxyWEu6+D0ZhvhIAIoH0pDBdoIO9vKalRgWy
vV6YsI3NujjBjz1p7g3Zb/zliA3vH9ieqo0CQQCdlOVmvBIzo/Vjx7wivF4y5DHb
z/M/QbMPaTr8Eg+yu8MmcD0oi06mriTppgS8rTahH26UbehB6z6Wxc+Hn2ohAkEA
r2GmOrToyBzvmmEFtiWK/MmtlDxIdMxFkHr39GGHMSiC7r6tF4eBIu2RAePWiCXW
aSVOs+PNrFs0PAvd/mshEQJAYpxilxZI7hJT89Qne6CgPXqqZf0sFX0FeR9AJaj1
g2c+B9GgZ+Nou4ne4WXjOVUWZuuch7yqn3XoxeQT4/xaCw==
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># 解析公钥和私钥</span>
public_key <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>load_pem_public_key<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pem<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
private_key <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>load_pem_private_key<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pem<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> password<span class="token operator" data-v-5a3e6e86>=</span><span class="token boolean" data-v-5a3e6e86>None</span><span class="token punctuation" data-v-5a3e6e86>)</span>

public_numbers <span class="token operator" data-v-5a3e6e86>=</span> public_key<span class="token punctuation" data-v-5a3e6e86>.</span>public_numbers<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>
private_numbers <span class="token operator" data-v-5a3e6e86>=</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>private_numbers<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token comment" data-v-5a3e6e86># 获取模数（modulus），使用 16 进制字符串表示，从公钥和私钥中均可获取，且值是一样的</span>
modulus <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>public_numbers<span class="token punctuation" data-v-5a3e6e86>.</span>n<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>  <span class="token comment" data-v-5a3e6e86># 或者 private_numbers.public_numbers.n</span>

<span class="token comment" data-v-5a3e6e86># 计算密钥的位数，即模数（modulus）的位数，16 进制转换为位数时每个字符代表 4 位</span>
key_length <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>len</span><span class="token punctuation" data-v-5a3e6e86>(</span>modulus<span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token operator" data-v-5a3e6e86>*</span> <span class="token number" data-v-5a3e6e86>4</span>

<span class="token comment" data-v-5a3e6e86># 获取公钥指数</span>
public_exponent <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>public_numbers<span class="token punctuation" data-v-5a3e6e86>.</span>e<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>

<span class="token comment" data-v-5a3e6e86># 获取私钥指数</span>
private_exponent <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_numbers<span class="token punctuation" data-v-5a3e6e86>.</span>d<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>

<span class="token comment" data-v-5a3e6e86># 获取私钥其他参数</span>
private_prime1 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_numbers<span class="token punctuation" data-v-5a3e6e86>.</span>p<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_prime2 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_numbers<span class="token punctuation" data-v-5a3e6e86>.</span>q<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_exponent1 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_numbers<span class="token punctuation" data-v-5a3e6e86>.</span>dmp1<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_exponent2 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_numbers<span class="token punctuation" data-v-5a3e6e86>.</span>dmq1<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_coefficient <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_numbers<span class="token punctuation" data-v-5a3e6e86>.</span>iqmp<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）模数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> modulus<span class="token punctuation" data-v-5a3e6e86>)</span>                          <span class="token comment" data-v-5a3e6e86># a5ec75ae5dc387f48fc1b9dedda656311ce1020fcd9f26fd5624a00386620b0b10cb24b564b9e0507f0508b4f10b17744b86cfb7f973587c68b3ecf3cf871575a5ecb98eb1d3f33c3c227acd470943782cb1fd0f844e94a94089af20b7f44411ed9ce815a5be35ba1285db8c061f8abbf9f68dc3a70154a8459fe7ee22d4867d</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）密钥 &amp; 模数位数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> key_length<span class="token punctuation" data-v-5a3e6e86>)</span>             <span class="token comment" data-v-5a3e6e86># 1024</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）公钥指数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> public_exponent<span class="token punctuation" data-v-5a3e6e86>)</span>               <span class="token comment" data-v-5a3e6e86># 0x10001 (65537)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥指数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_exponent<span class="token punctuation" data-v-5a3e6e86>)</span>              <span class="token comment" data-v-5a3e6e86># a4a67359267e8409722661d600c9b13a6757f97dc92427c2b99afa96c4e1c1e7a7308f2ad9db81f71f34d5a10899631aea5fcafcdbb3549990250bfc1d72051dee01b5b0e46d2ecc9a3ad7061c8ae7e7400d7f96edc9c84c8b792c5b78538892e23c09ed1208f4f4d7eeac47bec403456d500fb4024ece23812f12514f9f4a81</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 prime1: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_prime1<span class="token punctuation" data-v-5a3e6e86>)</span>            <span class="token comment" data-v-5a3e6e86># f12bca5c6eacb8b14bf538d41f60755c3c0cc50170ec938e840c8b71b34930b82a3211eeaaf4d6fd3e28c53421ecb6c330ff7bed90e792676d2fc4bbcc01c7b1</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 prime2: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_prime2<span class="token punctuation" data-v-5a3e6e86>)</span>            <span class="token comment" data-v-5a3e6e86># b02038591b34d1f8173050b71c9612eebe0f4661be12002281f4a4305da083bdbca6a54605b2bd5e98b08dcdba38c18f3d69ee0dd96ffce5880def1fd89eaa8d</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 exponent1: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_exponent1<span class="token punctuation" data-v-5a3e6e86>)</span>      <span class="token comment" data-v-5a3e6e86># 9d94e566bc1233a3f563c7bc22bc5e32e431dbcff33f41b30f693afc120fb2bbc326703d288b4ea6ae24e9a604bcad36a11f6e946de841eb3e96c5cf879f6a21</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 exponent2: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_exponent2<span class="token punctuation" data-v-5a3e6e86>)</span>      <span class="token comment" data-v-5a3e6e86># af61a63ab4e8c81cef9a6105b6258afcc9ad943c4874cc45907af7f46187312882eebead17878122ed9101e3d68825d669254eb3e3cdac5b343c0bddfe6b2111</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 coefficient: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_coefficient<span class="token punctuation" data-v-5a3e6e86>)</span>  <span class="token comment" data-v-5a3e6e86># 629c62971648ee1253f3d4277ba0a03d7aaa65fd2c157d05791f4025a8f583673e07d1a067e368bb89dee165e339551666eb9c87bcaa9f75e8c5e413e3fc5a0b</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>62</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>63</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>64</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>65</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>66</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>67</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>68</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>69</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install rsa，官方文档：https://stuvel.eu/python-rsa-doc/</span>

<span class="token comment" data-v-5a3e6e86># ❌ 不支持解析 spki 语法标准的公钥，只支持 pkcs1</span>
<span class="token comment" data-v-5a3e6e86># ❌ 不支持解析 pkcs8 语法标准的私钥，只支持 pkcs1</span>

<span class="token keyword" data-v-5a3e6e86>import</span> rsa


<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的公钥</span>
public_key_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的私钥</span>
private_key_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># 解析公钥和私钥</span>
public_key <span class="token operator" data-v-5a3e6e86>=</span> rsa<span class="token punctuation" data-v-5a3e6e86>.</span>PublicKey<span class="token punctuation" data-v-5a3e6e86>.</span>load_pkcs1<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pem<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token string" data-v-5a3e6e86>'PEM'</span><span class="token punctuation" data-v-5a3e6e86>)</span>
private_key <span class="token operator" data-v-5a3e6e86>=</span> rsa<span class="token punctuation" data-v-5a3e6e86>.</span>PrivateKey<span class="token punctuation" data-v-5a3e6e86>.</span>load_pkcs1<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pem<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token string" data-v-5a3e6e86>'PEM'</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token comment" data-v-5a3e6e86># 获取模数（modulus），使用 16 进制字符串表示，从公钥和私钥中均可获取，且值是一样的</span>
modulus <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>public_key<span class="token punctuation" data-v-5a3e6e86>.</span>n<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>  <span class="token comment" data-v-5a3e6e86># 或者 private_key.n</span>

<span class="token comment" data-v-5a3e6e86># 计算密钥的位数，即模数（modulus）的位数，16 进制转换为位数时每个字符代表 4 位</span>
key_length <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>len</span><span class="token punctuation" data-v-5a3e6e86>(</span>modulus<span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token operator" data-v-5a3e6e86>*</span> <span class="token number" data-v-5a3e6e86>4</span>

<span class="token comment" data-v-5a3e6e86># 获取公钥指数</span>
public_exponent <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>public_key<span class="token punctuation" data-v-5a3e6e86>.</span>e<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>

<span class="token comment" data-v-5a3e6e86># 获取私钥指数</span>
private_exponent <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>d<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>

<span class="token comment" data-v-5a3e6e86># 获取私钥其他参数</span>
private_prime1 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>p<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_prime2 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>q<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_exponent1 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>d <span class="token operator" data-v-5a3e6e86>%</span> <span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>p <span class="token operator" data-v-5a3e6e86>-</span> <span class="token number" data-v-5a3e6e86>1</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_exponent2 <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>d <span class="token operator" data-v-5a3e6e86>%</span> <span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>q <span class="token operator" data-v-5a3e6e86>-</span> <span class="token number" data-v-5a3e6e86>1</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>
private_coefficient <span class="token operator" data-v-5a3e6e86>=</span> <span class="token builtin" data-v-5a3e6e86>hex</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token builtin" data-v-5a3e6e86>pow</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>.</span>q<span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token operator" data-v-5a3e6e86>-</span><span class="token number" data-v-5a3e6e86>1</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>p<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>[</span><span class="token number" data-v-5a3e6e86>2</span><span class="token punctuation" data-v-5a3e6e86>:</span><span class="token punctuation" data-v-5a3e6e86>]</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）模数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> modulus<span class="token punctuation" data-v-5a3e6e86>)</span>                          <span class="token comment" data-v-5a3e6e86># b2c0fda504952c6abcf527942e00f1468d87ab71cab8e52ec856e3fc148166480416efa7bc958f83a20b999b6dbcaf3aa12540d86469e57c105dab66acbd9b9c21b3e8c8c75b5477224f2572f264236bdd0f2de2c4327a4eaad7e8a637a2941081eb2ef7ae62ad4bbe6c3796de76bd1cef5b0b9c615d041d26f1dc6d1bea112b</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）密钥 &amp; 模数位数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> key_length<span class="token punctuation" data-v-5a3e6e86>)</span>             <span class="token comment" data-v-5a3e6e86># 1024</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）公钥指数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> public_exponent<span class="token punctuation" data-v-5a3e6e86>)</span>               <span class="token comment" data-v-5a3e6e86># 0x10001 (65537)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥指数: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_exponent<span class="token punctuation" data-v-5a3e6e86>)</span>              <span class="token comment" data-v-5a3e6e86># ceae569876b404a765d40fef4541d1b7c1ed1c4e761752e6c4bdb2ddc4d7d96b6b4f19cad84215ae1daf4bec6af5bfa60aad084d2bcd458a2d6220cbc19f391521a921498bc2dbde32c84646f9f609717b995b3a05d3e614ae514fd1bbc6e493a90dc50de181beb46f76e006e1c8f2f4009917d0110495259a16156d9d3c401</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 prime1: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_prime1<span class="token punctuation" data-v-5a3e6e86>)</span>            <span class="token comment" data-v-5a3e6e86># b87cc2c8cc4da10aaf45526479f580d21dab0f5150d6baad1e5c6f8fff42a9f71e595038d97288dc061a6c24141bc7d3f8ca0ca2623e2e530dce480f17fdf647c6a9a0fd</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 prime2: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_prime2<span class="token punctuation" data-v-5a3e6e86>)</span>            <span class="token comment" data-v-5a3e6e86># f80b479533e5579a8f53e0ba1928281df7f383e7aeb2a8143fb081ce87ed089bf5a286293d31e5d2acc1979fc84fcf17e422ee131688ed7c14ad8747</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 exponent1: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_exponent1<span class="token punctuation" data-v-5a3e6e86>)</span>      <span class="token comment" data-v-5a3e6e86># 6ff790444bf2855db5b84de41b3ccbdd3a125aae90707245a55a967eff7e17279aecbbca74f695676bf0d7572239261359384f68b25568ca1163f3c9ed56be051be65185</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 exponent2: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_exponent2<span class="token punctuation" data-v-5a3e6e86>)</span>      <span class="token comment" data-v-5a3e6e86># 8ed3a7e761179947156ade072abf35c273e913b60fa12e2962b71737be8b1d9ef8651a4d9ac025af16ecee8b0203faa2ae29f2dea8e635a17222adb7</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;（16 进制）私钥 coefficient: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_coefficient<span class="token punctuation" data-v-5a3e6e86>)</span>  <span class="token comment" data-v-5a3e6e86># 6b46e0fb2928b01030eea323b6c551ce627fd50aa3a4c67aedfd137aadbf88d6356eaa39b3c127d47582eacca8f513f60eb7d318d9759c73e9a73d67b15f823a4c57415e</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>62</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>63</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>64</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>65</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>66</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>67</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>68</span><br data-v-5a3e6e86></div></div></div> <pre class="pre-blank" data-v-392329f0>// Make sure to add code blocks to your code group</pre></div> <h3 id="javascript-2"><a href="#javascript-2" class="header-anchor">#</a> JavaScript <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>Node.js</span> <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>ECMAScript 5.1+</span></h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ✅ 安装依赖：npm install node-forge，官方文档：https://github.com/digitalbazaar/forge</span>

<span class="token comment">// ❌ 不支持解析私钥的 prime1、prime2、exponent1、exponent2、coefficient 参数</span>

<span class="token keyword">var</span> forge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;node-forge&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// spki 标准 pem 格式的公钥</span>
<span class="token keyword">var</span> publicKeyPEM <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCl7HWuXcOH9I/Bud7dplYxHOEC
D82fJv1WJKADhmILCxDLJLVkueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5
jrHT8zw8InrNRwlDeCyx/Q+ETpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faN
w6cBVKhFn+fuItSGfQIDAQAB
-----END PUBLIC KEY-----
</span><span class="token template-punctuation string">`</span></span>

<span class="token comment">// pkcs1 标准 pem 格式的私钥</span>
<span class="token keyword">var</span> privateKeyPEM <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
-----BEGIN RSA PRIVATE KEY-----
MIICXgIBAAKBgQCl7HWuXcOH9I/Bud7dplYxHOECD82fJv1WJKADhmILCxDLJLVk
ueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5jrHT8zw8InrNRwlDeCyx/Q+E
TpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faNw6cBVKhFn+fuItSGfQIDAQAB
AoGBAKSmc1kmfoQJciZh1gDJsTpnV/l9ySQnwrma+pbE4cHnpzCPKtnbgfcfNNWh
CJljGupfyvzbs1SZkCUL/B1yBR3uAbWw5G0uzJo61wYciufnQA1/lu3JyEyLeSxb
eFOIkuI8Ce0SCPT01+6sR77EA0VtUA+0Ak7OI4EvElFPn0qBAkEA8SvKXG6suLFL
9TjUH2B1XDwMxQFw7JOOhAyLcbNJMLgqMhHuqvTW/T4oxTQh7LbDMP977ZDnkmdt
L8S7zAHHsQJBALAgOFkbNNH4FzBQtxyWEu6+D0ZhvhIAIoH0pDBdoIO9vKalRgWy
vV6YsI3NujjBjz1p7g3Zb/zliA3vH9ieqo0CQQCdlOVmvBIzo/Vjx7wivF4y5DHb
z/M/QbMPaTr8Eg+yu8MmcD0oi06mriTppgS8rTahH26UbehB6z6Wxc+Hn2ohAkEA
r2GmOrToyBzvmmEFtiWK/MmtlDxIdMxFkHr39GGHMSiC7r6tF4eBIu2RAePWiCXW
aSVOs+PNrFs0PAvd/mshEQJAYpxilxZI7hJT89Qne6CgPXqqZf0sFX0FeR9AJaj1
g2c+B9GgZ+Nou4ne4WXjOVUWZuuch7yqn3XoxeQT4/xaCw==
-----END RSA PRIVATE KEY-----
</span><span class="token template-punctuation string">`</span></span>

<span class="token comment">// 解析公钥和私钥</span>
<span class="token keyword">var</span> publicKey <span class="token operator">=</span> forge<span class="token punctuation">.</span>pki<span class="token punctuation">.</span><span class="token function">publicKeyFromPem</span><span class="token punctuation">(</span>publicKeyPEM<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> privateKey <span class="token operator">=</span> forge<span class="token punctuation">.</span>pki<span class="token punctuation">.</span><span class="token function">privateKeyFromPem</span><span class="token punctuation">(</span>privateKeyPEM<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 获取模数（modulus），使用 16 进制字符串表示，从公钥和私钥中均可获取，且值是一样的</span>
<span class="token keyword">var</span> modulus <span class="token operator">=</span> publicKey<span class="token punctuation">.</span>n<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 或者 privateKey.n.toString(16);</span>

<span class="token comment">// 计算密钥的位数，即模数（modulus）的位数，16 进制转换为位数时每个字符代表 4 位</span>
<span class="token keyword">var</span> keyLength <span class="token operator">=</span> modulus<span class="token punctuation">.</span>length <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">;</span>

<span class="token comment">// 获取公钥指数</span>
<span class="token keyword">var</span> publicExponent <span class="token operator">=</span> publicKey<span class="token punctuation">.</span>e<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 获取私钥指数</span>
<span class="token keyword">var</span> privateExponent <span class="token operator">=</span> privateKey<span class="token punctuation">.</span>d<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）模数: &quot;</span><span class="token punctuation">,</span> modulus<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// a5ec75ae5dc387f48fc1b9dedda656311ce1020fcd9f26fd5624a00386620b0b10cb24b564b9e0507f0508b4f10b17744b86cfb7f973587c68b3ecf3cf871575a5ecb98eb1d3f33c3c227acd470943782cb1fd0f844e94a94089af20b7f44411ed9ce815a5be35ba1285db8c061f8abbf9f68dc3a70154a8459fe7ee22d4867d</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）密钥 &amp; 模数位数: &quot;</span><span class="token punctuation">,</span> keyLength<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 1024</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）公钥指数: &quot;</span><span class="token punctuation">,</span> publicExponent<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 0x10001 (65537)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）私钥指数: &quot;</span><span class="token punctuation">,</span> privateExponent<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// a4a67359267e8409722661d600c9b13a6757f97dc92427c2b99afa96c4e1c1e7a7308f2ad9db81f71f34d5a10899631aea5fcafcdbb3549990250bfc1d72051dee01b5b0e46d2ecc9a3ad7061c8ae7e7400d7f96edc9c84c8b792c5b78538892e23c09ed1208f4f4d7eeac47bec403456d500fb4024ece23812f12514f9f4a81</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br></div></div><h3 id="golang-2"><a href="#golang-2" class="header-anchor">#</a> Golang <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>1.0+</span></h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;crypto/rsa&quot;</span>
    <span class="token string">&quot;crypto/x509&quot;</span>
    <span class="token string">&quot;encoding/pem&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// spki 标准 pem 格式的公钥</span>
    publicKeyPEM <span class="token operator">:=</span> <span class="token string">`
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCl7HWuXcOH9I/Bud7dplYxHOEC
D82fJv1WJKADhmILCxDLJLVkueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5
jrHT8zw8InrNRwlDeCyx/Q+ETpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faN
w6cBVKhFn+fuItSGfQIDAQAB
-----END PUBLIC KEY-----
`</span>
    <span class="token comment">// pkcs1 标准 pem 格式的私钥</span>
    privateKeyPEM <span class="token operator">:=</span> <span class="token string">`
-----BEGIN RSA PRIVATE KEY-----
MIICXgIBAAKBgQCl7HWuXcOH9I/Bud7dplYxHOECD82fJv1WJKADhmILCxDLJLVk
ueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5jrHT8zw8InrNRwlDeCyx/Q+E
TpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faNw6cBVKhFn+fuItSGfQIDAQAB
AoGBAKSmc1kmfoQJciZh1gDJsTpnV/l9ySQnwrma+pbE4cHnpzCPKtnbgfcfNNWh
CJljGupfyvzbs1SZkCUL/B1yBR3uAbWw5G0uzJo61wYciufnQA1/lu3JyEyLeSxb
eFOIkuI8Ce0SCPT01+6sR77EA0VtUA+0Ak7OI4EvElFPn0qBAkEA8SvKXG6suLFL
9TjUH2B1XDwMxQFw7JOOhAyLcbNJMLgqMhHuqvTW/T4oxTQh7LbDMP977ZDnkmdt
L8S7zAHHsQJBALAgOFkbNNH4FzBQtxyWEu6+D0ZhvhIAIoH0pDBdoIO9vKalRgWy
vV6YsI3NujjBjz1p7g3Zb/zliA3vH9ieqo0CQQCdlOVmvBIzo/Vjx7wivF4y5DHb
z/M/QbMPaTr8Eg+yu8MmcD0oi06mriTppgS8rTahH26UbehB6z6Wxc+Hn2ohAkEA
r2GmOrToyBzvmmEFtiWK/MmtlDxIdMxFkHr39GGHMSiC7r6tF4eBIu2RAePWiCXW
aSVOs+PNrFs0PAvd/mshEQJAYpxilxZI7hJT89Qne6CgPXqqZf0sFX0FeR9AJaj1
g2c+B9GgZ+Nou4ne4WXjOVUWZuuch7yqn3XoxeQT4/xaCw==
-----END RSA PRIVATE KEY-----
`</span>
  
    <span class="token comment">// 解析公钥和私钥</span>
    publicKeyBlock<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>publicKeyPEM<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> publicKeyBlock <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to decode public key&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    publicKeyInterface<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">ParsePKIXPublicKey</span><span class="token punctuation">(</span>publicKeyBlock<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to parse public key:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    publicKey <span class="token operator">:=</span> publicKeyInterface<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>rsa<span class="token punctuation">.</span>PublicKey<span class="token punctuation">)</span>
  
    privateBlock<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>privateKeyPEM<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> privateBlock <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to decode private key&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    privateKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">ParsePKCS1PrivateKey</span><span class="token punctuation">(</span>privateBlock<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to parse private key:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">// 获取模数（modulus），使用 16 进制字符串表示，从公钥和私钥中均可获取，且值是一样的</span>
    modulus <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span> publicKey<span class="token punctuation">.</span>N<span class="token punctuation">)</span> <span class="token comment">// 或者 privateKey.N</span>
  
    <span class="token comment">// 计算密钥的位数，即模数（modulus）的位数，16 进制转换为位数时每个字符代表 4 位</span>
    keyLength <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span> publicKey<span class="token punctuation">.</span>N<span class="token punctuation">.</span><span class="token function">BitLen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  
    <span class="token comment">// 获取公钥指数</span>
    publicExponent <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span> publicKey<span class="token punctuation">.</span>E<span class="token punctuation">)</span>
  
    <span class="token comment">// 获取私钥指数</span>
    privateExponent <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">.</span>D<span class="token punctuation">)</span>
  
    <span class="token comment">// 获取私钥其他参数</span>
    privatePrime1 <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">.</span>Primes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    privatePrime2 <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">.</span>Primes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    privateExponent1 <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">.</span>Precomputed<span class="token punctuation">.</span>Dp<span class="token punctuation">)</span>
    privateExponent2 <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">.</span>Precomputed<span class="token punctuation">.</span>Dq<span class="token punctuation">)</span>
    privateCoefficient <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%x&quot;</span><span class="token punctuation">,</span> privateKey<span class="token punctuation">.</span>Precomputed<span class="token punctuation">.</span>Qinv<span class="token punctuation">)</span>
  
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）模数: &quot;</span><span class="token punctuation">,</span> modulus<span class="token punctuation">)</span>                         <span class="token comment">// a5ec75ae5dc387f48fc1b9dedda656311ce1020fcd9f26fd5624a00386620b0b10cb24b564b9e0507f0508b4f10b17744b86cfb7f973587c68b3ecf3cf871575a5ecb98eb1d3f33c3c227acd470943782cb1fd0f844e94a94089af20b7f44411ed9ce815a5be35ba1285db8c061f8abbf9f68dc3a70154a8459fe7ee22d4867d</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）密钥 &amp; 模数位数: &quot;</span><span class="token punctuation">,</span> keyLength<span class="token punctuation">)</span>             <span class="token comment">// 1024</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）公钥指数: &quot;</span><span class="token punctuation">,</span> publicExponent<span class="token punctuation">)</span>              <span class="token comment">// 0x10001 (65537)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）私钥指数: &quot;</span><span class="token punctuation">,</span> privateExponent<span class="token punctuation">)</span>             <span class="token comment">// a4a67359267e8409722661d600c9b13a6757f97dc92427c2b99afa96c4e1c1e7a7308f2ad9db81f71f34d5a10899631aea5fcafcdbb3549990250bfc1d72051dee01b5b0e46d2ecc9a3ad7061c8ae7e7400d7f96edc9c84c8b792c5b78538892e23c09ed1208f4f4d7eeac47bec403456d500fb4024ece23812f12514f9f4a81</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）私钥 prime1: &quot;</span><span class="token punctuation">,</span> privatePrime1<span class="token punctuation">)</span>           <span class="token comment">// f12bca5c6eacb8b14bf538d41f60755c3c0cc50170ec938e840c8b71b34930b82a3211eeaaf4d6fd3e28c53421ecb6c330ff7bed90e792676d2fc4bbcc01c7b1</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）私钥 prime2: &quot;</span><span class="token punctuation">,</span> privatePrime2<span class="token punctuation">)</span>           <span class="token comment">// b02038591b34d1f8173050b71c9612eebe0f4661be12002281f4a4305da083bdbca6a54605b2bd5e98b08dcdba38c18f3d69ee0dd96ffce5880def1fd89eaa8d</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）私钥 exponent1: &quot;</span><span class="token punctuation">,</span> privateExponent1<span class="token punctuation">)</span>     <span class="token comment">// 9d94e566bc1233a3f563c7bc22bc5e32e431dbcff33f41b30f693afc120fb2bbc326703d288b4ea6ae24e9a604bcad36a11f6e946de841eb3e96c5cf879f6a21</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）私钥 exponent2: &quot;</span><span class="token punctuation">,</span> privateExponent2<span class="token punctuation">)</span>     <span class="token comment">// af61a63ab4e8c81cef9a6105b6258afcc9ad943c4874cc45907af7f46187312882eebead17878122ed9101e3d68825d669254eb3e3cdac5b343c0bddfe6b2111</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;（16 进制）私钥 coefficient: &quot;</span><span class="token punctuation">,</span> privateCoefficient<span class="token punctuation">)</span> <span class="token comment">// 629c62971648ee1253f3d4277ba0a03d7aaa65fd2c157d05791f4025a8f583673e07d1a067e368bb89dee165e339551666eb9c87bcaa9f75e8c5e413e3fc5a0b</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br></div></div><h2 id="转换密钥"><a href="#转换密钥" class="header-anchor">#</a> 转换密钥</h2> <p>RSA 的公钥语法标准有：pkcs1、spki，私钥的语法标准有：pkcs1、pkcs8，已知一个语法标准的秘钥，可以将其转换成另一种语法标准的秘钥，同时秘钥最终的格式 pem、der 也是可以相互转换的。</p> <h3 id="python-3"><a href="#python-3" class="header-anchor">#</a> Python <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>3.0+</span></h3> <br> <div class="theme-code-group" data-v-392329f0><div class="theme-code-group__nav" data-v-392329f0><ul class="theme-code-group__ul" data-v-392329f0></ul></div> <div class="theme-code-block theme-code-block__active" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install pycryptodome，官方文档：https://pycryptodome.readthedocs.io/</span>

<span class="token comment" data-v-5a3e6e86># ❌ 密钥输出格式不支持 jwk</span>
<span class="token comment" data-v-5a3e6e86># ❌ 公钥不支持从 spki 标准转为 pkcs1 标准</span>

<span class="token keyword" data-v-5a3e6e86>from</span> Crypto<span class="token punctuation" data-v-5a3e6e86>.</span>PublicKey <span class="token keyword" data-v-5a3e6e86>import</span> RSA


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>pkcs1_to_spki</span><span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    <span class="token comment" data-v-5a3e6e86># 将 pkcs1 标准的公钥转换为 spki 标准，返回 pem 或者 der 格式的公钥</span>
    public_key_pkcs1 <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>import_key<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>)</span>
    public_key_spki <span class="token operator" data-v-5a3e6e86>=</span> public_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>.</span>export_key<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span>output_format<span class="token punctuation" data-v-5a3e6e86>.</span>upper<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> public_key_spki<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>pkcs1_to_pkcs8</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    <span class="token comment" data-v-5a3e6e86># 将 pkcs1 标准的私钥转换为 pkcs8 标准，返回 pem 或者 der 格式的公钥</span>
    private_key_pkcs1 <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>import_key<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>)</span>
    private_key_pkcs8 <span class="token operator" data-v-5a3e6e86>=</span> private_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>.</span>export_key<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span>output_format<span class="token punctuation" data-v-5a3e6e86>.</span>upper<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> pkcs<span class="token operator" data-v-5a3e6e86>=</span><span class="token number" data-v-5a3e6e86>8</span><span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> private_key_pkcs8<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>pkcs8_to_pkcs1</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs8<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    <span class="token comment" data-v-5a3e6e86># 将 pkcs8 标准的私钥转换为 pkcs1 标准，返回 pem 或者 der 格式的公钥</span>
    private_key_pkcs8 <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>import_key<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs8<span class="token punctuation" data-v-5a3e6e86>)</span>
    private_key_pkcs1 <span class="token operator" data-v-5a3e6e86>=</span> private_key_pkcs8<span class="token punctuation" data-v-5a3e6e86>.</span>export_key<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span>output_format<span class="token punctuation" data-v-5a3e6e86>.</span>upper<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> pkcs<span class="token operator" data-v-5a3e6e86>=</span><span class="token number" data-v-5a3e6e86>1</span><span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> private_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>


<span class="token comment" data-v-5a3e6e86># 注意 &quot;&quot;&quot; 之后要紧跟着密钥标头，如果换行可能会因为无法解析导致报错：ValueError: RSA key format is not supported</span>
<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的公钥</span>
public_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的私钥</span>
private_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># 转换公钥：pkcs1 =&gt; spki</span>
public_key_spki_pem <span class="token operator" data-v-5a3e6e86>=</span> pkcs1_to_spki<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;pem&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token comment" data-v-5a3e6e86># 转换私钥：pkcs1 =&gt; pkcs8</span>
private_key_pkcs8_pem <span class="token operator" data-v-5a3e6e86>=</span> pkcs1_to_pkcs8<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;pem&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;公钥转换 pkcs1 =&gt; spki:\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> public_key_spki_pem<span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;\n私钥转换 pkcs1 =&gt; pkcs8:\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_key_pkcs8_pem<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
公钥转换 pkcs1 =&gt; spki:

-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCywP2lBJUsarz1J5QuAPFGjYer
ccq45S7IVuP8FIFmSAQW76e8lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPo
yMdbVHciTyVy8mQja90PLeLEMnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sL
nGFdBB0m8dxtG+oRKwIDAQAB
-----END PUBLIC KEY-----

私钥转换 pkcs1 =&gt; pkcs8:

-----BEGIN PRIVATE KEY-----
MIICegIBADANBgkqhkiG9w0BAQEFAASCAmQwggJgAgEAAoGBALLA/aUElSxqvPUn
lC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4OiC5mbbbyvOqElQNhkaeV8EF2r
Zqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q1+imN6KUEIHrLveuYq1Lvmw3
lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAECgYAM6uVph2tASnZdQP70VB0bfB7R
xOdhdS5sS9st3E19lra08ZythCFa4dr0vsavW/pgqtCE0rzUWKLWIgy8GfORUhqS
FJi8Lb3jLIRkb59glxe5lbOgXT5hSuUU/Ru8bkk6kNxQ3hgb60b3bgBuHI8vQAmR
fQEQSVJZoWFW2dPEAQJFALh8wsjMTaEKr0VSZHn1gNIdqw9RUNa6rR5cb4//Qqn3
HllQONlyiNwGGmwkFBvH0/jKDKJiPi5TDc5IDxf99kfGqaD9Aj0A+AtHlTPlV5qP
U+C6GSgoHffzg+eusqgUP7CBzoftCJv1ooYpPTHl0qzBl5/IT88X5CLuExaI7XwU
rYdHAkRv95BES/KFXbW4TeQbPMvdOhJarpBwckWlWpZ+/34XJ5rsu8p09pVna/DX
VyI5JhNZOE9oslVoyhFj88ntVr4FG+ZRhQI9AI7Tp+dhF5lHFWreByq/NcJz6RO2
D6EuKWK3Fze+ix2e+GUaTZrAJa8W7O6LAgP6oq4p8t6o5jWhciKttwJEa0bg+yko
sBAw7qMjtsVRzmJ/1QqjpMZ67f0Teq2/iNY1bqo5s8En1HWC6syo9RP2DrfTGNl1
nHPppz1nsV+COkxXQV4=
-----END PRIVATE KEY-----
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>62</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>63</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>64</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>65</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>66</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>67</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>68</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>69</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>70</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>71</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>72</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>73</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>74</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>75</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>76</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>77</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>78</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>79</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>80</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>81</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>82</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>83</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>84</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>85</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>86</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>87</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>88</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>89</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>90</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>91</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>92</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>93</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>94</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install cryptography，要求 Python 3.7+，官方文档：https://cryptography.io/</span>

<span class="token comment" data-v-5a3e6e86># ❌ 密钥输出格式不支持 jwk</span>
<span class="token comment" data-v-5a3e6e86># ❌ 私钥不支持从 pkcs8 标准转为 pkcs1 标准</span>

<span class="token keyword" data-v-5a3e6e86>from</span> cryptography<span class="token punctuation" data-v-5a3e6e86>.</span>hazmat<span class="token punctuation" data-v-5a3e6e86>.</span>primitives <span class="token keyword" data-v-5a3e6e86>import</span> serialization
<span class="token keyword" data-v-5a3e6e86>from</span> cryptography<span class="token punctuation" data-v-5a3e6e86>.</span>hazmat<span class="token punctuation" data-v-5a3e6e86>.</span>primitives<span class="token punctuation" data-v-5a3e6e86>.</span>serialization <span class="token keyword" data-v-5a3e6e86>import</span> load_pem_public_key<span class="token punctuation" data-v-5a3e6e86>,</span> load_pem_private_key


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>pkcs1_to_spki</span><span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    <span class="token comment" data-v-5a3e6e86># 将 pkcs1 标准的公钥转换为 spki 标准，返回 pem 或者 der 格式的公钥</span>
    <span class="token keyword" data-v-5a3e6e86>if</span> output_format<span class="token punctuation" data-v-5a3e6e86>.</span>upper<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token operator" data-v-5a3e6e86>==</span> <span class="token string" data-v-5a3e6e86>&quot;DER&quot;</span><span class="token punctuation" data-v-5a3e6e86>:</span>
        encoding <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>Encoding<span class="token punctuation" data-v-5a3e6e86>.</span>DER
    <span class="token keyword" data-v-5a3e6e86>else</span><span class="token punctuation" data-v-5a3e6e86>:</span>
        encoding <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>Encoding<span class="token punctuation" data-v-5a3e6e86>.</span>PEM
    public_key_pkcs1 <span class="token operator" data-v-5a3e6e86>=</span> load_pem_public_key<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
    public_key_spki <span class="token operator" data-v-5a3e6e86>=</span> public_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>.</span>public_bytes<span class="token punctuation" data-v-5a3e6e86>(</span>
        encoding<span class="token operator" data-v-5a3e6e86>=</span>encoding<span class="token punctuation" data-v-5a3e6e86>,</span>
        <span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span>serialization<span class="token punctuation" data-v-5a3e6e86>.</span>PublicFormat<span class="token punctuation" data-v-5a3e6e86>.</span>SubjectPublicKeyInfo
    <span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> public_key_spki<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>spki_to_pkcs1</span><span class="token punctuation" data-v-5a3e6e86>(</span>public_key_spki<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    <span class="token comment" data-v-5a3e6e86># 将 spki 标准的公钥转换为 pkcs1 标准，返回 pem 或者 der 格式的公钥</span>
    <span class="token keyword" data-v-5a3e6e86>if</span> output_format<span class="token punctuation" data-v-5a3e6e86>.</span>upper<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token operator" data-v-5a3e6e86>==</span> <span class="token string" data-v-5a3e6e86>&quot;DER&quot;</span><span class="token punctuation" data-v-5a3e6e86>:</span>
        encoding <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>Encoding<span class="token punctuation" data-v-5a3e6e86>.</span>DER
    <span class="token keyword" data-v-5a3e6e86>else</span><span class="token punctuation" data-v-5a3e6e86>:</span>
        encoding <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>Encoding<span class="token punctuation" data-v-5a3e6e86>.</span>PEM
    public_key_spki <span class="token operator" data-v-5a3e6e86>=</span> load_pem_public_key<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_spki<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
    public_key_pkcs1 <span class="token operator" data-v-5a3e6e86>=</span> public_key_spki<span class="token punctuation" data-v-5a3e6e86>.</span>public_bytes<span class="token punctuation" data-v-5a3e6e86>(</span>
        encoding<span class="token operator" data-v-5a3e6e86>=</span>encoding<span class="token punctuation" data-v-5a3e6e86>,</span>
        <span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span>serialization<span class="token punctuation" data-v-5a3e6e86>.</span>PublicFormat<span class="token punctuation" data-v-5a3e6e86>.</span>PKCS1
    <span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> public_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>pkcs1_to_pkcs8</span><span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    <span class="token comment" data-v-5a3e6e86># 将 pkcs1 标准的私钥转换为 pkcs8 标准，返回 pem 或者 der 格式的公钥</span>
    <span class="token keyword" data-v-5a3e6e86>if</span> output_format<span class="token punctuation" data-v-5a3e6e86>.</span>upper<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token operator" data-v-5a3e6e86>==</span> <span class="token string" data-v-5a3e6e86>&quot;DER&quot;</span><span class="token punctuation" data-v-5a3e6e86>:</span>
        encoding <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>Encoding<span class="token punctuation" data-v-5a3e6e86>.</span>DER
    <span class="token keyword" data-v-5a3e6e86>else</span><span class="token punctuation" data-v-5a3e6e86>:</span>
        encoding <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>Encoding<span class="token punctuation" data-v-5a3e6e86>.</span>PEM
    private_key_pkcs1 <span class="token operator" data-v-5a3e6e86>=</span> load_pem_private_key<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> password<span class="token operator" data-v-5a3e6e86>=</span><span class="token boolean" data-v-5a3e6e86>None</span><span class="token punctuation" data-v-5a3e6e86>)</span>  <span class="token comment" data-v-5a3e6e86># 可选参数 password，指定私钥的密码</span>
    private_key_pkcs8 <span class="token operator" data-v-5a3e6e86>=</span> private_key_pkcs1<span class="token punctuation" data-v-5a3e6e86>.</span>private_bytes<span class="token punctuation" data-v-5a3e6e86>(</span>
        encoding<span class="token operator" data-v-5a3e6e86>=</span>encoding<span class="token punctuation" data-v-5a3e6e86>,</span>
        <span class="token builtin" data-v-5a3e6e86>format</span><span class="token operator" data-v-5a3e6e86>=</span>serialization<span class="token punctuation" data-v-5a3e6e86>.</span>PrivateFormat<span class="token punctuation" data-v-5a3e6e86>.</span>PKCS8<span class="token punctuation" data-v-5a3e6e86>,</span>
        encryption_algorithm<span class="token operator" data-v-5a3e6e86>=</span>serialization<span class="token punctuation" data-v-5a3e6e86>.</span>NoEncryption<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>  <span class="token comment" data-v-5a3e6e86># 可选参数 encryption_algorithm，指定私钥的加密算法</span>
    <span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> private_key_pkcs8<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>


<span class="token comment" data-v-5a3e6e86># spki 标准 pem 格式的公钥</span>
public_key_spki_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCl7HWuXcOH9I/Bud7dplYxHOEC
D82fJv1WJKADhmILCxDLJLVkueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5
jrHT8zw8InrNRwlDeCyx/Q+ETpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faN
w6cBVKhFn+fuItSGfQIDAQAB
-----END PUBLIC KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的私钥</span>
private_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----
MIICXgIBAAKBgQCl7HWuXcOH9I/Bud7dplYxHOECD82fJv1WJKADhmILCxDLJLVk
ueBQfwUItPELF3RLhs+3+XNYfGiz7PPPhxV1pey5jrHT8zw8InrNRwlDeCyx/Q+E
TpSpQImvILf0RBHtnOgVpb41uhKF24wGH4q7+faNw6cBVKhFn+fuItSGfQIDAQAB
AoGBAKSmc1kmfoQJciZh1gDJsTpnV/l9ySQnwrma+pbE4cHnpzCPKtnbgfcfNNWh
CJljGupfyvzbs1SZkCUL/B1yBR3uAbWw5G0uzJo61wYciufnQA1/lu3JyEyLeSxb
eFOIkuI8Ce0SCPT01+6sR77EA0VtUA+0Ak7OI4EvElFPn0qBAkEA8SvKXG6suLFL
9TjUH2B1XDwMxQFw7JOOhAyLcbNJMLgqMhHuqvTW/T4oxTQh7LbDMP977ZDnkmdt
L8S7zAHHsQJBALAgOFkbNNH4FzBQtxyWEu6+D0ZhvhIAIoH0pDBdoIO9vKalRgWy
vV6YsI3NujjBjz1p7g3Zb/zliA3vH9ieqo0CQQCdlOVmvBIzo/Vjx7wivF4y5DHb
z/M/QbMPaTr8Eg+yu8MmcD0oi06mriTppgS8rTahH26UbehB6z6Wxc+Hn2ohAkEA
r2GmOrToyBzvmmEFtiWK/MmtlDxIdMxFkHr39GGHMSiC7r6tF4eBIu2RAePWiCXW
aSVOs+PNrFs0PAvd/mshEQJAYpxilxZI7hJT89Qne6CgPXqqZf0sFX0FeR9AJaj1
g2c+B9GgZ+Nou4ne4WXjOVUWZuuch7yqn3XoxeQT4/xaCw==
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># 转换公钥：spki =&gt; pkcs1</span>
public_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> spki_to_pkcs1<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_spki_pem<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;pem&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token comment" data-v-5a3e6e86># 转换私钥：pkcs1 =&gt; pkcs8</span>
private_key_pkcs8_pem <span class="token operator" data-v-5a3e6e86>=</span> pkcs1_to_pkcs8<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>,</span> output_format<span class="token operator" data-v-5a3e6e86>=</span><span class="token string" data-v-5a3e6e86>&quot;pem&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;公钥转换 spki =&gt; pkcs1:\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> public_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;私钥转换 pkcs1 =&gt; pkcs8:\n\n&quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> private_key_pkcs8_pem<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
公钥转换 spki =&gt; pkcs1:

 -----BEGIN RSA PUBLIC KEY-----
MIGJAoGBAKXsda5dw4f0j8G53t2mVjEc4QIPzZ8m/VYkoAOGYgsLEMsktWS54FB/
BQi08QsXdEuGz7f5c1h8aLPs88+HFXWl7LmOsdPzPDwies1HCUN4LLH9D4ROlKlA
ia8gt/REEe2c6BWlvjW6EoXbjAYfirv59o3DpwFUqEWf5+4i1IZ9AgMBAAE=
-----END RSA PUBLIC KEY-----

私钥转换 pkcs1 =&gt; pkcs8:

 -----BEGIN PRIVATE KEY-----
MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBAKXsda5dw4f0j8G5
3t2mVjEc4QIPzZ8m/VYkoAOGYgsLEMsktWS54FB/BQi08QsXdEuGz7f5c1h8aLPs
88+HFXWl7LmOsdPzPDwies1HCUN4LLH9D4ROlKlAia8gt/REEe2c6BWlvjW6EoXb
jAYfirv59o3DpwFUqEWf5+4i1IZ9AgMBAAECgYEApKZzWSZ+hAlyJmHWAMmxOmdX
+X3JJCfCuZr6lsThweenMI8q2duB9x801aEImWMa6l/K/NuzVJmQJQv8HXIFHe4B
tbDkbS7MmjrXBhyK5+dADX+W7cnITIt5LFt4U4iS4jwJ7RII9PTX7qxHvsQDRW1Q
D7QCTs4jgS8SUU+fSoECQQDxK8pcbqy4sUv1ONQfYHVcPAzFAXDsk46EDItxs0kw
uCoyEe6q9Nb9PijFNCHstsMw/3vtkOeSZ20vxLvMAcexAkEAsCA4WRs00fgXMFC3
HJYS7r4PRmG+EgAigfSkMF2gg728pqVGBbK9Xpiwjc26OMGPPWnuDdlv/OWIDe8f
2J6qjQJBAJ2U5Wa8EjOj9WPHvCK8XjLkMdvP8z9Bsw9pOvwSD7K7wyZwPSiLTqau
JOmmBLytNqEfbpRt6EHrPpbFz4efaiECQQCvYaY6tOjIHO+aYQW2JYr8ya2UPEh0
zEWQevf0YYcxKILuvq0Xh4Ei7ZEB49aIJdZpJU6z482sWzQ8C93+ayERAkBinGKX
FkjuElPz1Cd7oKA9eqpl/SwVfQV5H0AlqPWDZz4H0aBn42i7id7hZeM5VRZm65yH
vKqfdejF5BPj/FoL
-----END PRIVATE KEY-----
&quot;&quot;&quot;</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>62</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>63</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>64</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>65</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>66</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>67</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>68</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>69</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>70</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>71</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>72</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>73</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>74</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>75</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>76</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>77</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>78</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>79</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>80</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>81</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>82</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>83</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>84</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>85</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>86</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>87</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>88</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>89</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>90</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>91</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>92</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>93</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>94</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>95</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>96</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>97</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>98</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>99</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>100</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>101</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>102</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>103</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>104</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>105</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>106</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>107</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>108</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>109</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>110</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>111</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>112</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>113</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>114</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>115</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>116</span><br data-v-5a3e6e86></div></div></div> <pre class="pre-blank" data-v-392329f0>// Make sure to add code blocks to your code group</pre></div> <h3 id="javascript-3"><a href="#javascript-3" class="header-anchor">#</a> JavaScript <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>Node.js</span> <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>ECMAScript 5.1+</span></h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// ✅ Node.js 内置 crypto 模块，无需单独安装</span>

<span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;crypto&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">PKCS1ToSPKI</span><span class="token punctuation">(</span>publicKeyPkcs1<span class="token punctuation">,</span> outputFormat<span class="token operator">=</span><span class="token string">&quot;pem&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将 pkcs1 标准的公钥转换为 spki 标准，返回 pem 或者 der 格式的公钥</span>
    <span class="token keyword">const</span> publicKeySpki <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> publicKeyPkcs1<span class="token punctuation">,</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;pkcs1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> publicKeySpki<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;spki&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">format</span><span class="token operator">:</span> outputFormat<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SPKIToPKCS1</span><span class="token punctuation">(</span>publicKeySpki<span class="token punctuation">,</span> outputFormat<span class="token operator">=</span><span class="token string">&quot;pem&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将 spki 标准的公钥转换为 pkcs1 标准，返回 pem 或者 der 格式的公钥</span>
    <span class="token keyword">const</span> publicKeyPkcs1 <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> publicKeySpki<span class="token punctuation">,</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;spki&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> publicKeyPkcs1<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;pkcs1&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">format</span><span class="token operator">:</span> outputFormat<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">PKCS1ToPKCS8</span><span class="token punctuation">(</span>privateKeyPkcs1<span class="token punctuation">,</span> outputFormat<span class="token operator">=</span><span class="token string">&quot;pem&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将 pkcs1 标准的私钥转换为 pkcs8 标准，返回 pem 或者 der 格式的公钥</span>
    <span class="token keyword">const</span> privateKeyPkcs8 <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createPrivateKey</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> privateKeyPkcs1<span class="token punctuation">,</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;pkcs1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> privateKeyPkcs8<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;pkcs8&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">format</span><span class="token operator">:</span> outputFormat<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">PKCS8ToPKCS1</span><span class="token punctuation">(</span>privateKeyPkcs8<span class="token punctuation">,</span> outputFormat<span class="token operator">=</span><span class="token string">&quot;pem&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 将 pkcs8 标准的私钥转换为 pkcs1 标准，返回 pem 或者 der 格式的公钥</span>
    <span class="token keyword">const</span> privateKeyPkcs1 <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createPrivateKey</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> privateKeyPkcs8<span class="token punctuation">,</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;pkcs8&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> privateKeyPkcs1<span class="token punctuation">.</span><span class="token function">export</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;pkcs1&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">format</span><span class="token operator">:</span> outputFormat<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// pkcs1 标准 pem 格式的公钥</span>
<span class="token keyword">const</span> publicKeyPkcs1Pem <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
</span><span class="token template-punctuation string">`</span></span>

<span class="token comment">// pkcs1 标准 pem 格式的私钥</span>
<span class="token keyword">const</span> privateKeyPkcs1Pem <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
</span><span class="token template-punctuation string">`</span></span>


<span class="token comment">// 转换公钥：pkcs1 =&gt; spki</span>
<span class="token keyword">var</span> publicKeySpkiPem <span class="token operator">=</span> <span class="token function">PKCS1ToSPKI</span><span class="token punctuation">(</span>publicKeyPkcs1Pem<span class="token punctuation">,</span> <span class="token string">&quot;pem&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// 转换私钥：pkcs1 =&gt; pkcs8</span>
<span class="token keyword">var</span> privateKeyPkcs8Pem <span class="token operator">=</span> <span class="token function">PKCS1ToPKCS8</span><span class="token punctuation">(</span>privateKeyPkcs1Pem<span class="token punctuation">,</span> <span class="token string">&quot;pem&quot;</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;公钥转换 pkcs1 =&gt; spki:\n\n&quot;</span><span class="token punctuation">,</span> publicKeySpkiPem<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;私钥转换 pkcs1 =&gt; pkcs8:\n\n&quot;</span><span class="token punctuation">,</span> privateKeyPkcs8Pem<span class="token punctuation">)</span>


<span class="token comment">/*
公钥转换 pkcs1 =&gt; spki:

 -----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCywP2lBJUsarz1J5QuAPFGjYer
ccq45S7IVuP8FIFmSAQW76e8lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPo
yMdbVHciTyVy8mQja90PLeLEMnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sL
nGFdBB0m8dxtG+oRKwIDAQAB
-----END PUBLIC KEY-----

私钥转换 pkcs1 =&gt; pkcs8:

 -----BEGIN PRIVATE KEY-----
MIICegIBADANBgkqhkiG9w0BAQEFAASCAmQwggJgAgEAAoGBALLA/aUElSxqvPUn
lC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4OiC5mbbbyvOqElQNhkaeV8EF2r
Zqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q1+imN6KUEIHrLveuYq1Lvmw3
lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAECgYAM6uVph2tASnZdQP70VB0bfB7R
xOdhdS5sS9st3E19lra08ZythCFa4dr0vsavW/pgqtCE0rzUWKLWIgy8GfORUhqS
FJi8Lb3jLIRkb59glxe5lbOgXT5hSuUU/Ru8bkk6kNxQ3hgb60b3bgBuHI8vQAmR
fQEQSVJZoWFW2dPEAQJFALh8wsjMTaEKr0VSZHn1gNIdqw9RUNa6rR5cb4//Qqn3
HllQONlyiNwGGmwkFBvH0/jKDKJiPi5TDc5IDxf99kfGqaD9Aj0A+AtHlTPlV5qP
U+C6GSgoHffzg+eusqgUP7CBzoftCJv1ooYpPTHl0qzBl5/IT88X5CLuExaI7XwU
rYdHAkRv95BES/KFXbW4TeQbPMvdOhJarpBwckWlWpZ+/34XJ5rsu8p09pVna/DX
VyI5JhNZOE9oslVoyhFj88ntVr4FG+ZRhQI9AI7Tp+dhF5lHFWreByq/NcJz6RO2
D6EuKWK3Fze+ix2e+GUaTZrAJa8W7O6LAgP6oq4p8t6o5jWhciKttwJEa0bg+yko
sBAw7qMjtsVRzmJ/1QqjpMZ67f0Teq2/iNY1bqo5s8En1HWC6syo9RP2DrfTGNl1
nHPppz1nsV+COkxXQV4=
-----END PRIVATE KEY-----
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br></div></div><h3 id="golang-3"><a href="#golang-3" class="header-anchor">#</a> Golang <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>1.0+</span></h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// ✅ 无需安装依赖，官方文档：https://pkg.go.dev/crypto</span>

<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;crypto/rsa&quot;</span>
    <span class="token string">&quot;crypto/x509&quot;</span>
    <span class="token string">&quot;encoding/pem&quot;</span>
    <span class="token string">&quot;errors&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;strings&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// PKCS1ToSPKI 将 pkcs1 标准的公钥转换为 spki 标准，返回 pem 或者 der 格式的公钥</span>
<span class="token keyword">func</span> <span class="token function">PKCS1ToSPKI</span><span class="token punctuation">(</span>publicKeyPkcs1<span class="token punctuation">,</span> outputFormat <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    block<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>publicKeyPkcs1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> block <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;failed to decode PEM block containing public key&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    publicKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">ParsePKCS1PublicKey</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
    <span class="token punctuation">}</span>
  
    publicKeySpkiBytes<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">MarshalPKIXPublicKey</span><span class="token punctuation">(</span>publicKey<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
    <span class="token punctuation">}</span>
  
    <span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">ToUpper</span><span class="token punctuation">(</span>outputFormat<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;DER&quot;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> publicKeySpkiBytes<span class="token punctuation">,</span> <span class="token boolean">nil</span>
    <span class="token punctuation">}</span>
  
    publicKeySpki <span class="token operator">:=</span> <span class="token operator">&amp;</span>pem<span class="token punctuation">.</span>Block<span class="token punctuation">{</span>
        Type<span class="token punctuation">:</span>  <span class="token string">&quot;PUBLIC KEY&quot;</span><span class="token punctuation">,</span>
        Bytes<span class="token punctuation">:</span> publicKeySpkiBytes<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> pem<span class="token punctuation">.</span><span class="token function">EncodeToMemory</span><span class="token punctuation">(</span>publicKeySpki<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// SPKIToPKCS1 将 SPKI 格式的公钥转换为 PKCS1 格式</span>
<span class="token keyword">func</span> <span class="token function">SPKIToPKCS1</span><span class="token punctuation">(</span>publicKeySpki<span class="token punctuation">,</span> outputFormat <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    block<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>publicKeySpki<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> block <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;failed to decode PEM block containing public key&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    publicKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">ParsePKIXPublicKey</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
    <span class="token punctuation">}</span>
  
    rsaPublicKey<span class="token punctuation">,</span> ok <span class="token operator">:=</span> publicKey<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>rsa<span class="token punctuation">.</span>PublicKey<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;not an RSA public key&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    publicKeyPkcs1Bytes <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">MarshalPKCS1PublicKey</span><span class="token punctuation">(</span>rsaPublicKey<span class="token punctuation">)</span>
  
    <span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">ToUpper</span><span class="token punctuation">(</span>outputFormat<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;DER&quot;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> publicKeyPkcs1Bytes<span class="token punctuation">,</span> <span class="token boolean">nil</span>
    <span class="token punctuation">}</span>
  
    publicKeyPkcs1 <span class="token operator">:=</span> <span class="token operator">&amp;</span>pem<span class="token punctuation">.</span>Block<span class="token punctuation">{</span>
        Type<span class="token punctuation">:</span>  <span class="token string">&quot;RSA PUBLIC KEY&quot;</span><span class="token punctuation">,</span>
        Bytes<span class="token punctuation">:</span> publicKeyPkcs1Bytes<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> pem<span class="token punctuation">.</span><span class="token function">EncodeToMemory</span><span class="token punctuation">(</span>publicKeyPkcs1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// PKCS1ToPKCS8 将 pkcs1 标准的私钥转换为 pkcs8 标准，返回 pem 或者 der 格式的公钥</span>
<span class="token keyword">func</span> <span class="token function">PKCS1ToPKCS8</span><span class="token punctuation">(</span>privateKeyPkcs1<span class="token punctuation">,</span> outputFormat <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    block<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>privateKeyPkcs1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> block <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;failed to decode PEM block containing public key&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    privateKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">ParsePKCS1PrivateKey</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
    <span class="token punctuation">}</span>
  
    privateKeyPkcs8Bytes<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">MarshalPKCS8PrivateKey</span><span class="token punctuation">(</span>privateKey<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
    <span class="token punctuation">}</span>
  
    <span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">ToUpper</span><span class="token punctuation">(</span>outputFormat<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;DER&quot;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> privateKeyPkcs8Bytes<span class="token punctuation">,</span> <span class="token boolean">nil</span>
    <span class="token punctuation">}</span>
  
    privateKeyPkcs8 <span class="token operator">:=</span> <span class="token operator">&amp;</span>pem<span class="token punctuation">.</span>Block<span class="token punctuation">{</span>
        Type<span class="token punctuation">:</span>  <span class="token string">&quot;PRIVATE KEY&quot;</span><span class="token punctuation">,</span>
        Bytes<span class="token punctuation">:</span> privateKeyPkcs8Bytes<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> pem<span class="token punctuation">.</span><span class="token function">EncodeToMemory</span><span class="token punctuation">(</span>privateKeyPkcs8<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// PKCS8ToPKCS1 将 pkcs8 标准的私钥转换为 pkcs1 标准，返回 pem 或者 der 格式的公钥</span>
<span class="token keyword">func</span> <span class="token function">PKCS8ToPKCS1</span><span class="token punctuation">(</span>privateKeyPkcs8<span class="token punctuation">,</span> outputFormat <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    block<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>privateKeyPkcs8<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> block <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;failed to decode PEM block containing public key&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    privateKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">ParsePKCS8PrivateKey</span><span class="token punctuation">(</span>block<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
    <span class="token punctuation">}</span>
  
    rsaPrivateKey<span class="token punctuation">,</span> ok <span class="token operator">:=</span> privateKey<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>rsa<span class="token punctuation">.</span>PrivateKey<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;not an RSA public key&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    privateKeyPkcs1Bytes <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">MarshalPKCS1PrivateKey</span><span class="token punctuation">(</span>rsaPrivateKey<span class="token punctuation">)</span>
  
    <span class="token keyword">if</span> strings<span class="token punctuation">.</span><span class="token function">ToUpper</span><span class="token punctuation">(</span>outputFormat<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;DER&quot;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> privateKeyPkcs1Bytes<span class="token punctuation">,</span> <span class="token boolean">nil</span>
    <span class="token punctuation">}</span>
  
    privateKeyPkcs1 <span class="token operator">:=</span> <span class="token operator">&amp;</span>pem<span class="token punctuation">.</span>Block<span class="token punctuation">{</span>
        Type<span class="token punctuation">:</span>  <span class="token string">&quot;RSA PRIVATE KEY&quot;</span><span class="token punctuation">,</span>
        Bytes<span class="token punctuation">:</span> privateKeyPkcs1Bytes<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> pem<span class="token punctuation">.</span><span class="token function">EncodeToMemory</span><span class="token punctuation">(</span>privateKeyPkcs1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// pkcs1 标准 pem 格式的公钥</span>
	  publicKeyPkcs1Pem <span class="token operator">:=</span> <span class="token string">`
-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
`</span>

    <span class="token comment">// pkcs1 标准 pem 格式的私钥</span>
    privateKeyPkcs1Pem <span class="token operator">:=</span> <span class="token string">`
-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
`</span>
    <span class="token comment">// 转换公钥：pkcs1 =&gt; spki</span>
    publicKeySpkiPem<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">PKCS1ToSPKI</span><span class="token punctuation">(</span>publicKeyPkcs1Pem<span class="token punctuation">,</span> <span class="token string">&quot;pem&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Error converting public key PKCS1 to SPKI:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">// 转换私钥：pkcs1 =&gt; pkcs8</span>
    privateKeyPkcs8Pem<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">PKCS1ToPKCS8</span><span class="token punctuation">(</span>privateKeyPkcs1Pem<span class="token punctuation">,</span> <span class="token string">&quot;pem&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Error converting private key PKCS1 to PKCS8:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
  
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;公钥转换 pkcs1 =&gt; spki:\n\n&quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>publicKeySpkiPem<span class="token punctuation">)</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;私钥转换 pkcs1 =&gt; pkcs8:\n\n&quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>privateKeyPkcs8Pem<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/*
公钥转换 pkcs1 =&gt; spki:

 -----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCywP2lBJUsarz1J5QuAPFGjYer
ccq45S7IVuP8FIFmSAQW76e8lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPo
yMdbVHciTyVy8mQja90PLeLEMnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sL
nGFdBB0m8dxtG+oRKwIDAQAB
-----END PUBLIC KEY-----

私钥转换 pkcs1 =&gt; pkcs8:

 -----BEGIN PRIVATE KEY-----
MIICegIBADANBgkqhkiG9w0BAQEFAASCAmQwggJgAgEAAoGBALLA/aUElSxqvPUn
lC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4OiC5mbbbyvOqElQNhkaeV8EF2r
Zqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q1+imN6KUEIHrLveuYq1Lvmw3
lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAECgYAM6uVph2tASnZdQP70VB0bfB7R
xOdhdS5sS9st3E19lra08ZythCFa4dr0vsavW/pgqtCE0rzUWKLWIgy8GfORUhqS
FJi8Lb3jLIRkb59glxe5lbOgXT5hSuUU/Ru8bkk6kNxQ3hgb60b3bgBuHI8vQAmR
fQEQSVJZoWFW2dPEAQJFALh8wsjMTaEKr0VSZHn1gNIdqw9RUNa6rR5cb4//Qqn3
HllQONlyiNwGGmwkFBvH0/jKDKJiPi5TDc5IDxf99kfGqaD9Aj0A+AtHlTPlV5qP
U+C6GSgoHffzg+eusqgUP7CBzoftCJv1ooYpPTHl0qzBl5/IT88X5CLuExaI7XwU
rYdHAkRv95BES/KFXbW4TeQbPMvdOhJarpBwckWlWpZ+/34XJ5rsu8p09pVna/DX
VyI5JhNZOE9oslVoyhFj88ntVr4FG+ZRhQI9AI7Tp+dhF5lHFWreByq/NcJz6RO2
D6EuKWK3Fze+ix2e+GUaTZrAJa8W7O6LAgP6oq4p8t6o5jWhciKttwJEa0bg+yko
sBAw7qMjtsVRzmJ/1QqjpMZ67f0Teq2/iNY1bqo5s8En1HWC6syo9RP2DrfTGNl1
nHPppz1nsV+COkxXQV4=
-----END PRIVATE KEY-----
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br></div></div><h2 id="加密解密"><a href="#加密解密" class="header-anchor">#</a> 加密解密</h2> <details class="custom-block details"><summary>关于加密解密</summary> <p>在 RSA 加密解密操作中，我们需要注意的是填充方式（padding），最常见的分为以下四种：</p> <ul><li><code>RSA_NO_PADDING</code>: 不使用填充方案；</li> <li><code>RSA_PKCS1_PADDING</code>: 最常见，使用 PKCS#1 v1.5 填充方案；</li> <li><code>RSA_PKCS1_OAEP_PADDING</code>: OAEP (Optimal asymmetric encryption padding)，最优非对称加密填充，在 PKCS#1 v2 中标准化；</li> <li><code>RSA_PKCS1_PSS_PADDING</code>: PSS (Probabilistic signature scheme)，概率签名方案，在 PKCS#1 v2.1 中标准化。</li></ul> <hr> <div class="custom-block right"><p>【实用参考资料】</p> <p>Padding 维基百科：<a href="https://en.wikipedia.org/wiki/Padding_(cryptography)" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Padding_(cryptography)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
RSA Padding 维基百科：<a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Padding" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Padding<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
聊聊密码学中的Padding：<a href="https://cloud.tencent.com/developer/article/1499219" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/1499219<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
PSS (Probabilistic signature scheme)：<a href="https://en.wikipedia.org/wiki/Probabilistic_signature_scheme" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Probabilistic_signature_scheme<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
OAEP (Optimal asymmetric encryption padding)：<a href="https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></details> <h3 id="python-4"><a href="#python-4" class="header-anchor">#</a> Python <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>3.0+</span></h3> <br> <div class="theme-code-group" data-v-392329f0><div class="theme-code-group__nav" data-v-392329f0><ul class="theme-code-group__ul" data-v-392329f0></ul></div> <div class="theme-code-block theme-code-block__active" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install cryptography，要求 Python 3.7+，官方文档：https://cryptography.io/</span>

<span class="token comment" data-v-5a3e6e86># ❌ padding 填充方式只支持 RSA_PKCS1_PADDING、RSA_PKCS1_OAEP_PADDING，不支持 RSA_NO_PADDING、RSA_PKCS1_PSS_PADDING</span>


<span class="token keyword" data-v-5a3e6e86>import</span> base64
<span class="token keyword" data-v-5a3e6e86>from</span> cryptography<span class="token punctuation" data-v-5a3e6e86>.</span>hazmat<span class="token punctuation" data-v-5a3e6e86>.</span>primitives <span class="token keyword" data-v-5a3e6e86>import</span> serialization<span class="token punctuation" data-v-5a3e6e86>,</span> hashes
<span class="token keyword" data-v-5a3e6e86>from</span> cryptography<span class="token punctuation" data-v-5a3e6e86>.</span>hazmat<span class="token punctuation" data-v-5a3e6e86>.</span>primitives<span class="token punctuation" data-v-5a3e6e86>.</span>asymmetric <span class="token keyword" data-v-5a3e6e86>import</span> padding


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>set_padding</span><span class="token punctuation" data-v-5a3e6e86>(</span>padding_scheme<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    <span class="token keyword" data-v-5a3e6e86>if</span> padding_scheme <span class="token operator" data-v-5a3e6e86>==</span> <span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_OAEP_PADDING&quot;</span><span class="token punctuation" data-v-5a3e6e86>:</span>
        <span class="token keyword" data-v-5a3e6e86>return</span> padding<span class="token punctuation" data-v-5a3e6e86>.</span>OAEP<span class="token punctuation" data-v-5a3e6e86>(</span>
            mgf<span class="token operator" data-v-5a3e6e86>=</span>padding<span class="token punctuation" data-v-5a3e6e86>.</span>MGF1<span class="token punctuation" data-v-5a3e6e86>(</span>algorithm<span class="token operator" data-v-5a3e6e86>=</span>hashes<span class="token punctuation" data-v-5a3e6e86>.</span>SHA256<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span>
            algorithm<span class="token operator" data-v-5a3e6e86>=</span>hashes<span class="token punctuation" data-v-5a3e6e86>.</span>SHA256<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span>
            label<span class="token operator" data-v-5a3e6e86>=</span><span class="token boolean" data-v-5a3e6e86>None</span>
        <span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>elif</span> padding_scheme <span class="token operator" data-v-5a3e6e86>==</span> <span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING&quot;</span><span class="token punctuation" data-v-5a3e6e86>:</span>
        <span class="token keyword" data-v-5a3e6e86>return</span> padding<span class="token punctuation" data-v-5a3e6e86>.</span>PKCS1v15<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>else</span><span class="token punctuation" data-v-5a3e6e86>:</span>
        <span class="token keyword" data-v-5a3e6e86>raise</span> ValueError<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;Unsupported padding scheme&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>


<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的公钥</span>
public_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的私钥</span>
private_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>

public_key <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>load_pem_public_key<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
private_key <span class="token operator" data-v-5a3e6e86>=</span> serialization<span class="token punctuation" data-v-5a3e6e86>.</span>load_pem_private_key<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> password<span class="token operator" data-v-5a3e6e86>=</span><span class="token boolean" data-v-5a3e6e86>None</span><span class="token punctuation" data-v-5a3e6e86>)</span>

data <span class="token operator" data-v-5a3e6e86>=</span> <span class="token string" data-v-5a3e6e86>&quot;spiderapi.cn - 虫术&quot;</span>
padding_type <span class="token operator" data-v-5a3e6e86>=</span> set_padding<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>
resultEncrypted <span class="token operator" data-v-5a3e6e86>=</span> public_key<span class="token punctuation" data-v-5a3e6e86>.</span>encrypt<span class="token punctuation" data-v-5a3e6e86>(</span>data<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> padding_type<span class="token punctuation" data-v-5a3e6e86>)</span>
resultDecrypted <span class="token operator" data-v-5a3e6e86>=</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>decrypt<span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>,</span> padding_type<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 加密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> base64<span class="token punctuation" data-v-5a3e6e86>.</span>b64encode<span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 解密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> resultDecrypted<span class="token punctuation" data-v-5a3e6e86>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install pycryptodome，官方文档：https://pycryptodome.readthedocs.io/</span>

<span class="token comment" data-v-5a3e6e86># ❌ padding 填充方式只支持 RSA_PKCS1_PADDING、RSA_PKCS1_OAEP_PADDING，不支持 RSA_NO_PADDING、RSA_PKCS1_PSS_PADDING</span>


<span class="token keyword" data-v-5a3e6e86>import</span> base64
<span class="token keyword" data-v-5a3e6e86>from</span> Crypto<span class="token punctuation" data-v-5a3e6e86>.</span>PublicKey <span class="token keyword" data-v-5a3e6e86>import</span> RSA
<span class="token keyword" data-v-5a3e6e86>from</span> Crypto<span class="token punctuation" data-v-5a3e6e86>.</span>Cipher <span class="token keyword" data-v-5a3e6e86>import</span> PKCS1_v1_5  <span class="token comment" data-v-5a3e6e86># 即 RSA_PKCS1_PADDING</span>
<span class="token keyword" data-v-5a3e6e86>from</span> Crypto<span class="token punctuation" data-v-5a3e6e86>.</span>Cipher <span class="token keyword" data-v-5a3e6e86>import</span> PKCS1_OAEP  <span class="token comment" data-v-5a3e6e86># 即 RSA_PKCS1_OAEP_PADDING</span>


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>rsa_decrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>ciphertext<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    cipher <span class="token operator" data-v-5a3e6e86>=</span> PKCS1_v1_5<span class="token punctuation" data-v-5a3e6e86>.</span>new<span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>)</span>
    decrypted <span class="token operator" data-v-5a3e6e86>=</span> cipher<span class="token punctuation" data-v-5a3e6e86>.</span>decrypt<span class="token punctuation" data-v-5a3e6e86>(</span>ciphertext<span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token boolean" data-v-5a3e6e86>None</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> decrypted


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>rsa_encrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>plaintext<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    cipher <span class="token operator" data-v-5a3e6e86>=</span> PKCS1_v1_5<span class="token punctuation" data-v-5a3e6e86>.</span>new<span class="token punctuation" data-v-5a3e6e86>(</span>public_key<span class="token punctuation" data-v-5a3e6e86>)</span>
    encrypted <span class="token operator" data-v-5a3e6e86>=</span> cipher<span class="token punctuation" data-v-5a3e6e86>.</span>encrypt<span class="token punctuation" data-v-5a3e6e86>(</span>plaintext<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> encrypted


<span class="token comment" data-v-5a3e6e86># 注意 &quot;&quot;&quot; 之后要紧跟着密钥标头，如果换行可能会因为无法解析导致报错：ValueError: RSA key format is not supported</span>
<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的公钥</span>
public_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的私钥</span>
private_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>

public_key <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>import_key<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>)</span>
private_key <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>import_key<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>)</span>

data <span class="token operator" data-v-5a3e6e86>=</span> <span class="token string" data-v-5a3e6e86>&quot;spiderapi.cn - 虫术&quot;</span>
resultEncrypted <span class="token operator" data-v-5a3e6e86>=</span> rsa_encrypt<span class="token punctuation" data-v-5a3e6e86>(</span>data<span class="token punctuation" data-v-5a3e6e86>)</span>
resultDecrypted <span class="token operator" data-v-5a3e6e86>=</span> rsa_decrypt<span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 加密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> base64<span class="token punctuation" data-v-5a3e6e86>.</span>b64encode<span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 解密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> resultDecrypted<span class="token punctuation" data-v-5a3e6e86>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install rsa，官方文档：https://stuvel.eu/python-rsa-doc/</span>

<span class="token comment" data-v-5a3e6e86># ❌ padding 填充方式只支持 RSA_PKCS1_PADDING</span>
<span class="token comment" data-v-5a3e6e86># ❌ 不支持使用 spki 语法标准的公钥和 pkcs8 语法标准的私钥</span>


<span class="token keyword" data-v-5a3e6e86>import</span> rsa
<span class="token keyword" data-v-5a3e6e86>import</span> base64


<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的公钥</span>
public_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的私钥</span>
private_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;
-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>

public_key <span class="token operator" data-v-5a3e6e86>=</span> rsa<span class="token punctuation" data-v-5a3e6e86>.</span>PublicKey<span class="token punctuation" data-v-5a3e6e86>.</span>load_pkcs1<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>
private_key <span class="token operator" data-v-5a3e6e86>=</span> rsa<span class="token punctuation" data-v-5a3e6e86>.</span>PrivateKey<span class="token punctuation" data-v-5a3e6e86>.</span>load_pkcs1<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token string" data-v-5a3e6e86>&quot;PEM&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span>

data <span class="token operator" data-v-5a3e6e86>=</span> <span class="token string" data-v-5a3e6e86>&quot;spiderapi.cn - 虫术&quot;</span>
resultEncrypted <span class="token operator" data-v-5a3e6e86>=</span> rsa<span class="token punctuation" data-v-5a3e6e86>.</span>encrypt<span class="token punctuation" data-v-5a3e6e86>(</span>data<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> public_key<span class="token punctuation" data-v-5a3e6e86>)</span>
resultDecrypted <span class="token operator" data-v-5a3e6e86>=</span> rsa<span class="token punctuation" data-v-5a3e6e86>.</span>decrypt<span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>,</span> private_key<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 加密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> base64<span class="token punctuation" data-v-5a3e6e86>.</span>b64encode<span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 解密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> resultDecrypted<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-python line-numbers-mode" data-v-5a3e6e86><pre class="language-python" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86># ✅ 安装依赖 pip install pycryptodome，官方文档：https://pycryptodome.readthedocs.io/</span>

<span class="token comment" data-v-5a3e6e86># ❌ padding 填充方式只支持 RSA_PKCS1_PADDING、RSA_PKCS1_OAEP_PADDING，不支持 RSA_NO_PADDING、RSA_PKCS1_PSS_PADDING</span>
<span class="token comment" data-v-5a3e6e86># 本例由雕虫小技二群粉丝提供，ID：曹晶 Eric Cao🇨🇳</span>


<span class="token keyword" data-v-5a3e6e86>import</span> base64
<span class="token keyword" data-v-5a3e6e86>from</span> Crypto<span class="token punctuation" data-v-5a3e6e86>.</span>PublicKey <span class="token keyword" data-v-5a3e6e86>import</span> RSA
<span class="token keyword" data-v-5a3e6e86>from</span> Crypto<span class="token punctuation" data-v-5a3e6e86>.</span>Cipher <span class="token keyword" data-v-5a3e6e86>import</span> PKCS1_v1_5  <span class="token comment" data-v-5a3e6e86># 即 RSA_PKCS1_PADDING</span>
<span class="token keyword" data-v-5a3e6e86>from</span> Crypto<span class="token punctuation" data-v-5a3e6e86>.</span>Cipher <span class="token keyword" data-v-5a3e6e86>import</span> PKCS1_OAEP  <span class="token comment" data-v-5a3e6e86># 即 RSA_PKCS1_OAEP_PADDING</span>


<span class="token comment" data-v-5a3e6e86># 一次 RSA 加密对明文长度是有限制，实际上，RSA 算法本身要求加密内容也就是明文长度 M 必须 0 &lt; M &lt; N（模数）</span>
<span class="token comment" data-v-5a3e6e86># 如果要加密一个长度大于模数 N 的明文块，就需要对明文进行分块以满足要求</span>
<span class="token comment" data-v-5a3e6e86># RSA_PKCS1_PADDING，每次加密的明文必须比 RSA 密钥的模长至少少 11 个字节</span>
<span class="token comment" data-v-5a3e6e86># RSA_PKCS1_OAEP_PADDING，每次加密的明文必须比 RSA 密钥的模长至少少 42 个字节</span>
<span class="token comment" data-v-5a3e6e86># NO_PADDING，每次加密的明文与 RSA 的密钥的模长一样，或更短</span>


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>rsa_encrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>plaintext<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    plaintext <span class="token operator" data-v-5a3e6e86>=</span> plaintext<span class="token punctuation" data-v-5a3e6e86>.</span>encode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>'utf-8'</span><span class="token punctuation" data-v-5a3e6e86>)</span>
    chunk_size <span class="token operator" data-v-5a3e6e86>=</span> public_key<span class="token punctuation" data-v-5a3e6e86>.</span>size_in_bytes<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token operator" data-v-5a3e6e86>-</span> <span class="token number" data-v-5a3e6e86>11</span>  <span class="token comment" data-v-5a3e6e86># 设置每个小段的长度,加密时要减去一个长度,PKCS1_PADDING: 至少-11, PKCS1_OAEP_PADDING: 至少-42</span>
    chunks <span class="token operator" data-v-5a3e6e86>=</span> <span class="token punctuation" data-v-5a3e6e86>[</span>plaintext<span class="token punctuation" data-v-5a3e6e86>[</span>i<span class="token punctuation" data-v-5a3e6e86>:</span>i <span class="token operator" data-v-5a3e6e86>+</span> chunk_size<span class="token punctuation" data-v-5a3e6e86>]</span> <span class="token keyword" data-v-5a3e6e86>for</span> i <span class="token keyword" data-v-5a3e6e86>in</span> <span class="token builtin" data-v-5a3e6e86>range</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token number" data-v-5a3e6e86>0</span><span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token builtin" data-v-5a3e6e86>len</span><span class="token punctuation" data-v-5a3e6e86>(</span>plaintext<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> chunk_size<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>]</span>
    encrypted_chunks <span class="token operator" data-v-5a3e6e86>=</span> <span class="token punctuation" data-v-5a3e6e86>[</span>PKCS1_v1_5<span class="token punctuation" data-v-5a3e6e86>.</span>new<span class="token punctuation" data-v-5a3e6e86>(</span>public_key<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>.</span>encrypt<span class="token punctuation" data-v-5a3e6e86>(</span>chunk<span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token keyword" data-v-5a3e6e86>for</span> chunk <span class="token keyword" data-v-5a3e6e86>in</span> chunks<span class="token punctuation" data-v-5a3e6e86>]</span>
    encrypted_data <span class="token operator" data-v-5a3e6e86>=</span> <span class="token string" data-v-5a3e6e86>b''</span><span class="token punctuation" data-v-5a3e6e86>.</span>join<span class="token punctuation" data-v-5a3e6e86>(</span>encrypted_chunks<span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> encrypted_data


<span class="token keyword" data-v-5a3e6e86>def</span> <span class="token function" data-v-5a3e6e86>rsa_decrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>ciphertext<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>:</span>
    chunk_size <span class="token operator" data-v-5a3e6e86>=</span> private_key<span class="token punctuation" data-v-5a3e6e86>.</span>size_in_bytes<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span>  <span class="token comment" data-v-5a3e6e86># 设置每个小段的长度</span>
    chunks <span class="token operator" data-v-5a3e6e86>=</span> <span class="token punctuation" data-v-5a3e6e86>[</span>ciphertext<span class="token punctuation" data-v-5a3e6e86>[</span>i<span class="token punctuation" data-v-5a3e6e86>:</span>i <span class="token operator" data-v-5a3e6e86>+</span> chunk_size<span class="token punctuation" data-v-5a3e6e86>]</span> <span class="token keyword" data-v-5a3e6e86>for</span> i <span class="token keyword" data-v-5a3e6e86>in</span> <span class="token builtin" data-v-5a3e6e86>range</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token number" data-v-5a3e6e86>0</span><span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token builtin" data-v-5a3e6e86>len</span><span class="token punctuation" data-v-5a3e6e86>(</span>ciphertext<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>,</span> chunk_size<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>]</span>
    decrypted_chunks <span class="token operator" data-v-5a3e6e86>=</span> <span class="token punctuation" data-v-5a3e6e86>[</span>PKCS1_v1_5<span class="token punctuation" data-v-5a3e6e86>.</span>new<span class="token punctuation" data-v-5a3e6e86>(</span>private_key<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>.</span>decrypt<span class="token punctuation" data-v-5a3e6e86>(</span>chunk<span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token boolean" data-v-5a3e6e86>None</span><span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token keyword" data-v-5a3e6e86>for</span> chunk <span class="token keyword" data-v-5a3e6e86>in</span> chunks<span class="token punctuation" data-v-5a3e6e86>]</span>
    decrypted_data <span class="token operator" data-v-5a3e6e86>=</span> <span class="token string" data-v-5a3e6e86>b''</span><span class="token punctuation" data-v-5a3e6e86>.</span>join<span class="token punctuation" data-v-5a3e6e86>(</span>decrypted_chunks<span class="token punctuation" data-v-5a3e6e86>)</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> decrypted_data<span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>'utf-8'</span><span class="token punctuation" data-v-5a3e6e86>)</span>


<span class="token comment" data-v-5a3e6e86># 注意 &quot;&quot;&quot; 之后要紧跟着密钥标头，如果换行可能会因为无法解析导致报错：ValueError: RSA key format is not supported</span>
<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的公钥</span>
public_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
&quot;&quot;&quot;</span>

<span class="token comment" data-v-5a3e6e86># pkcs1 标准 pem 格式的私钥</span>
private_key_pkcs1_pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token triple-quoted-string string" data-v-5a3e6e86>&quot;&quot;&quot;-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
&quot;&quot;&quot;</span>

public_key <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>import_key<span class="token punctuation" data-v-5a3e6e86>(</span>public_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>)</span>
private_key <span class="token operator" data-v-5a3e6e86>=</span> RSA<span class="token punctuation" data-v-5a3e6e86>.</span>import_key<span class="token punctuation" data-v-5a3e6e86>(</span>private_key_pkcs1_pem<span class="token punctuation" data-v-5a3e6e86>)</span>

data <span class="token operator" data-v-5a3e6e86>=</span> <span class="token string" data-v-5a3e6e86>&quot;SpiderAPI - 虫术 - 汇总各种爬虫逆向常用 API，涉及各种网络请求库，自动化框架，爬虫框架，HOOK 脚本，ADB 命令等。SpiderAPI - Insect Techniques - Summarize various commonly used reverse APIs for web crawlers, involving various network request libraries, automation frameworks, web crawling frameworks, HOOK scripts, ADB commands, etc.&quot;</span>
resultEncrypted <span class="token operator" data-v-5a3e6e86>=</span> rsa_encrypt<span class="token punctuation" data-v-5a3e6e86>(</span>data<span class="token punctuation" data-v-5a3e6e86>)</span>
resultDecrypted <span class="token operator" data-v-5a3e6e86>=</span> rsa_decrypt<span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span>

<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;原文长度: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token builtin" data-v-5a3e6e86>len</span><span class="token punctuation" data-v-5a3e6e86>(</span>data<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_OAEP_PADDING 加密结果: %s&quot;</span> <span class="token operator" data-v-5a3e6e86>%</span> base64<span class="token punctuation" data-v-5a3e6e86>.</span>b64encode<span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>.</span>decode<span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>)</span>
<span class="token keyword" data-v-5a3e6e86>print</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_OAEP_PADDING 解密结果: %s&quot;</span> <span class="token operator" data-v-5a3e6e86>%</span> resultDecrypted<span class="token punctuation" data-v-5a3e6e86>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>62</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>63</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>64</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>65</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>66</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>67</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>68</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>69</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>70</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>71</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>72</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>73</span><br data-v-5a3e6e86></div></div></div> <pre class="pre-blank" data-v-392329f0>// Make sure to add code blocks to your code group</pre></div> <h3 id="javascript-4"><a href="#javascript-4" class="header-anchor">#</a> JavaScript <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>Node.js</span> <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>ECMAScript 5.1+</span></h3> <br> <div class="theme-code-group" data-v-392329f0><div class="theme-code-group__nav" data-v-392329f0><ul class="theme-code-group__ul" data-v-392329f0></ul></div> <div class="theme-code-block theme-code-block__active" data-v-5a3e6e86><div class="language-javascript line-numbers-mode" data-v-5a3e6e86><pre class="language-javascript" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86>// ✅ Node.js 内置 crypto 模块，无需单独安装，官方文档：https://nodejs.org/docs/latest/api/crypto.html</span>

<span class="token keyword" data-v-5a3e6e86>var</span> crypto <span class="token operator" data-v-5a3e6e86>=</span> <span class="token function" data-v-5a3e6e86>require</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;crypto&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>


<span class="token keyword" data-v-5a3e6e86>function</span> <span class="token function" data-v-5a3e6e86>rsaEncrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token parameter" data-v-5a3e6e86>data</span><span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token punctuation" data-v-5a3e6e86>{</span>
    <span class="token keyword" data-v-5a3e6e86>var</span> bufferData <span class="token operator" data-v-5a3e6e86>=</span> Buffer<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>from</span><span class="token punctuation" data-v-5a3e6e86>(</span>data<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
    <span class="token keyword" data-v-5a3e6e86>var</span> encrypted <span class="token operator" data-v-5a3e6e86>=</span> crypto<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>publicEncrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>{</span>
        <span class="token literal-property property" data-v-5a3e6e86>key</span><span class="token operator" data-v-5a3e6e86>:</span> publicKey<span class="token punctuation" data-v-5a3e6e86>,</span>
        <span class="token comment" data-v-5a3e6e86>// 支持 RSA_NO_PADDING、RSA_PKCS1_PADDING、RSA_PKCS1_OAEP_PADDING、RSA_PKCS1_PSS_PADDING</span>
        <span class="token literal-property property" data-v-5a3e6e86>padding</span><span class="token operator" data-v-5a3e6e86>:</span> crypto<span class="token punctuation" data-v-5a3e6e86>.</span>constants<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token constant" data-v-5a3e6e86>RSA_PKCS1_PADDING</span>
    <span class="token punctuation" data-v-5a3e6e86>}</span><span class="token punctuation" data-v-5a3e6e86>,</span> bufferData<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> encrypted<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>toString</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;base64&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
<span class="token punctuation" data-v-5a3e6e86>}</span>

<span class="token keyword" data-v-5a3e6e86>function</span> <span class="token function" data-v-5a3e6e86>rsaDecrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token parameter" data-v-5a3e6e86>cipherText</span><span class="token punctuation" data-v-5a3e6e86>)</span> <span class="token punctuation" data-v-5a3e6e86>{</span>
    <span class="token keyword" data-v-5a3e6e86>var</span> bufferData <span class="token operator" data-v-5a3e6e86>=</span> Buffer<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>from</span><span class="token punctuation" data-v-5a3e6e86>(</span>cipherText<span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token string" data-v-5a3e6e86>&quot;base64&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
    <span class="token keyword" data-v-5a3e6e86>var</span> decrypted <span class="token operator" data-v-5a3e6e86>=</span> crypto<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>privateDecrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>{</span>
        <span class="token literal-property property" data-v-5a3e6e86>key</span><span class="token operator" data-v-5a3e6e86>:</span> privateKey<span class="token punctuation" data-v-5a3e6e86>,</span>
        <span class="token comment" data-v-5a3e6e86>// 支持 RSA_NO_PADDING、RSA_PKCS1_PADDING、RSA_PKCS1_OAEP_PADDING、RSA_PKCS1_PSS_PADDING</span>
        <span class="token literal-property property" data-v-5a3e6e86>padding</span><span class="token operator" data-v-5a3e6e86>:</span> crypto<span class="token punctuation" data-v-5a3e6e86>.</span>constants<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token constant" data-v-5a3e6e86>RSA_PKCS1_PADDING</span>
    <span class="token punctuation" data-v-5a3e6e86>}</span><span class="token punctuation" data-v-5a3e6e86>,</span> bufferData<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
    <span class="token keyword" data-v-5a3e6e86>return</span> decrypted<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>toString</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
<span class="token punctuation" data-v-5a3e6e86>}</span>

<span class="token comment" data-v-5a3e6e86>// pkcs1 标准 pem 格式的公钥</span>
<span class="token keyword" data-v-5a3e6e86>var</span> publicKeyPkcs1Pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token template-string" data-v-5a3e6e86><span class="token template-punctuation string" data-v-5a3e6e86>`</span><span class="token string" data-v-5a3e6e86>
-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
</span><span class="token template-punctuation string" data-v-5a3e6e86>`</span></span>

<span class="token comment" data-v-5a3e6e86>// pkcs1 标准 pem 格式的私钥</span>
<span class="token keyword" data-v-5a3e6e86>var</span> privateKeyPkcs1Pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token template-string" data-v-5a3e6e86><span class="token template-punctuation string" data-v-5a3e6e86>`</span><span class="token string" data-v-5a3e6e86>
-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
</span><span class="token template-punctuation string" data-v-5a3e6e86>`</span></span>

<span class="token comment" data-v-5a3e6e86>// 将 pem 格式的密钥转换为 crypto 可以使用的对象</span>
<span class="token keyword" data-v-5a3e6e86>var</span> publicKey <span class="token operator" data-v-5a3e6e86>=</span> crypto<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>createPublicKey</span><span class="token punctuation" data-v-5a3e6e86>(</span>publicKeyPkcs1Pem<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
<span class="token keyword" data-v-5a3e6e86>var</span> privateKey <span class="token operator" data-v-5a3e6e86>=</span> crypto<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>createPrivateKey</span><span class="token punctuation" data-v-5a3e6e86>(</span>privateKeyPkcs1Pem<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>

<span class="token comment" data-v-5a3e6e86>// RSA 加解密，填充方式使用 RSA_PKCS1_PADDING，其他可选 RSA_NO_PADDING、RSA_PKCS1_OAEP_PADDING、RSA_PKCS1_PSS_PADDING</span>
<span class="token keyword" data-v-5a3e6e86>var</span> data <span class="token operator" data-v-5a3e6e86>=</span> <span class="token string" data-v-5a3e6e86>&quot;spiderapi.cn - 虫术&quot;</span><span class="token punctuation" data-v-5a3e6e86>;</span>
<span class="token keyword" data-v-5a3e6e86>var</span> resultEncrypted <span class="token operator" data-v-5a3e6e86>=</span> <span class="token function" data-v-5a3e6e86>rsaEncrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>data<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
<span class="token keyword" data-v-5a3e6e86>var</span> resultDecrypted <span class="token operator" data-v-5a3e6e86>=</span> <span class="token function" data-v-5a3e6e86>rsaDecrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>

console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 加密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span>
console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 解密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> resultDecrypted<span class="token punctuation" data-v-5a3e6e86>)</span>

</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>51</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>52</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>53</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>54</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>55</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>56</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>57</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>58</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>59</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>60</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>61</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>62</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>63</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>64</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>65</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-javascript line-numbers-mode" data-v-5a3e6e86><pre class="language-javascript" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86>// ✅ 安装依赖：npm install node-rsa，官方文档：https://github.com/rzcoder/node-rsa</span>

<span class="token comment" data-v-5a3e6e86>// ❓ 注意：截止 2024.03，该库中公钥语法标准支持 pkcs8，但实际上不存在这种说法，具有争议，正确应该是 spki，参见：https://github.com/rzcoder/node-rsa/issues/208</span>
<span class="token comment" data-v-5a3e6e86>// ❌  padding 填充方式只支持 RSA_PKCS1_PADDING、RSA_PKCS1_OAEP_PADDING，不支持 RSA_NO_PADDING、RSA_PKCS1_PSS_PADDING</span>

<span class="token keyword" data-v-5a3e6e86>var</span> NodeRSA <span class="token operator" data-v-5a3e6e86>=</span> <span class="token function" data-v-5a3e6e86>require</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;node-rsa&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>


<span class="token comment" data-v-5a3e6e86>// pkcs1 标准 pem 格式的公钥</span>
<span class="token keyword" data-v-5a3e6e86>var</span> publicKeyPkcs1Pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token template-string" data-v-5a3e6e86><span class="token template-punctuation string" data-v-5a3e6e86>`</span><span class="token string" data-v-5a3e6e86>
-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
</span><span class="token template-punctuation string" data-v-5a3e6e86>`</span></span>

<span class="token comment" data-v-5a3e6e86>// pkcs1 标准 pem 格式的私钥</span>
<span class="token keyword" data-v-5a3e6e86>var</span> privateKeyPkcs1Pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token template-string" data-v-5a3e6e86><span class="token template-punctuation string" data-v-5a3e6e86>`</span><span class="token string" data-v-5a3e6e86>
-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
</span><span class="token template-punctuation string" data-v-5a3e6e86>`</span></span>

<span class="token keyword" data-v-5a3e6e86>var</span> key <span class="token operator" data-v-5a3e6e86>=</span> <span class="token keyword" data-v-5a3e6e86>new</span> <span class="token class-name" data-v-5a3e6e86>NodeRSA</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
key<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>setOptions</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>{</span> <span class="token literal-property property" data-v-5a3e6e86>encryptionScheme</span><span class="token operator" data-v-5a3e6e86>:</span> <span class="token string" data-v-5a3e6e86>&quot;pkcs1&quot;</span> <span class="token punctuation" data-v-5a3e6e86>}</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>  <span class="token comment" data-v-5a3e6e86>// 设置填充模式，默认 pkcs1_oaep</span>

<span class="token comment" data-v-5a3e6e86>// 导入密钥，传入参数格式：语法标准-密钥类型-输出格式，即 scheme-[key_type]-[output_type]</span>
key<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>importKey</span><span class="token punctuation" data-v-5a3e6e86>(</span>publicKeyPkcs1Pem<span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token string" data-v-5a3e6e86>&quot;pkcs1-public-pem&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>   <span class="token comment" data-v-5a3e6e86>// 公钥语法标准支持 pkcs1、pkcs8，输出格式支持 pem、der</span>
key<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>importKey</span><span class="token punctuation" data-v-5a3e6e86>(</span>privateKeyPkcs1Pem<span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token string" data-v-5a3e6e86>&quot;pkcs1-private-pem&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span> <span class="token comment" data-v-5a3e6e86>// 私钥语法标准支持 pkcs1、pkcs8，输出格式支持 pem、der</span>

<span class="token comment" data-v-5a3e6e86>// RSA 加解密</span>
<span class="token keyword" data-v-5a3e6e86>var</span> data <span class="token operator" data-v-5a3e6e86>=</span> <span class="token string" data-v-5a3e6e86>&quot;spiderapi.cn - 虫术&quot;</span><span class="token punctuation" data-v-5a3e6e86>;</span>
<span class="token keyword" data-v-5a3e6e86>var</span> resultEncrypted <span class="token operator" data-v-5a3e6e86>=</span>  key<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>encrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>data<span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token string" data-v-5a3e6e86>&quot;base64&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
<span class="token keyword" data-v-5a3e6e86>var</span> resultDecrypted <span class="token operator" data-v-5a3e6e86>=</span> key<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>decrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>,</span> <span class="token string" data-v-5a3e6e86>&quot;utf8&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>

console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 加密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span>
console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 解密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> resultDecrypted<span class="token punctuation" data-v-5a3e6e86>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86></div></div></div> <div class="theme-code-block" data-v-5a3e6e86><div class="language-javascript line-numbers-mode" data-v-5a3e6e86><pre class="language-javascript" data-v-5a3e6e86><code data-v-5a3e6e86><span class="token comment" data-v-5a3e6e86>// ✅ 安装依赖：npm install jsencrypt，官方文档：https://github.com/travist/jsencrypt</span>

<span class="token comment" data-v-5a3e6e86>// ❗ 如果在 Node 环境中使用，会遇到报错 window is not defined，处理方法：</span>
<span class="token comment" data-v-5a3e6e86>//    1.在当前 JS 文件顶部添加代码：window = global;</span>
<span class="token comment" data-v-5a3e6e86>//    2.在 \node_modules\jsencrypt\bin\jsencrypt.js 添加代码：window = global;</span>
<span class="token comment" data-v-5a3e6e86>// ❌ padding 填充方式默认为 RSA_PKCS1_PADDING，不支持其他填充方式</span>


<span class="token keyword" data-v-5a3e6e86>var</span> JSEncrypt <span class="token operator" data-v-5a3e6e86>=</span> <span class="token function" data-v-5a3e6e86>require</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;jsencrypt&quot;</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>


<span class="token comment" data-v-5a3e6e86>// pkcs1 标准 pem 格式的公钥</span>
<span class="token keyword" data-v-5a3e6e86>var</span> publicKeyPkcs1Pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token template-string" data-v-5a3e6e86><span class="token template-punctuation string" data-v-5a3e6e86>`</span><span class="token string" data-v-5a3e6e86>
-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
</span><span class="token template-punctuation string" data-v-5a3e6e86>`</span></span>

<span class="token comment" data-v-5a3e6e86>// pkcs1 标准 pem 格式的私钥</span>
<span class="token keyword" data-v-5a3e6e86>var</span> privateKeyPkcs1Pem <span class="token operator" data-v-5a3e6e86>=</span> <span class="token template-string" data-v-5a3e6e86><span class="token template-punctuation string" data-v-5a3e6e86>`</span><span class="token string" data-v-5a3e6e86>
-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
</span><span class="token template-punctuation string" data-v-5a3e6e86>`</span></span>

<span class="token keyword" data-v-5a3e6e86>var</span> encryptor <span class="token operator" data-v-5a3e6e86>=</span> <span class="token keyword" data-v-5a3e6e86>new</span> <span class="token class-name" data-v-5a3e6e86>JSEncrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
encryptor<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>setPublicKey</span><span class="token punctuation" data-v-5a3e6e86>(</span>publicKeyPkcs1Pem<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
encryptor<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>setPrivateKey</span><span class="token punctuation" data-v-5a3e6e86>(</span>privateKeyPkcs1Pem<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>

<span class="token comment" data-v-5a3e6e86>// RSA 加解密，填充方式只支持 RSA_PKCS1_PADDING</span>
<span class="token keyword" data-v-5a3e6e86>var</span> data <span class="token operator" data-v-5a3e6e86>=</span> <span class="token string" data-v-5a3e6e86>&quot;spiderapi.cn - 虫术&quot;</span><span class="token punctuation" data-v-5a3e6e86>;</span>
<span class="token keyword" data-v-5a3e6e86>var</span> resultEncrypted <span class="token operator" data-v-5a3e6e86>=</span> encryptor<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>encrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>data<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>
<span class="token keyword" data-v-5a3e6e86>var</span> resultDecrypted <span class="token operator" data-v-5a3e6e86>=</span> encryptor<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>decrypt</span><span class="token punctuation" data-v-5a3e6e86>(</span>resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span><span class="token punctuation" data-v-5a3e6e86>;</span>

console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 加密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> resultEncrypted<span class="token punctuation" data-v-5a3e6e86>)</span>
console<span class="token punctuation" data-v-5a3e6e86>.</span><span class="token function" data-v-5a3e6e86>log</span><span class="token punctuation" data-v-5a3e6e86>(</span><span class="token string" data-v-5a3e6e86>&quot;RSA_PKCS1_PADDING 解密结果: &quot;</span><span class="token punctuation" data-v-5a3e6e86>,</span> resultDecrypted<span class="token punctuation" data-v-5a3e6e86>)</span>
</code></pre> <div class="line-numbers-wrapper" data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>1</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>2</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>3</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>4</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>5</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>6</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>7</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>8</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>9</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>10</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>11</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>12</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>13</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>14</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>15</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>16</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>17</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>18</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>19</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>20</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>21</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>22</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>23</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>24</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>25</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>26</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>27</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>28</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>29</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>30</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>31</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>32</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>33</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>34</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>35</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>36</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>37</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>38</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>39</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>40</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>41</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>42</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>43</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>44</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>45</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>46</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>47</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>48</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>49</span><br data-v-5a3e6e86><span class="line-number" data-v-5a3e6e86>50</span><br data-v-5a3e6e86></div></div></div> <pre class="pre-blank" data-v-392329f0>// Make sure to add code blocks to your code group</pre></div> <h3 id="golang-4"><a href="#golang-4" class="header-anchor">#</a> Golang <span class="badge tip" style="vertical-align:top;" data-v-3396d6b6>1.0+</span></h3> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// ✅ 无需安装依赖，官方文档：https://pkg.go.dev/crypto</span>

<span class="token comment">// ❌ padding 填充方式只支持 RSA_PKCS1_PADDING、RSA_PKCS1_OAEP_PADDING，不支持 RSA_NO_PADDING、RSA_PKCS1_PSS_PADDING</span>


<span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;crypto/rand&quot;</span>
    <span class="token string">&quot;crypto/rsa&quot;</span>
    <span class="token string">&quot;crypto/x509&quot;</span>
    <span class="token string">&quot;encoding/base64&quot;</span>
    <span class="token string">&quot;encoding/pem&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	  <span class="token comment">// pkcs1 标准 pem 格式的公钥</span>
	  publicKeyPkcs1Pem <span class="token operator">:=</span> <span class="token string">`
-----BEGIN RSA PUBLIC KEY-----
MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
-----END RSA PUBLIC KEY-----
`</span>

	  <span class="token comment">// pkcs1 标准 pem 格式的私钥</span>
	  privateKeyPkcs1Pem <span class="token operator">:=</span> <span class="token string">`
-----BEGIN RSA PRIVATE KEY-----
MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
+qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
-----END RSA PRIVATE KEY-----
`</span>

    publicKeyBlock<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>publicKeyPkcs1Pem<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> publicKeyBlock <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to parse PEM block containing the public key&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    publicKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">ParsePKCS1PublicKey</span><span class="token punctuation">(</span>publicKeyBlock<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to parse public key: &quot;</span> <span class="token operator">+</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  
    privateKeyBlock<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> pem<span class="token punctuation">.</span><span class="token function">Decode</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>privateKeyPkcs1Pem<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> privateKeyBlock <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to parse PEM block containing the private key&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    privateKey<span class="token punctuation">,</span> err <span class="token operator">:=</span> x509<span class="token punctuation">.</span><span class="token function">ParsePKCS1PrivateKey</span><span class="token punctuation">(</span>privateKeyBlock<span class="token punctuation">.</span>Bytes<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to parse private key: &quot;</span> <span class="token operator">+</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  
    data <span class="token operator">:=</span> <span class="token string">&quot;spiderapi.cn - 虫术&quot;</span>
  
    <span class="token comment">// RSA_PKCS1_PADDING</span>
    resultEncrypted<span class="token punctuation">,</span> err <span class="token operator">:=</span> rsa<span class="token punctuation">.</span><span class="token function">EncryptPKCS1v15</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span>Reader<span class="token punctuation">,</span> publicKey<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// RSA_PKCS1_OAEP_PADDING</span>
    <span class="token comment">// resultEncrypted, err := rsa.EncryptOAEP(sha256.New(), rand.Reader, publicKey, []byte(data), nil)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to encrypt data: &quot;</span> <span class="token operator">+</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">// RSA_PKCS1_PADDING</span>
    resultDecrypted<span class="token punctuation">,</span> err <span class="token operator">:=</span> rsa<span class="token punctuation">.</span><span class="token function">DecryptPKCS1v15</span><span class="token punctuation">(</span>rand<span class="token punctuation">.</span>Reader<span class="token punctuation">,</span> privateKey<span class="token punctuation">,</span> resultEncrypted<span class="token punctuation">)</span>
    <span class="token comment">// RSA_PKCS1_OAEP_PADDING</span>
    <span class="token comment">// resultDecrypted, err := rsa.DecryptOAEP(sha256.New(), rand.Reader, privateKey, resultEncrypted, nil)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to decrypt data: &quot;</span> <span class="token operator">+</span> err<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;RSA_PKCS1_PADDING 加密结果: &quot;</span><span class="token punctuation">,</span> base64<span class="token punctuation">.</span>StdEncoding<span class="token punctuation">.</span><span class="token function">EncodeToString</span><span class="token punctuation">(</span>resultEncrypted<span class="token punctuation">)</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;RSA_PKCS1_PADDING 解密结果: &quot;</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span>resultDecrypted<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br></div></div><h2 id="在线工具"><a href="#在线工具" class="header-anchor">#</a> 在线工具</h2> <ul><li><a href="http://tools.jb51.net/password/rsa_encode" target="_blank" rel="noopener noreferrer">在线 RSA 加解密<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.ssleye.com/ssltool/pkcs.html" target="_blank" rel="noopener noreferrer">公私钥格式在线转换<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/WuKongSecurity/SpiderAPI/edit/main/docs/03.辅助查询/04.加密算法/07.rsa.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/07/27, 08:48:36</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/sha/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">SHA</div></a> <a href="/pages/aes/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">AES</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/sha/" class="prev">SHA</a></span> <span class="next"><a href="/pages/aes/">AES</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><!----> <span><a href="https://beian.miit.gov.cn/" target="_blank"><img src="https://static.wukongsec.com/public/images/logo/icp_48x48.png" alt="ICP 备案" style="width:20px; height:auto; margin-bottom:-2px"> 鄂ICP备19003281号-9</a>丨
    <a href="https://beian.mps.gov.cn/" target="_blank"><img src="https://static.wukongsec.com/public/images/logo/mps_48x48.png" alt="MPS 公网安备" style="width:auto; height:20px; margin-bottom:-4px"> 鄂公网安备42280202422959</a>丨
    <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank"><img src="https://static.wukongsec.com/public/images/logo/vue_48x48.png" alt="Theme by Vdoing" style="width:18px; height:auto; margin-bottom:-4px"> Theme Vdoing</a>丨
    <a href="https://edgeone.ai/" target="_blank"><img src="https://static.wukongsec.com/public/images/logo/tencent_edgeone_48x48.png" alt="Tencent EdgeOne" style="width:18px; height:auto; margin-bottom:-3px"> Tencent EdgeOne</a>丨
    <a href="https://v6.51.la/land/3FcHt9RWSQ8XvN5u" target="_blank"><img src="https://sdk.51.la/icon/1-1.png" alt="51la 网站统计" style="width:auto; height:12px; margin-bottom:-1px"></a></span> <br> <br>
  Copyright © 2023 - 2025<a href="https://wukongsec.com/" target="_blank"> WuKong Security.</a>丨
  <span id="sitetime">正在载入网站运行时间...</span>丨
  </div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d9cfca56.js" defer></script><script src="/assets/js/2.b726511c.js" defer></script><script src="/assets/js/3.28e29ac1.js" defer></script><script src="/assets/js/80.0f45fe78.js" defer></script><script src="/assets/js/15.1edde6f8.js" defer></script>
  </body>
</html>
